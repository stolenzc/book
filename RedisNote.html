
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Redis · NOTEBOOK</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="STOLENZC">
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search-pro/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-prism/prism.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-intopic-toc/style.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-theme-comscore/test.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="SoftManual.html" />
    
    
    <link rel="prev" href="PythonNote.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="输入并搜索" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="https://blog.stolenzc.com" target="_blank" class="custom-link">博客主页</a>
        </li>
    
        
        <li>
            <a href="https://tools.stolenzc.com" target="_blank" class="custom-link">快捷工具</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="AlgorithmNote.html">
            
                <a href="AlgorithmNote.html">
            
                    
                    算法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="DataAnalysis.html">
            
                <a href="DataAnalysis.html">
            
                    
                    数据分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="GoNote.html">
            
                <a href="GoNote.html">
            
                    
                    Go笔记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="JavaScriptNote.html">
            
                <a href="JavaScriptNote.html">
            
                    
                    前端
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="KubernetesNote.html">
            
                <a href="KubernetesNote.html">
            
                    
                    K8s
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="LinuxNote.html">
            
                <a href="LinuxNote.html">
            
                    
                    Linux
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="MysqlNote.html">
            
                <a href="MysqlNote.html">
            
                    
                    MySQL
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="Project.html">
            
                <a href="Project.html">
            
                    
                    项目
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="PythonNote.html">
            
                <a href="PythonNote.html">
            
                    
                    Python基础
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.11" data-path="RedisNote.html">
            
                <a href="RedisNote.html">
            
                    
                    Redis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="SoftManual.html">
            
                <a href="SoftManual.html">
            
                    
                    软件使用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="python_class_1.html">
            
                <a href="python_class_1.html">
            
                    
                    Python 数据类型
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            本书使用 GitBook 发布
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Redis</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <a href="#&#x57FA;&#x672C;&#x4ECB;&#x7ECD;" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><h1 id="&#x57FA;&#x672C;&#x4ECB;&#x7ECD;"><a name="&#x57FA;&#x672C;&#x4ECB;&#x7ECD;" class="anchor-navigation-ex-anchor" href="#&#x57FA;&#x672C;&#x4ECB;&#x7ECD;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x57FA;&#x672C;&#x4ECB;&#x7ECD;</h1>
<h2 id="&#x7B80;&#x4ECB;"><a name="&#x7B80;&#x4ECB;" class="anchor-navigation-ex-anchor" href="#&#x7B80;&#x4ECB;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x7B80;&#x4ECB;</h2>
<p>Redis: REmote DIctionary Service&#xFF0C;&#x8FDC;&#x7A0B;&#x5B57;&#x5178;&#x670D;&#x52A1;</p>
<p>Redis&#x7EBF;&#x7A0B;&#xFF1A;Redis&#x53EA;&#x6709;&#x5904;&#x7406;&#x5BA2;&#x6237;&#x7AEF;&#x8BF7;&#x6C42;&#xFF08;&#x6267;&#x884C;&#x547D;&#x4EE4;&#xFF09;&#x662F;&#x5355;&#x7EBF;&#x7A0B;&#xFF0C;&#x5176;&#x4ED6;&#x5F88;&#x591A;&#x5730;&#x65B9;&#x662F;&#x591A;&#x7EBF;&#x7A0B;&#xFF0C;&#x5982;&#xFF1A;&#x540E;&#x53F0;&#x5220;&#x9664;&#x5BF9;&#x8C61;&#x3001;&#x901A;&#x8FC7;Redis&#x6A21;&#x5757;&#x5B9E;&#x73B0;&#x963B;&#x585E;&#x547D;&#x4EE4;&#x3001;&#x7F51;&#x7EDC;I/O&#xFF08;6.0&#xFF09;&#x7B49;</p>
<p>&#x4F7F;&#x7528;&#x5355;&#x7EBF;&#x7A0B;&#x7684;&#x539F;&#x56E0;&#xFF1A;</p>
<ol>
<li>&#x591A;&#x7EBF;&#x7A0B;&#x4E0D;&#x4E00;&#x5B9A;&#x6BD4;&#x5355;&#x7EBF;&#x7A0B;&#x5FEB;&#xFF0C;&#x6709;&#x521B;&#x5EFA;&#x548C;&#x9500;&#x6BC1;&#x7684;&#x8FC7;&#x7A0B;</li>
<li>&#x591A;&#x7EBF;&#x7A0B;&#x4F1A;&#x6D89;&#x53CA;&#x6570;&#x636E;&#x7684;&#x5B89;&#x5168;&#x6027;&#x95EE;&#x9898;</li>
</ol>
<p>Redis&#x5FEB;&#x7684;&#x539F;&#x56E0;&#xFF1A;</p>
<ol>
<li>Redis&#x662F;&#x7EAF;&#x5185;&#x5B58;&#x7ED3;&#x6784;&#xFF0C;&#x907F;&#x514D;&#x78C1;&#x76D8;I/O&#x7684;&#x64CD;&#x4F5C;</li>
<li>Redis&#x547D;&#x4EE4;&#x5904;&#x7406;&#x7684;&#x6838;&#x5FC3;&#x6A21;&#x5757;&#x662F;&#x5355;&#x7EBF;&#x7A0B;&#xFF0C;&#x51CF;&#x5C11;&#x9501;&#x7ADE;&#x4E89;&#xFF0C;&#x51CF;&#x5C11;&#x7EBF;&#x7A0B;&#x521B;&#x5EFA;&#x548C;&#x9500;&#x6BC1;&#x8FC7;&#x7A0B;&#xFF0C;&#x51CF;&#x5C11;&#x7EBF;&#x7A0B;&#x4E0A;&#x4E0B;&#x95EE;&#x7684;&#x5207;&#x6362;</li>
<li>&#x91C7;&#x7528;&#x4E86;I/O&#x591A;&#x8DEF;&#x590D;&#x7528;&#x673A;&#x5236;&#xFF0C;&#x63D0;&#x9AD8;&#x5E76;&#x53D1;&#x6548;&#x7387;</li>
</ol>
<h2 id="&#x5B89;&#x88C5;"><a name="&#x5B89;&#x88C5;" class="anchor-navigation-ex-anchor" href="#&#x5B89;&#x88C5;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5B89;&#x88C5;</h2>
<p>&#x5B89;&#x88C5;&#xFF1A;</p>
<pre class="language-"><code class="lang-bash">// &#x4E0B;&#x8F7D;
<span class="token function">wget</span> https://labfile.oss.aliyuncs.com/courses/3368/redis-5.0.5.tar.gz

// &#x89E3;&#x538B;
<span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> redis-5.0.5.tar.gz

// &#x5B89;&#x88C5;
<span class="token builtin class-name">cd</span> redis-5.0.5/src
<span class="token function">make</span> <span class="token operator">&amp;&amp;</span> <span class="token function">make</span> <span class="token function">install</span> <span class="token assign-left variable">PREFIX</span><span class="token operator">=</span>/home/project/redis-5.0.5

// &#x914D;&#x7F6E;
<span class="token function">vim</span> /home/project/redis-5.0.5/redis.conf
// &#x4FEE;&#x6539;&#x914D;&#x7F6E;&#xFF0C;&#x540E;&#x53F0;&#x8FD0;&#x884C;redis
daemonize no <span class="token operator">=</span><span class="token operator">&gt;</span> daemonize <span class="token function">yes</span>

// &#x542F;&#x52A8;redis&#x670D;&#x52A1;
/home/project/redis-5.0.5/bin/redis-server /home/project/redis5.0.5/redis.conf
// &#x84DD;&#x6865;&#x4E91;&#x8BFE;&#x73AF;&#x5883;&#x542F;&#x52A8;redis&#x65B9;&#x6CD5;
<span class="token function">sudo</span> redis-server /etc/redis/redis.conf

// ubuntu&#x4EC5;&#x5B89;&#x88C5;redis-cli
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> redis-tools
</code></pre>
<h2 id="&#x901F;&#x5EA6;&#x6D4B;&#x8BD5;"><a name="&#x901F;&#x5EA6;&#x6D4B;&#x8BD5;" class="anchor-navigation-ex-anchor" href="#&#x901F;&#x5EA6;&#x6D4B;&#x8BD5;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x901F;&#x5EA6;&#x6D4B;&#x8BD5;</h2>
<p><code>redis-benchmark</code> - &#x541E;&#x5410;&#x91CF;&#x6D4B;&#x8BD5;&#x547D;&#x4EE4;</p>
<ul>
<li><code>-h</code> - hostname&#xFF0C;&#x4E3B;&#x673A;&#x5730;&#x5740;&#xFF0C;&#x9ED8;&#x8BA4;&#x4E3A;127.0.0.1</li>
<li><code>-p</code> - port&#xFF0C;&#x7AEF;&#x53E3;&#x53F7;&#xFF0C;&#x9ED8;&#x8BA4;&#x4E3A;6379</li>
<li><code>-s</code> - socket&#xFF0C;&#x5957;&#x63A5;&#x5B57;&#xFF0C;&#x4F1A;&#x8986;&#x76D6;&#x4E3B;&#x673A;&#x540D;&#x548C;&#x7AEF;&#x53E3;</li>
<li><code>-a</code> - password&#xFF0C;redis&#x767B;&#x9646;&#x8BA4;&#x8BC1;&#x5BC6;&#x7801;</li>
<li><code>-t</code> - tests&#xFF0C;&#x6D4B;&#x8BD5;&#x4EE5;&#x9017;&#x53F7;&#x5206;&#x5272;&#x7684;&#x6D4B;&#x8BD5;&#x5217;&#x8868;&#xFF0C;&#x540D;&#x79F0;&#x4E0E;&#x8F93;&#x51FA;&#x540D;&#x79F0;&#x76F8;&#x540C;</li>
<li><code>-n</code> - requests&#xFF0C;&#x8BF7;&#x6C42;&#x7684;&#x6570;&#x91CF;&#xFF0C;&#x9ED8;&#x8BA4;&#x4E3A;10&#x4E07;</li>
<li><code>-q</code> - quiet&#xFF0C;&#x4EC5;&#x8F93;&#x51FA;&#x6BCF;&#x79D2;&#x6B21;&#x6570;</li>
</ul>
<h2 id="&#x7CFB;&#x7EDF;&#x547D;&#x4EE4;"><a name="&#x7CFB;&#x7EDF;&#x547D;&#x4EE4;" class="anchor-navigation-ex-anchor" href="#&#x7CFB;&#x7EDF;&#x547D;&#x4EE4;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x7CFB;&#x7EDF;&#x547D;&#x4EE4;</h2>
<ul>
<li><code>redis-server --version</code> &#x6216; <code>redis-server -v</code> - &#x67E5;&#x770B;redis-server&#x7248;&#x672C;</li>
<li><code>redis-cli --version</code> &#x6216; <code>redis-cli -v</code> - &#x67E5;&#x770B;redis-cli&#x7248;&#x672C;</li>
<li><code>info</code> - redis-cli&#x4E2D;&#x8F93;&#x5165;&#x67E5;&#x770B;&#x76F8;&#x5173;&#x4FE1;&#x606F;</li>
</ul>
<h1 id="&#x6570;&#x636E;&#x7C7B;&#x578B;"><a name="&#x6570;&#x636E;&#x7C7B;&#x578B;" class="anchor-navigation-ex-anchor" href="#&#x6570;&#x636E;&#x7C7B;&#x578B;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x6570;&#x636E;&#x7C7B;&#x578B;</h1>
<h2 id="&#x6570;&#x636E;&#x7C7B;&#x578B;&#x7B80;&#x4ECB;"><a name="&#x6570;&#x636E;&#x7C7B;&#x578B;&#x7B80;&#x4ECB;" class="anchor-navigation-ex-anchor" href="#&#x6570;&#x636E;&#x7C7B;&#x578B;&#x7B80;&#x4ECB;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x6570;&#x636E;&#x7C7B;&#x578B;&#x7B80;&#x4ECB;</h2>
<p>&#x622A;&#x6B62;&#x5230;6.0.6&#xFF0C;&#x4E00;&#x5171;&#x652F;&#x6301;9&#x79CD;&#x7C7B;&#x578B;</p>
<ol>
<li>Binary-safe strings&#xFF08;&#x4E8C;&#x8FDB;&#x5236;&#x5B89;&#x5168;&#x5B57;&#x7B26;&#x4E32;&#xFF09;</li>
<li>Lists&#xFF08;&#x5217;&#x8868;&#xFF09;</li>
<li>Sets&#xFF08;&#x96C6;&#x5408;&#xFF09;</li>
<li>Sorted sets&#xFF08;&#x6709;&#x5E8F;&#x96C6;&#x5408;&#xFF09;</li>
<li>Hashes&#xFF08;&#x54C8;&#x5E0C;&#xFF09;</li>
<li>Bit arrays&#xFF08;or simply bitmaps&#xFF09;&#xFF08;&#x4F4D;&#x56FE;&#xFF09;</li>
<li>HyperLogLogs</li>
<li>Geospatial</li>
<li>Streams</li>
</ol>
<p>&#x524D;&#x4E94;&#x79CD;&#x4E3A;&#x57FA;&#x7840;&#x7C7B;&#x578B;&#xFF0C;&#x540E;&#x56DB;&#x79CD;&#x662F;&#x57FA;&#x4E8E;&#x524D;&#x4E94;&#x79CD;&#x57FA;&#x672C;&#x7C7B;&#x578B;&#x53CA;&#x7279;&#x5B9A;&#x7B97;&#x6CD5;&#x6765;&#x5B9E;&#x73B0;&#x7684;&#x7279;&#x6B8A;&#x7C7B;&#x578B;</p>
<h2 id="&#x6570;&#x636E;&#x7ED3;&#x6784;"><a name="&#x6570;&#x636E;&#x7ED3;&#x6784;" class="anchor-navigation-ex-anchor" href="#&#x6570;&#x636E;&#x7ED3;&#x6784;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x6570;&#x636E;&#x7ED3;&#x6784;</h2>
<p>Redis&#x4E2D;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x7684;&#x5B58;&#x50A8;&#xFF0C;&#x90FD;&#x4F1A;&#x8FDB;&#x884C;&#x5305;&#x88C5;&#xFF0C;&#x6BCF;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;key-value&#x503C;&#xFF0C;&#x90FD;&#x4F1A;&#x521B;&#x5EFA;&#x4E24;&#x4E2A;&#x5BF9;&#x8C61;&#xFF0C;&#x4E00;&#x4E2A;&#x952E;&#x5BF9;&#x8C61;&#xFF0C;&#x4E00;&#x4E2A;&#x503C;&#x5BF9;&#x8C61;&#xFF0C;&#x503C;&#x5BF9;&#x8C61;&#x4F1A;&#x88AB;&#x5305;&#x88C5;&#x6210;redisObject&#x5BF9;&#x8C61;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x952E;&#x5BF9;&#x8C61;&#x548C;&#x503C;&#x5BF9;&#x8C61;&#x901A;&#x8FC7;dictEntry&#x5BF9;&#x8C61;&#x5C01;&#x88C5;</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">dictEntry</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token operator">*</span>key<span class="token punctuation">;</span> <span class="token comment">//&#x6307;&#x5411;key,&#x5373;sds</span>
    <span class="token keyword">union</span> <span class="token punctuation">{</span>
        <span class="token keyword">void</span> <span class="token operator">*</span>val<span class="token punctuation">;</span> <span class="token comment">//&#x6307;&#x5411;value&#xFF0C;&#x5373;redisObject</span>
        <span class="token class-name">uint64_t</span> u64<span class="token punctuation">;</span>
        <span class="token class-name">int64_t</span> s64<span class="token punctuation">;</span>
        <span class="token keyword">double</span> d<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> v<span class="token punctuation">;</span>
    <span class="token keyword">struct</span> <span class="token class-name">dictEntry</span> <span class="token operator">*</span>next<span class="token punctuation">;</span> <span class="token comment">//&#x6307;&#x5411;&#x4E0B;&#x4E00;&#x4E2A;key-value&#x952E;&#x503C;&#x5BF9;(&#x54C8;&#x5E0C;&#x503C;&#x76F8;&#x540C;&#x7684;&#x952E;&#x503C;&#x5BF9;&#x4F1A;&#x5F62;&#x6210;&#x4E00;&#x4E2A;&#x94FE;&#x8868;&#xFF0C;&#x4ECE;&#x800C;&#x89E3;&#x51B3;&#x54C8;&#x5E0C;&#x51B2;&#x7A81;&#x95EE;&#x9898;)</span>
<span class="token punctuation">}</span>
</code></pre>
<p>redisObject&#x5BF9;&#x8C61;&#x5B9A;&#x4E49;&#x4E3A;&#xFF1A;</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">redisObject</span><span class="token punctuation">{</span>
    <span class="token keyword">unsigned</span> type<span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">// &#x5BF9;&#x8C61;&#x7C7B;&#x578B;&#xFF08;4&#x4F4D;=0.5&#x5B57;&#x8282;&#xFF09;</span>
    <span class="token keyword">unsigned</span> encoding<span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">// &#x7F16;&#x7801;&#xFF08;4&#x4F4D;=0.5&#x5B57;&#x8282;&#xFF09;</span>
    unisgned lru<span class="token operator">:</span>LRU_BITS<span class="token punctuation">;</span> <span class="token comment">// &#x8BB0;&#x5F55;&#x5BF9;&#x8C61;&#x6700;&#x540E;&#x4E00;&#x6B21;&#x88AB;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x8BBF;&#x95EE;&#x7684;&#x65F6;&#x95F4;&#xFF08;24&#x4F4D;=3&#x5B57;&#x8282;&#xFF09;</span>
    <span class="token keyword">int</span> refcount<span class="token punctuation">;</span> <span class="token comment">// &#x5F15;&#x7528;&#x8BA1;&#x6570;&#x3002;&#x7B49;&#x4E8E;0&#x65F6;&#x8868;&#x793A;&#x53EF;&#x4EE5;&#x88AB;&#x5783;&#x573E;&#x56DE;&#x6536;&#xFF08;32&#x4F4D;=4&#x5B57;&#x8282;&#xFF09;</span>
    <span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">;</span> <span class="token comment">// &#x6307;&#x5411;&#x5E95;&#x5C42;&#x5B9E;&#x9645;&#x7684;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x7ED3;&#x6784;&#xFF0C;&#x5982;&#xFF1A;sds&#x3001;quicklist&#x7B49;&#xFF08;8&#x5B57;&#x8282;&#xFF09;</span>
<span class="token punctuation">}</span>robj<span class="token punctuation">;</span>
</code></pre>
<h2 id="&#x7C7B;&#x578B;&#x548C;&#x7F16;&#x7801;"><a name="&#x7C7B;&#x578B;&#x548C;&#x7F16;&#x7801;" class="anchor-navigation-ex-anchor" href="#&#x7C7B;&#x578B;&#x548C;&#x7F16;&#x7801;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x7C7B;&#x578B;&#x548C;&#x7F16;&#x7801;</h2>
<p>type &#x548C; encoding &#x7528;&#x6765;&#x8BB0;&#x5F55;&#x5F53;&#x524D;&#x7684;value&#x5C5E;&#x4E8E;&#x4EC0;&#x4E48;&#x57FA;&#x672C;&#x6570;&#x636E;&#x7C7B;&#x578B;&#xFF0C;&#x4EE5;&#x53CA;&#x91C7;&#x7528;&#x4E86;&#x54EA;&#x79CD;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x8FDB;&#x884C;&#x5B58;&#x50A8;</p>
<p>type &#x5C5E;&#x6027;&#x8868;&#x793A;&#x5BF9;&#x8C61;&#x7C7B;&#x578B;</p>
<table>
<thead>
<tr>
<th>&#x7C7B;&#x578B;&#x5C5E;&#x6027;</th>
<th>&#x63CF;&#x8FF0;</th>
<th>type&#x547D;&#x4EE4;&#x8FD4;&#x56DE;&#x503C;</th>
</tr>
</thead>
<tbody>
<tr>
<td>REDIS_STRING</td>
<td>&#x5B57;&#x7B26;&#x4E32;&#x5BF9;&#x8C61;</td>
<td>string</td>
</tr>
<tr>
<td>REDIS_LIST</td>
<td>&#x5217;&#x8868;&#x5BF9;&#x8C61;</td>
<td>list</td>
</tr>
<tr>
<td>REDIS_HASH</td>
<td>&#x54C8;&#x5E0C;&#x5BF9;&#x8C61;</td>
<td>hash</td>
</tr>
<tr>
<td>REDIS_SET</td>
<td>&#x96C6;&#x5408;&#x5BF9;&#x8C61;</td>
<td>set</td>
</tr>
<tr>
<td>REDIS_ZSET</td>
<td>&#x6709;&#x5E8F;&#x96C6;&#x5408;&#x5BF9;&#x8C61;</td>
<td>zset</td>
</tr>
</tbody>
</table>
<p>encoding &#x5C5E;&#x6027;&#x8868;&#x793A;&#x5BF9;&#x8C61;&#x7F16;&#x7801;&#x65B9;&#x5F0F;</p>
<table>
<thead>
<tr>
<th>&#x7F16;&#x7801;&#x5C5E;&#x6027;</th>
<th>&#x63CF;&#x8FF0;</th>
<th>object encoding &#x547D;&#x4EE4;&#x8FD4;&#x56DE;&#x503C;</th>
</tr>
</thead>
<tbody>
<tr>
<td>OBJ_ENCODING_INT</td>
<td>&#x4F7F;&#x7528;&#x6574;&#x6570;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x5BF9;&#x8C61;</td>
<td>int</td>
</tr>
<tr>
<td>OBJ_ENCODING_EMBSTR</td>
<td>&#x4F7F;&#x7528;embstr&#x7F16;&#x7801;&#x5B9E;&#x73B0;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x5BF9;&#x8C61;</td>
<td>embstr</td>
</tr>
<tr>
<td>OBJ_ENCODING_RAW</td>
<td>&#x4F7F;&#x7528;raw&#x7F16;&#x7801;&#x5B9E;&#x73B0;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x5BF9;&#x8C61;</td>
<td>raw</td>
</tr>
</tbody>
</table>
<p>&#x8BF4;&#x660E;&#xFF1A;</p>
<ul>
<li>int&#x7F16;&#x7801;&#xFF1A;&#x5982;&#x679C;&#x5B57;&#x7B26;&#x4E32;&#x5BF9;&#x8C61;&#x5B58;&#x50A8;&#x7684;&#x662F;&#x6574;&#x578B;&#xFF0C;&#x4E14;&#x80FD;&#x7528;8&#x4E2A;&#x5B57;&#x8282;&#x7684;long&#x7C7B;&#x578B;&#x8868;&#x793A;&#xFF0C;&#x5C31;&#x4F1A;&#x7528;int&#x7F16;&#x7801;&#x5B58;&#x50A8;&#xFF0C;redisObject&#x4E2D;&#x7684;ptr&#x6307;&#x9488;&#x4E5F;&#x4F1A;&#x66FF;&#x6362;&#x4E3A;long&#x7C7B;&#x578B;</li>
<li>embstr&#x7F16;&#x7801;&#xFF1A;&#x5F53;&#x50A8;&#x5B58;&#x7684;&#x662F;&#x5B57;&#x7B26;&#x4E32;&#x4E14;&#x957F;&#x5EA6;&#x5C0F;&#x4E8E;44&#xFF08;redis3.2&#x4E4B;&#x524D;&#x662F;39&#xFF09;&#xFF0C;&#x4F1A;&#x9009;&#x62E9;embstr&#x7F16;&#x7801;&#x6765;&#x5B58;&#x50A8;</li>
<li>raw&#x7F16;&#x7801;&#xFF1A;&#x5F53;&#x5B58;&#x50A8;&#x7684;&#x662F;&#x5B57;&#x7B26;&#x4E32;&#x4E14;&#x957F;&#x5EA6;&#x5927;&#x4E8E;44&#x65F6;&#xFF0C;&#x4F1A;&#x7528;raw&#x6765;&#x5B58;&#x50A8;</li>
</ul>
<p>embstr&#x7F16;&#x7801;&#x957F;&#x5EA6;&#x7684;&#x542B;&#x4E49;&#xFF1A;</p>
<ul>
<li>&#x5728;embstr&#x7F16;&#x7801;&#x4E2D;&#xFF0C;redisObject&#x548C;sds&#x662F;&#x8FDE;&#x7EED;&#x7684;&#x4E00;&#x5757;&#x7A7A;&#x95F4;&#xFF0C;Redis&#x9650;&#x5236;&#x957F;&#x5EA6;&#x4E3A;64&#x4E2A;&#x5B57;&#x8282;&#xFF0C;&#x5176;&#x4E2D;redisObject&#x56FA;&#x5B9A;&#x5360;&#x7528;16&#x4E2A;&#x5B57;&#x8282;&#xFF0C;&#x5269;&#x4F59;48&#x4E2A;&#x5B57;&#x8282;</li>
<li>redis3.2&#x7248;&#x672C;&#x4EE5;&#x524D;&#xFF0C;sds&#x5360;&#x7528;8&#x4E2A;&#x5B57;&#x8282;&#xFF0C;&#x52A0;&#x4E0A;&#x5B57;&#x7B26;&#x4E32;&#x672B;&#x5C3E;&#x7684;\0&#xFF0C;&#x6240;&#x4EE5;&#x53EA;&#x5269;39&#x4E2A;&#x5B57;&#x8282;</li>
<li>redis3.2&#x7248;&#x672C;&#x4EE5;&#x540E;&#xFF0C;embstr&#x91C7;&#x7528;sdshdr8&#x6765;&#x5B58;&#x50A8;&#xFF0C;sdshdr8&#x53EA;&#x5360;&#x7528;3&#x4E2A;&#x5B57;&#x8282;&#xFF08;len&#x3001;alloc&#x3001;flag&#x5404;&#x5360;&#x7528;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#xFF09;&#xFF0C;&#x52A0;&#x4E0A;&#x672B;&#x5C3E;&#x7684;\0&#xFF0C;&#x6240;&#x4EE5;&#x5269;&#x4F59;44&#x4E2A;&#x5B57;&#x8282;</li>
</ul>
<p>&#x6CE8;&#x610F;&#xFF1A;</p>
<ul>
<li>embstr&#x7F16;&#x7801;&#x5B57;&#x7B26;&#x4E32;&#x662F;&#x53EA;&#x8BFB;&#x7684;&#xFF0C;&#x5982;&#x679C;&#x5BF9;&#x5176;&#x4FEE;&#x6539;&#xFF0C;&#x4F1A;&#x91CD;&#x65B0;&#x5206;&#x914D;&#x5185;&#x5B58;&#xFF0C;&#x5E76;&#x4E14;&#x7F16;&#x7801;&#x8F6C;&#x6362;&#x4E3A;raw</li>
<li>&#x7F16;&#x7801;&#x4E00;&#x65E6;&#x5347;&#x7EA7;&#xFF08;int-&gt;embstr-&gt;raw&#xFF09;&#xFF0C;&#x65E0;&#x6CD5;&#x8FDB;&#x884C;&#x56DE;&#x9000;</li>
</ul>
<p>&#x547D;&#x4EE4;&#xFF1A;</p>
<ul>
<li><code>type &#x952E;&#x540D;</code> - &#x83B7;&#x53D6;&#x952E;&#x7684;&#x7C7B;&#x578B;</li>
<li><code>object encoding &#x952E;&#x540D;</code> - &#x83B7;&#x53D6;&#x952E;&#x7684;&#x5B58;&#x50A8;&#x65B9;&#x5F0F;</li>
</ul>
<h1 id="string-&#x4E8C;&#x8FDB;&#x5236;&#x5B89;&#x5168;&#x5B57;&#x7B26;&#x4E32;"><a name="string-&#x4E8C;&#x8FDB;&#x5236;&#x5B89;&#x5168;&#x5B57;&#x7B26;&#x4E32;" class="anchor-navigation-ex-anchor" href="#string-&#x4E8C;&#x8FDB;&#x5236;&#x5B89;&#x5168;&#x5B57;&#x7B26;&#x4E32;"><i class="fa fa-link" aria-hidden="true"></i></a>string &#x4E8C;&#x8FDB;&#x5236;&#x5B89;&#x5168;&#x5B57;&#x7B26;&#x4E32;</h1>
<h2 id="sds&#x7B80;&#x4ECB;"><a name="sds&#x7B80;&#x4ECB;" class="anchor-navigation-ex-anchor" href="#sds&#x7B80;&#x4ECB;"><i class="fa fa-link" aria-hidden="true"></i></a>SDS&#x7B80;&#x4ECB;</h2>
<p>Redis&#x81EA;&#x5DF1;&#x7F16;&#x5199;&#x4E86;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x6765;&#x8868;&#x793A;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x79F0;&#x4E3A;&#x7B80;&#x5355;&#x52A8;&#x6001;&#x5B57;&#x7B26;&#x4E32;&#xFF08;Simple dynamic string&#xFF09;&#xFF0C;&#x7B80;&#x79F0;sds</p>
<p>&#x4F18;&#x70B9;&#xFF1A;&#x4E0D;&#x4F1A;&#x7531;&#x4E8E;&#x5B57;&#x7B26;&#x4E32;&#x4E00;&#x76F4;&#x5360;&#x7528;&#x7740;&#x7A7A;&#x95F4;&#x800C;&#x5BFC;&#x81F4;&#x5185;&#x5B58;&#x6CC4;&#x6F0F;&#xFF0C;&#x4E5F;&#x4E0D;&#x4F1A;&#x7531;&#x4E8E;&#x524D;&#x9762;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x6269;&#x5145;&#x8986;&#x76D6;&#x5230;&#x540E;&#x9762;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x800C;&#x9020;&#x6210;&#x7F13;&#x5B58;&#x533A;&#x6EA2;&#x51FA;</p>
<h2 id="sds&#x7ED3;&#x6784;"><a name="sds&#x7ED3;&#x6784;" class="anchor-navigation-ex-anchor" href="#sds&#x7ED3;&#x6784;"><i class="fa fa-link" aria-hidden="true"></i></a>SDS&#x7ED3;&#x6784;</h2>
<p>&#x8001;&#x7248;&#x672C;sds&#x7ED3;&#x6784;&#x5B9A;&#x4E49;&#xFF1A;</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">struct</span> <span class="token class-name">sdshdr</span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> len<span class="token punctuation">;</span> <span class="token comment">// &#x8BB0;&#x5F55;buf&#x6570;&#x7EC4;&#x5DF2;&#x4F7F;&#x7528;&#x7684;&#x957F;&#x5EA6;&#xFF0C;&#x5373;SDS&#x7684;&#x957F;&#x5EA6;&#xFF08;&#x4E0D;&#x5305;&#x542B;&#x672B;&#x5C3E;&#x7684;`\0`&#xFF09;</span>
    <span class="token keyword">int</span> free<span class="token punctuation">;</span> <span class="token comment">// &#x8BB0;&#x5F55;bug&#x6570;&#x7EC4;&#x4E2D;&#x672A;&#x4F7F;&#x7528;&#x7684;&#x957F;&#x5EA6;</span>
    <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// &#x5B57;&#x8282;&#x6570;&#x7EC4;&#xFF0C;&#x7528;&#x6765;&#x4FDD;&#x5B58;&#x5B57;&#x7B26;&#x4E32;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>3.2&#x7248;&#x672C;&#x4E4B;&#x540E;&#x8FDB;&#x884C;&#x4E86;&#x4F18;&#x5316;&#xFF0C;&#x5206;&#x4E3A;&#x4E86;sdshdr5&#x3001;sdshdr8&#x3001;sdshdr16&#x3001;sdshdr32&#x3001;sdshdr64&#xFF0C;&#x5206;&#x522B;&#x7528;&#x6765;&#x5B58;&#x50A8;32 &#x5B57;&#x8282;&#xFF08;2^5&#xFF09;&#xFF0C;256 &#x5B57;&#x8282;&#xFF08;2^8&#xFF09;&#xFF0C;64KB&#xFF08;2^16&#xFF09;&#xFF0C;4GB &#x5927;&#x5C0F;&#xFF08;2^32&#xFF09;&#x4EE5;&#x53CA; 2^64 &#x5927;&#x5C0F;&#x7684;&#x5B57;&#x7B26;&#x4E32;</p>
<p>&#x56E0;&#x4E3A;&#x76EE;&#x524D;&#x7248;&#x672C; key &#x548C; value &#x90FD;&#x9650;&#x5236;&#x4E86;&#x6700;&#x5927; 512MB&#xFF0C;&#x6240;&#x4EE5; sdshdr64 &#x6682;&#x65F6;&#x5E76;&#x672A;&#x4F7F;&#x7528;&#x5230;</p>
<p>sdshdr5 &#x53EA;&#x88AB;&#x5E94;&#x7528;&#x5728;&#x4E86; Redis &#x7684; key &#x4E2D;&#xFF0C;value &#x4E2D;&#x4E0D;&#x4F1A;&#x88AB;&#x4F7F;&#x7528;&#x5230;&#xFF0C;&#x56E0;&#x4E3A; sdshdr5 &#x548C;&#x5176;&#x5B83;&#x7C7B;&#x578B;&#x4E5F;&#x4E0D;&#x4E00;&#x6837;&#xFF0C;&#x5176;&#x5E76;&#x6CA1;&#x6709;&#x5B58;&#x50A8;&#x672A;&#x4F7F;&#x7528;&#x7A7A;&#x95F4;&#xFF0C;&#x6240;&#x4EE5;&#x6BD4;&#x8F83;&#x9002;&#x7528;&#x4E8E;&#x4F7F;&#x7528;&#x5927;&#x5C0F;&#x56FA;&#x5B9A;&#x7684;&#x573A;&#x666F;&#xFF08;&#x6BD4;&#x5982; key &#x503C;&#xFF09;</p>
<pre class="language-"><code class="lang-c"><span class="token comment">//&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A;char &#x6307;&#x9488;</span>
<span class="token keyword">typedef</span> <span class="token keyword">char</span> <span class="token operator">*</span>sds<span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token keyword">__attribute__</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>__packed__<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token class-name">sdshdr5</span> <span class="token punctuation">{</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> flags<span class="token punctuation">;</span> <span class="token comment">/* 3 lsb of type, and 5 msb of string length */</span>
    <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//lsb &#x4EE3;&#x8868;&#x6700;&#x4F4E;&#x6709;&#x6548;&#x4F4D;&#x7684;&#x610F;&#x601D;&#xFF0C;msb&#x4EE3;&#x8868;&#x6700;&#x9AD8;&#x6709;&#x6548;&#x4F4D;</span>
<span class="token comment">//__attribute__ ((__packed__)) &#x4EE3;&#x8868;structure &#x91C7;&#x7528;&#x624B;&#x52A8;&#x5BF9;&#x9F50;&#x7684;&#x65B9;&#x5F0F;&#x3002;</span>
<span class="token keyword">struct</span> <span class="token keyword">__attribute__</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>__packed__<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token class-name">sdshdr8</span> <span class="token punctuation">{</span>
    <span class="token class-name">uint8_t</span> len<span class="token punctuation">;</span> <span class="token comment">/* &#x5DF2;&#x7ECF;&#x4F7F;&#x7528;&#x7684;&#x957F;&#x5EA6; */</span>
    <span class="token class-name">uint8_t</span> alloc<span class="token punctuation">;</span> <span class="token comment">/* &#x5206;&#x914D;&#x7684;&#x957F;&#x5EA6;&#xFF0C;&#x7B49;&#x4E8E;buf[]&#x7684;&#x603B;&#x957F;&#x5EA6;-1&#xFF0C;&#x56E0;&#x4E3A;buf&#x6709;&#x5305;&#x62EC;&#x4E00;&#x4E2A;/0&#x7684;&#x7ED3;&#x675F;&#x7B26; */</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> flags<span class="token punctuation">;</span> <span class="token comment">/* &#x6700;&#x4F4E;&#x4E09;&#x4F4D;&#x8868;&#x793A;&#x7C7B;&#x578B;&#xFF0C;0-4&#xFF0C;&#x524D;&#x4E94;&#x4F4D;&#x672A;&#x4F7F;&#x7528; */</span>
    <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">/* &#x5B9E;&#x9645;&#x7684;&#x5B57;&#x7B26;&#x4E32; */</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// &#x4E0E;&#x4E0A;&#x9762;&#x7684;&#x53D8;&#x5316;&#x53EA;&#x6709;len&#x548C;alloc&#xFF0C; &#x5C31;&#x662F;&#x957F;&#x5EA6;&#x4E0D;&#x540C;&#x800C;&#x5DF2;</span>
<span class="token keyword">struct</span> <span class="token keyword">__attribute__</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>__packed__<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token class-name">sdshdr16</span> <span class="token punctuation">{</span>
    <span class="token class-name">uint16_t</span> len<span class="token punctuation">;</span> <span class="token comment">/* used */</span>
    <span class="token class-name">uint16_t</span> alloc<span class="token punctuation">;</span> <span class="token comment">/* excluding the header and null terminator */</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> flags<span class="token punctuation">;</span> <span class="token comment">/* 3 lsb of type, 5 unused bits */</span>
    <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token keyword">__attribute__</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>__packed__<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token class-name">sdshdr32</span> <span class="token punctuation">{</span>
    <span class="token class-name">uint32_t</span> len<span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> alloc<span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> flags<span class="token punctuation">;</span>
    <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token keyword">__attribute__</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>__packed__<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token class-name">sdshdr64</span> <span class="token punctuation">{</span>
    <span class="token class-name">uint64_t</span> len<span class="token punctuation">;</span>
    <span class="token class-name">uint64_t</span> alloc<span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> flags<span class="token punctuation">;</span>
    <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="sds&#x547D;&#x4EE4;"><a name="sds&#x547D;&#x4EE4;" class="anchor-navigation-ex-anchor" href="#sds&#x547D;&#x4EE4;"><i class="fa fa-link" aria-hidden="true"></i></a>SDS&#x547D;&#x4EE4;</h2>
<ul>
<li><code>incr &#x952E;&#x540D;</code> - &#x5C06;&#x952E;&#x5BF9;&#x5E94;&#x7684;&#x503C;&#x52A0;1&#xFF0C;&#x53EA;&#x9002;&#x7528;&#x4E8E;value&#x4E3A;&#x6574;&#x6570;&#x7684;&#x60C5;&#x51B5;</li>
<li><code>decr &#x952E;&#x540D;</code> - &#x5C06;&#x952E;&#x5BF9;&#x5E94;&#x7684;&#x503C;&#x51CF;1&#xFF0C;&#x53EA;&#x9002;&#x7528;&#x4E8E;value&#x4E3A;&#x6574;&#x6570;&#x7684;&#x60C5;&#x51B5;</li>
<li><code>incrby &#x952E;&#x540D; n</code> - &#x5C06;&#x952E;&#x5BF9;&#x5E94;&#x7684;&#x503C;&#x52A0;n&#xFF0C;&#x53EA;&#x9002;&#x7528;&#x4E8E;value&#x4E3A;&#x6574;&#x6570;&#x7684;&#x60C5;&#x51B5;</li>
<li><code>decrby &#x952E;&#x540D; n</code> - &#x5C06;&#x952E;&#x5BF9;&#x5E94;&#x7684;&#x503C;&#x51CF;n&#xFF0C;&#x53EA;&#x9002;&#x7528;&#x4E8E;value&#x4E3A;&#x6574;&#x6570;&#x7684;&#x60C5;&#x51B5;</li>
</ul>
<h1 id="list-&#x5217;&#x8868;"><a name="list-&#x5217;&#x8868;" class="anchor-navigation-ex-anchor" href="#list-&#x5217;&#x8868;"><i class="fa fa-link" aria-hidden="true"></i></a>list &#x5217;&#x8868;</h1>
<h2 id="&#x5217;&#x8868;&#x7B80;&#x4ECB;"><a name="&#x5217;&#x8868;&#x7B80;&#x4ECB;" class="anchor-navigation-ex-anchor" href="#&#x5217;&#x8868;&#x7B80;&#x4ECB;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5217;&#x8868;&#x7B80;&#x4ECB;</h2>
<ul>
<li>Redis3.2&#x4E4B;&#x524D;&#xFF0C;&#x5217;&#x8868;&#x6709;&#x4E24;&#x79CD;&#x5B58;&#x50A8;&#x7ED3;&#x6784;&#xFF1A;linkedlist(&#x53CC;&#x7AEF;&#x5217;&#x8868;) &#x548C; ziplist(&#x538B;&#x7F29;&#x5217;&#x8868;)</li>
<li>Redis3.2&#x4E4B;&#x540E;&#xFF0C;&#x5217;&#x8868;&#x5BF9;&#x8C61;&#x5E95;&#x5C42;&#x53EA;&#x6709;&#x4E00;&#x79CD;&#x5B58;&#x50A8;&#x7ED3;&#x6784;&#xFF1A;quicklist(&#x5FEB;&#x901F;&#x5217;&#x8868;)</li>
</ul>
<p>&#x67E5;&#x770B;&#x5217;&#x8868;&#x5E95;&#x5C42;&#x7ED3;&#x6784;</p>
<table>
<thead>
<tr>
<th>&#x7F16;&#x7801;&#x5C5E;&#x6027;</th>
<th>&#x63CF;&#x8FF0;</th>
<th>object encoding&#x547D;&#x4EE4;&#x8FD4;&#x56DE;&#x503C;</th>
</tr>
</thead>
<tbody>
<tr>
<td>OBJ_ENCODING_LINKEDLIST</td>
<td>&#x4F7F;&#x7528;linkedlist&#x5B9E;&#x73B0;&#x5217;&#x8868;&#x5BF9;&#x8C61;</td>
<td>linkedlist</td>
</tr>
<tr>
<td>OBJ_ENCODING_ZIPLIST</td>
<td>&#x4F7F;&#x7528;ziplist&#x5B9E;&#x73B0;&#x5217;&#x8868;&#x5BF9;&#x8C61;</td>
<td>ziplist</td>
</tr>
<tr>
<td>OBJ_ENCODING_QUICKLIST</td>
<td>&#x4F7F;&#x7528;quicklist&#x5B9E;&#x73B0;&#x5217;&#x8868;&#x5BF9;&#x8C61;</td>
<td>quicklist</td>
</tr>
</tbody>
</table>
<p>ziplist &#x548C; linkedlist &#x7684;&#x9009;&#x62E9;&#xFF1A;</p>
<p>&#x4F7F;&#x7528;ziplist&#xFF0C;&#x9700;&#x8981;&#x540C;&#x65F6;&#x6EE1;&#x8DB3;&#x4EE5;&#x4E0B;&#x4E24;&#x4E2A;&#x6761;&#x4EF6;&#xFF1A;</p>
<ul>
<li>&#x5217;&#x8868;&#x5BF9;&#x8C61;&#x4FDD;&#x5B58;&#x7684;&#x6240;&#x6709;&#x5B57;&#x7B26;&#x4E32;&#x5143;&#x7D20;&#x7684;&#x957F;&#x5EA6;&#x90FD;&#x5C0F;&#x4E8E;64&#x5B57;&#x8282;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;list-max-ziplist-value&#x8FDB;&#x884C;&#x4FEE;&#x6539;</li>
<li>&#x5217;&#x8868;&#x5BF9;&#x8C61;&#x4FDD;&#x5B58;&#x7684;&#x5143;&#x7D20;&#x6570;&#x91CF;&#x5C0F;&#x4E8E;512&#x4E2A;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;list-max-ziplist-entries&#x8FDB;&#x884C;&#x4FEE;&#x6539;</li>
</ul>
<h2 id="&#x538B;&#x7F29;&#x5217;&#x8868;ziplist"><a name="&#x538B;&#x7F29;&#x5217;&#x8868;ziplist" class="anchor-navigation-ex-anchor" href="#&#x538B;&#x7F29;&#x5217;&#x8868;ziplist"><i class="fa fa-link" aria-hidden="true"></i></a>&#x538B;&#x7F29;&#x5217;&#x8868;ziplist</h2>
<h3 id="&#x538B;&#x7F29;&#x5217;&#x8868;&#x7B80;&#x4ECB;"><a name="&#x538B;&#x7F29;&#x5217;&#x8868;&#x7B80;&#x4ECB;" class="anchor-navigation-ex-anchor" href="#&#x538B;&#x7F29;&#x5217;&#x8868;&#x7B80;&#x4ECB;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x538B;&#x7F29;&#x5217;&#x8868;&#x7B80;&#x4ECB;</h3>
<ul>
<li>ziplist &#x662F;&#x4E00;&#x79CD;&#x8282;&#x7701;&#x5185;&#x5B58;&#x7684;&#x6570;&#x636E;&#x7ED3;&#x6784;</li>
<li>ziplist &#x662F;&#x4E00;&#x5757;&#x8FDE;&#x7EED;&#x5185;&#x5B58;&#x5757;&#x7684;&#x987A;&#x5E8F;&#x578B;&#x6570;&#x636E;&#x7ED3;&#x6784;</li>
<li>ziplist &#x662F;&#x7531;&#x591A;&#x4E2A;entry&#x7EC4;&#x6210;&#x7684;&#xFF0C;&#x6BCF;&#x4E2A;entry&#x53EF;&#x4EE5;&#x4FDD;&#x5B58;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#x6570;&#x7EC4;&#x6216;&#x8005;&#x6574;&#x6570;&#x503C;</li>
<li>ziplist &#x548C;&#x53CC;&#x7AEF;&#x5217;&#x8868;&#xFF08;&#x5982;likedlist&#xFF09;&#x533A;&#x522B;&#x662F;&#x4E0D;&#x5B58;&#x50A8;&#x524D;&#x540E;&#x8282;&#x70B9;&#x7684;&#x6307;&#x9488;&#xFF08;&#x901A;&#x5E38;&#x5360;8&#x4E2A;&#x5B57;&#x8282;&#xFF09;&#xFF0C;&#x800C;&#x662F;&#x7EF4;&#x62A4;&#x4E86;&#x4E0A;&#x4E00;&#x4E2A;&#x8282;&#x70B9;&#x548C;&#x5F53;&#x524D;&#x8282;&#x70B9;&#x7684;&#x957F;&#x5EA6;</li>
<li>ziplist &#x6709;&#x8FDE;&#x9501;&#x66F4;&#x65B0;&#x7684;&#x95EE;&#x9898;&#x3002;&#x5F53;&#x591A;&#x4E2A;&#x8282;&#x70B9;&#x7684;&#x957F;&#x5EA6;&#x4F4D;&#x63A5;&#x8FD1;254&#xFF08;250-253&#xFF09;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4E0B;&#x4E00;&#x4E2A;&#x8282;&#x70B9;&#x5B58;&#x50A8;&#x4E0A;&#x4E00;&#x4E2A;&#x8282;&#x70B9;&#x53EA;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#xFF0C;&#x5982;&#x679C;&#x63D2;&#x5165;&#x4E00;&#x4E2A;&#x65B0;&#x8282;&#x70B9;&#x5927;&#x4E8E;254&#xFF0C;&#x5219;&#x4E0B;&#x4E00;&#x4E2A;&#x8282;&#x70B9;&#x5B58;&#x50A8;&#x4E0A;&#x4E00;&#x4E2A;&#x8282;&#x70B9;&#x7684;&#x4F4D;&#x7F6E;&#x4F1A;&#x7531;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#x53D8;&#x4E3A;5&#x4E2A;&#x5B57;&#x8282;&#xFF0C;&#x4EE5;&#x6B64;&#x7C7B;&#x63A8;&#x3002;</li>
</ul>
<h3 id="&#x538B;&#x7F29;&#x5217;&#x8868;&#x5C5E;&#x6027;&#x8BF4;&#x660E;"><a name="&#x538B;&#x7F29;&#x5217;&#x8868;&#x5C5E;&#x6027;&#x8BF4;&#x660E;" class="anchor-navigation-ex-anchor" href="#&#x538B;&#x7F29;&#x5217;&#x8868;&#x5C5E;&#x6027;&#x8BF4;&#x660E;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x538B;&#x7F29;&#x5217;&#x8868;&#x5C5E;&#x6027;&#x8BF4;&#x660E;</h3>
<table>
<thead>
<tr>
<th>&#x5C5E;&#x6027;</th>
<th>&#x7C7B;&#x578B;</th>
<th>&#x957F;&#x5EA6;</th>
<th>&#x8BF4;&#x660E;</th>
</tr>
</thead>
<tbody>
<tr>
<td>zlbytes</td>
<td>uint32_t</td>
<td>4&#x5B57;&#x8282;</td>
<td>&#x8BB0;&#x5F55;&#x538B;&#x7F29;&#x5217;&#x8868;&#x5360;&#x7528;&#x7684;&#x5B57;&#x8282;&#x6570;&#xFF0C;&#x5305;&#x62EC;&#x81EA;&#x5DF1;&#x7684;&#x56DB;&#x4E2A;&#x5B57;&#x8282;</td>
</tr>
<tr>
<td>zltail</td>
<td>uint32_t</td>
<td>4&#x5B57;&#x8282;</td>
<td>&#x8BB0;&#x5F55;&#x538B;&#x7F29;&#x5217;&#x8868;&#x672B;&#x8282;&#x70B9;&#x8DDD;&#x79BB;&#x538B;&#x7F29;&#x5217;&#x8868;&#x8D77;&#x59CB;&#x5730;&#x5740;&#x7684;&#x5B57;&#x8282;&#x6570;&#xFF08;&#x8BA1;&#x7B97;&#x5C3E;&#x8282;&#x70B9;&#x7684;&#x5730;&#x5740;&#xFF0C;&#x6CE8;&#x610F;&#x662F;&#x5C3E;&#x8282;&#x70B9;&#x7684;&#x5F00;&#x59CB;&#x8DDD;&#x79BB;ziplist&#x7684;&#x5F00;&#x59CB;&#x7684;&#x5B57;&#x8282;&#x6570;&#xFF09;</td>
</tr>
<tr>
<td>zllen</td>
<td>uint16_t</td>
<td>2&#x5B57;&#x8282;</td>
<td>&#x8BB0;&#x5F55;&#x538B;&#x7F29;&#x5217;&#x8868;&#x5305;&#x542B;&#x7684;&#x8282;&#x70B9;&#x6570;&#x91CF;&#xFF0C;&#x5F53;&#x957F;&#x5EA6;&#x8D85;&#x8FC7;65535&#x65F6;&#xFF0C;&#x5B58;&#x50A8;&#x4E3A;65535&#xFF0C;&#x6B64;&#x65F6;&#x9700;&#x8981;&#x904D;&#x5386;&#x8BA1;&#x7B97;&#x771F;&#x5B9E;&#x7684;&#x8282;&#x70B9;&#x6570;&#x91CF;</td>
</tr>
<tr>
<td>entry</td>
<td>&#x8282;&#x70B9;</td>
<td>-</td>
<td>&#x538B;&#x7F29;&#x5217;&#x8868;&#x4E2D;&#x7684;&#x8282;&#x70B9;&#xFF0C;&#x5B58;&#x50A8;&#x5B9E;&#x9645;&#x6570;&#x636E;</td>
</tr>
<tr>
<td>zlend</td>
<td>uint8_t</td>
<td>1&#x5B57;&#x8282;</td>
<td>&#x7279;&#x6B8A;&#x5B57;&#x7B26;0xff&#xFF0C;&#x6807;&#x8BB0;&#x538B;&#x7F29;&#x5217;&#x8868;&#x7684;&#x672B;&#x7AEF;</td>
</tr>
</tbody>
</table>
<h3 id="&#x538B;&#x7F29;&#x5217;&#x8868;&#x7ED3;&#x6784;"><a name="&#x538B;&#x7F29;&#x5217;&#x8868;&#x7ED3;&#x6784;" class="anchor-navigation-ex-anchor" href="#&#x538B;&#x7F29;&#x5217;&#x8868;&#x7ED3;&#x6784;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x538B;&#x7F29;&#x5217;&#x8868;&#x7ED3;&#x6784;</h3>
<p>ziplist&#x7684;&#x7ED3;&#x6784;&#xFF1A;</p>
<pre class="language-"><code class="lang-c"><span class="token operator">&lt;</span>zlbytes<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>zltail<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>zllen<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>entry<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>entry<span class="token operator">&gt;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token operator">&lt;</span>entry<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>zlend<span class="token operator">&gt;</span>
</code></pre>
<ul>
<li>zlbytes&#x3001;zltail&#x3001;zllen &#x4E3A; ziplist &#x7684; head &#x90E8;&#x5206;&#xFF1B;</li>
<li>entry &#x4E3A; ziplist &#x7684; entries &#x90E8;&#x5206;&#xFF0C;&#x6BCF;&#x4E00;&#x4E2A; entry &#x4EE3;&#x8868;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#xFF1B;</li>
<li>&#x6700;&#x540E; zlend &#x8868;&#x793A; ziplist &#x7684; end &#x90E8;&#x5206;&#x3002;</li>
</ul>
<p>entry&#x7684;&#x7ED3;&#x6784;&#xFF1A;</p>
<pre class="language-"><code class="lang-c"><span class="token operator">&lt;</span>prevlen<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>encoding<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>entry<span class="token operator">-</span>data<span class="token operator">&gt;</span>
</code></pre>
<p>prevlen</p>
<ul>
<li>&#x5B58;&#x50A8;&#x4E86;&#x524D;&#x4E00;&#x4E2A;entry&#x7684;&#x957F;&#x5EA6;&#xFF0C;&#x53EF;&#x4EE5;&#x8BA1;&#x7B97;&#x51FA;&#x524D;&#x4E00;&#x4E2A;entry&#x7684;&#x5730;&#x5740;&#xFF0C;&#x8FDB;&#x7A0B;&#x4ECE;&#x540E;&#x5411;&#x524D;&#x904D;&#x5386;&#xFF0C;prevlen&#x957F;&#x5EA6;&#x53EF;&#x80FD;&#x662F;1&#x6216;5</li>
<li>&#x5F53;&#x94FE;&#x8868;&#x7684;&#x524D;&#x4E00;&#x4E2A;entry&#x5360;&#x7528;&#x5B57;&#x8282;&#x5C0F;&#x4E8E;254&#xFF0C;&#x5219;&#x7528;1&#x4E2A;&#x5B57;&#x8282;&#x8868;&#x793A;</li>
<li>&#x5F53;&#x94FE;&#x8868;&#x7684;&#x524D;&#x4E00;&#x4E2A;entry&#x5360;&#x7528;&#x5B57;&#x8282;&#x5927;&#x4E8E;&#x6216;&#x7B49;&#x4E8E;254&#x65F6;&#xFF0C;&#x7528;5&#x4E2A;&#x5B57;&#x8282;&#x8868;&#x793A;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#x4E3A;254&#xFF0C;&#x540E;&#x56DB;&#x4E2A;&#x5B57;&#x8282;&#x8868;&#x793A;&#x524D;&#x4E00;&#x4E2A;entry&#x7684;&#x771F;&#x5B9E;&#x5360;&#x7528;&#x5B57;&#x8282;&#x6570;</li>
<li>prevlen&#x53EA;&#x53D6;&#x5230;254&#x662F;&#x56E0;&#x4E3A;255&#x662F;ziplist&#x7684;zlend&#x56FA;&#x5B9A;&#x4E3A;255&#xFF0C;&#x9632;&#x6B62;&#x51B2;&#x7A81;</li>
</ul>
<p>encoding</p>
<ul>
<li>&#x5B58;&#x50A8;&#x4E86;&#x5F53;&#x524D;entry&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x53CA;&#x957F;&#x5EA6;&#xFF0C;encoding&#x7684;&#x957F;&#x5EA6;&#x4E3A;1&#x5B57;&#x8282;&#x3001;2&#x5B57;&#x8282;&#x6216;5&#x5B57;&#x8282;</li>
<li>encoding&#x7B2C;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#x6765;&#x786E;&#x5B9A;&#x5F53;&#x524D;entry&#x5B58;&#x50A8;&#x7684;&#x662F;&#x6574;&#x6570;&#x8FD8;&#x662F;&#x5B57;&#x8282;&#x6570;&#x7EC4;&#xFF0C;&#x5F53;&#x4E3A;&#x6574;&#x6570;&#x65F6;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#x524D;&#x4E24;&#x4F4D;&#x603B;&#x662F;11&#xFF0C;&#x5176;&#x4ED6;&#x60C5;&#x51B5;&#x5219;&#x662F;&#x5B57;&#x8282;&#x6570;&#x7EC4;</li>
</ul>
<p>encoding&#x5B58;&#x50A8;&#x4E3A;&#x6574;&#x578B;&#x65F6;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#x7684;&#x542B;&#x4E49;&#xFF08;&#x524D;&#x4E24;&#x4F4D;&#x603B;&#x4E3A;11&#xFF09;&#xFF1A;</p>
<table>
<thead>
<tr>
<th>&#x7F16;&#x7801;</th>
<th>&#x957F;&#x5EA6;</th>
<th>entry &#x4FDD;&#x5B58;&#x7684;&#x6570;&#x636E;</th>
</tr>
</thead>
<tbody>
<tr>
<td>11000000</td>
<td>1&#x5B57;&#x8282;</td>
<td>int16_t &#x7C7B;&#x578B;&#x6574;&#x6570;</td>
</tr>
<tr>
<td>11010000</td>
<td>1&#x5B57;&#x8282;</td>
<td>int32_t &#x7C7B;&#x578B;&#x6574;&#x6570;</td>
</tr>
<tr>
<td>11100000</td>
<td>1&#x5B57;&#x8282;</td>
<td>int64_t &#x7C7B;&#x578B;&#x6574;&#x6570;</td>
</tr>
<tr>
<td>11110000</td>
<td>1&#x5B57;&#x8282;</td>
<td>24 &#x4F4D;&#x6709;&#x7B26;&#x53F7;&#x6574;&#x6570;</td>
</tr>
<tr>
<td>11111110</td>
<td>1&#x5B57;&#x8282;</td>
<td>8 &#x4F4D;&#x6709;&#x7B26;&#x53F7;&#x6574;&#x6570;</td>
</tr>
<tr>
<td>1111xxxx</td>
<td>1&#x5B57;&#x8282;</td>
<td>xxxx &#x4EE3;&#x8868;&#x533A;&#x95F4; 0001-1101&#xFF0C;&#x5B58;&#x50A8;&#x4E86;&#x4E00;&#x4E2A;&#x4ECB;&#x4E8E; 0-12 &#x4E4B;&#x95F4;&#x7684;&#x6574;&#x6570;&#xFF0C;&#x6B64;&#x65F6; entry-data &#x5C5E;&#x6027;&#x88AB;&#x7701;&#x7565;</td>
</tr>
</tbody>
</table>
<p>&#x6CE8;&#x610F;&#xFF1A;xxxx&#x53EA;&#x80FD;&#x53D6;&#x503C;0001-1101&#x4E4B;&#x95F4;&#xFF0C;&#x56E0;&#x4E3A;0000&#x3001;1110&#x3001;1111&#x88AB;&#x4F7F;&#x7528;&#x4E86;&#x3002;&#x800C;&#x4E14;&#x56E0;&#x4E3A;0&#x662F;&#x4E00;&#x4E2A;&#x5E38;&#x7528;&#x7684;&#x6570;&#xFF0C;&#x6240;&#x4EE5;&#x5C06;0001-1101&#x90FD;&#x51CF;&#x53BB;1&#xFF0C;&#x8868;&#x793A;&#x4E3A;0-12</p>
<p>encoding&#x5B58;&#x50A8;&#x4E3A;&#x5B57;&#x8282;&#x6570;&#x7EC4;&#x65F6;&#xFF0C;&#x7528;00&#x3001;01&#x3001;10&#x6765;&#x8868;&#x793A;&#x5B57;&#x8282;&#x6570;&#x7EC4;&#x7684;&#x957F;&#x5EA6;&#xFF1A;</p>
<table>
<thead>
<tr>
<th>&#x7F16;&#x7801;</th>
<th>&#x957F;&#x5EA6;</th>
<th>entry&#x4FDD;&#x5B58;&#x7684;&#x6570;&#x636E;</th>
</tr>
</thead>
<tbody>
<tr>
<td>00pppppp</td>
<td>1&#x5B57;&#x8282;</td>
<td>&#x957F;&#x5EA6;&#x5C0F;&#x4E8E;&#x7B49;&#x4E8E; 63 &#x5B57;&#x8282;&#xFF08;6 &#x4F4D;&#xFF09;&#x7684;&#x5B57;&#x8282;&#x6570;&#x7EC4;</td>
</tr>
<tr>
<td>01pppppp qqqqqqqq</td>
<td>2&#x5B57;&#x8282;</td>
<td>&#x957F;&#x5EA6;&#x5C0F;&#x4E8E;&#x7B49;&#x4E8E; 16383 &#x5B57;&#x8282;&#xFF08;14 &#x4F4D;&#xFF09;&#x7684;&#x5B57;&#x8282;&#x6570;&#x7EC4;</td>
</tr>
<tr>
<td>10000000 qqqqqqqq rrrrrrrr ssssssss tttttttt</td>
<td>5&#x5B57;&#x8282;</td>
<td>&#x957F;&#x5EA6;&#x5C0F;&#x4E8E;&#x7B49;&#x4E8E; 2 &#x7684; 32 &#x6B21;&#x65B9;&#x51CF; 1 &#xFF08;32 &#x4F4D;&#xFF09;&#x7684;&#x5B57;&#x8282;&#x6570;&#x7EC4;&#xFF0C;&#x5176;&#x4E2D;&#x7B2C; 1 &#x4E2A;&#x5B57;&#x8282;&#x7684;&#x540E; 6 &#x4F4D;&#x8BBE;&#x7F6E;&#x4E3A; 0&#xFF0C;&#x6682;&#x65F6;&#x6CA1;&#x6709;&#x7528;&#x5230;&#xFF0C;&#x540E;&#x9762;&#x7684; 32 &#x4F4D;&#xFF08;4 &#x4E2A;&#x5B57;&#x8282;&#xFF09;&#x5B58;&#x50A8;&#x4E86;&#x6570;&#x636E;</td>
</tr>
</tbody>
</table>
<p>entry-data</p>
<ul>
<li>entry-data &#x5B58;&#x50A8;&#x7684;&#x662F;&#x6570;&#x636E;&#x7684;&#x672C;&#x8EAB;</li>
<li>&#x5B58;&#x50A8;0-12&#x65F6;&#xFF0C;&#x6570;&#x636E;&#x4FDD;&#x5B58;&#x5728;encoding&#x4E2D;&#xFF0C;&#x6B64;&#x65F6;entry-data&#x4F1A;&#x88AB;&#x7701;&#x7565;</li>
</ul>
<h2 id="linkedlist-&#x53CC;&#x7AEF;&#x5217;&#x8868;"><a name="linkedlist-&#x53CC;&#x7AEF;&#x5217;&#x8868;" class="anchor-navigation-ex-anchor" href="#linkedlist-&#x53CC;&#x7AEF;&#x5217;&#x8868;"><i class="fa fa-link" aria-hidden="true"></i></a>linkedlist &#x53CC;&#x7AEF;&#x5217;&#x8868;</h2>
<h3 id="&#x53CC;&#x7AEF;&#x5217;&#x8868;&#x7B80;&#x4ECB;"><a name="&#x53CC;&#x7AEF;&#x5217;&#x8868;&#x7B80;&#x4ECB;" class="anchor-navigation-ex-anchor" href="#&#x53CC;&#x7AEF;&#x5217;&#x8868;&#x7B80;&#x4ECB;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x53CC;&#x7AEF;&#x5217;&#x8868;&#x7B80;&#x4ECB;</h3>
<ul>
<li>&#x6BCF;&#x4E2A;&#x8282;&#x70B9;&#x90FD;&#x4F1A;&#x5B58;&#x50A8;&#x6307;&#x5411;&#x4E0A;&#x4E00;&#x4E2A;&#x8282;&#x70B9;&#x548C;&#x4E0B;&#x4E00;&#x4E2A;&#x8282;&#x70B9;&#x7684;&#x6307;&#x9488;</li>
<li>&#x6BCF;&#x4E2A;&#x8282;&#x70B9;&#x4E4B;&#x95F4;&#x7684;&#x7A7A;&#x95F4;&#x4E0D;&#x8FDE;&#x7EED;&#xFF0C;&#x4F1A;&#x9020;&#x6210;&#x7A7A;&#x95F4;&#x788E;&#x7247;</li>
<li>linkedlist&#x662F;&#x4E00;&#x4E2A;&#x5C01;&#x88C5;&#x7684;list&#x5BF9;&#x8C61;&#xFF0C;list&#x7531;&#x591A;&#x4E2A;listNode&#x7EC4;&#x6210;</li>
</ul>
<h3 id="&#x53CC;&#x7AEF;&#x5217;&#x8868;&#x7ED3;&#x6784;"><a name="&#x53CC;&#x7AEF;&#x5217;&#x8868;&#x7ED3;&#x6784;" class="anchor-navigation-ex-anchor" href="#&#x53CC;&#x7AEF;&#x5217;&#x8868;&#x7ED3;&#x6784;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x53CC;&#x7AEF;&#x5217;&#x8868;&#x7ED3;&#x6784;</h3>
<p>listNode&#x662F;&#x4E00;&#x4E2A;list&#x5BF9;&#x8C61;</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">list</span> <span class="token punctuation">{</span>
    listNode <span class="token operator">*</span>head<span class="token punctuation">;</span> <span class="token comment">//&#x5934;&#x8282;&#x70B9;</span>
    listNode <span class="token operator">*</span>tail<span class="token punctuation">;</span> <span class="token comment">//&#x5C3E;&#x8282;&#x70B9;</span>
    <span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">*</span>dup<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&#x8282;&#x70B9;&#x503C;&#x590D;&#x5236;&#x51FD;&#x6570;</span>
    <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>free<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&#x8282;&#x70B9;&#x503C;&#x91CA;&#x653E;&#x51FD;&#x6570;</span>
    <span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>match<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&#x8282;&#x70B9;&#x503C;&#x5BF9;&#x6BD4;&#x51FD;&#x6570;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> len<span class="token punctuation">;</span> <span class="token comment">//&#x8282;&#x70B9;&#x6570;&#x91CF;</span>
<span class="token punctuation">}</span> list<span class="token punctuation">;</span>
</code></pre>
<p>listNode&#x7ED3;&#x6784;</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">listNode</span> <span class="token punctuation">{</span>
    <span class="token keyword">struct</span> <span class="token class-name">listNode</span> <span class="token operator">*</span>prev<span class="token punctuation">;</span> <span class="token comment">//&#x524D;&#x4E00;&#x4E2A;&#x8282;&#x70B9;</span>
    <span class="token keyword">struct</span> <span class="token class-name">listNode</span> <span class="token operator">*</span>next<span class="token punctuation">;</span> <span class="token comment">//&#x540E;&#x4E00;&#x4E2A;&#x8282;&#x70B9;</span>
    <span class="token keyword">void</span> <span class="token operator">*</span>value<span class="token punctuation">;</span> <span class="token comment">//&#x503C;(&#x5B57;&#x7B26;&#x4E32;&#x5BF9;&#x8C61;)</span>
<span class="token punctuation">}</span> listNode<span class="token punctuation">;</span>
</code></pre>
<p>&#x5F53;next&#x6307;&#x5411;NULL&#x65F6;&#xFF0C;&#x8868;&#x793A;&#x5DF2;&#x7ECF;&#x5230;&#x4E86;&#x5217;&#x8868;&#x672B;&#x5C3E;&#x4E86;</p>
<h2 id="quicklist-&#x5FEB;&#x901F;&#x5217;&#x8868;"><a name="quicklist-&#x5FEB;&#x901F;&#x5217;&#x8868;" class="anchor-navigation-ex-anchor" href="#quicklist-&#x5FEB;&#x901F;&#x5217;&#x8868;"><i class="fa fa-link" aria-hidden="true"></i></a>quicklist &#x5FEB;&#x901F;&#x5217;&#x8868;</h2>
<h3 id="&#x5FEB;&#x901F;&#x5217;&#x8868;&#x7B80;&#x4ECB;"><a name="&#x5FEB;&#x901F;&#x5217;&#x8868;&#x7B80;&#x4ECB;" class="anchor-navigation-ex-anchor" href="#&#x5FEB;&#x901F;&#x5217;&#x8868;&#x7B80;&#x4ECB;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5FEB;&#x901F;&#x5217;&#x8868;&#x7B80;&#x4ECB;</h3>
<ul>
<li>quicklist&#x5B58;&#x50A8;&#x4E86;&#x4E00;&#x4E2A;&#x53CC;&#x5411;&#x5217;&#x8868;&#xFF0C;&#x6BCF;&#x4E2A;&#x8282;&#x70B9;&#x5C31;&#x662F;&#x4E00;&#x4E2A;ziplist</li>
<li>quicklist&#x5B9E;&#x9645;&#x4E0A;&#x5C31;&#x662F;ziplist&#x548C;linkedlist&#x7684;&#x7ED3;&#x5408;</li>
<li>quicklist&#x7684;&#x6BCF;&#x4E2A;&#x8282;&#x70B9;&#x90FD;&#x662F;&#x4E00;&#x4E2A;quicklistNode&#x5BF9;&#x8C61;</li>
</ul>
<h3 id="&#x5FEB;&#x901F;&#x5217;&#x8868;&#x7ED3;&#x6784;"><a name="&#x5FEB;&#x901F;&#x5217;&#x8868;&#x7ED3;&#x6784;" class="anchor-navigation-ex-anchor" href="#&#x5FEB;&#x901F;&#x5217;&#x8868;&#x7ED3;&#x6784;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5FEB;&#x901F;&#x5217;&#x8868;&#x7ED3;&#x6784;</h3>
<p>quicklist&#x5BF9;&#x8C61;&#x7ED3;&#x6784;&#xFF1A;</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">quicklist</span> <span class="token punctuation">{</span>
    quicklistNode <span class="token operator">*</span>head<span class="token punctuation">;</span> <span class="token comment">//&#x5217;&#x8868;&#x5934;&#x8282;&#x70B9;</span>
    quicklistNode <span class="token operator">*</span>tail<span class="token punctuation">;</span> <span class="token comment">//&#x5217;&#x8868;&#x5C3E;&#x8282;&#x70B9;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> count<span class="token punctuation">;</span> <span class="token comment">//ziplist&#x4E2D;&#x4E00;&#x5171;&#x5B58;&#x50A8;&#x4E86;&#x591A;&#x5C11;&#x5143;&#x7D20;&#xFF0C;&#x5373;:&#x6BCF;&#x4E00;&#x4E2A;quicklistNode&#x5185;&#x7684;count&#x76F8;&#x52A0;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> len<span class="token punctuation">;</span> <span class="token comment">//&#x53CC;&#x5411;&#x94FE;&#x8868;&#x7684;&#x957F;&#x5EA6;&#xFF0C;&#x5373;quicklistNode&#x7684;&#x6570;&#x91CF;</span>
    <span class="token keyword">int</span> fill <span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">;</span> <span class="token comment">//&#x586B;&#x5145;&#x56E0;&#x5B50;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> compress <span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">;</span> <span class="token comment">//&#x538B;&#x7F29;&#x6DF1;&#x5EA6; 0-&#x4E0D;&#x538B;&#x7F29;</span>
<span class="token punctuation">}</span> quicklist<span class="token punctuation">;</span>
</code></pre>
<p>quicklistNode&#x5BF9;&#x8C61;&#x7ED3;&#x6784;&#x5B9A;&#x4E49;&#xFF1A;</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">quicklistNode</span> <span class="token punctuation">{</span>
    <span class="token keyword">struct</span> <span class="token class-name">quicklistNode</span> <span class="token operator">*</span>prev<span class="token punctuation">;</span> <span class="token comment">//&#x524D;&#x4E00;&#x4E2A;&#x8282;&#x70B9;</span>
    <span class="token keyword">struct</span> <span class="token class-name">quicklistNode</span> <span class="token operator">*</span>next<span class="token punctuation">;</span> <span class="token comment">//&#x540E;&#x4E00;&#x4E2A;&#x8282;&#x70B9;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>zl<span class="token punctuation">;</span> <span class="token comment">//&#x5F53;&#x524D;&#x6307;&#x5411;&#x7684;ziplist&#x6216;&#x8005;quicklistLZF</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> sz<span class="token punctuation">;</span> <span class="token comment">//&#x5F53;&#x524D;ziplist&#x5360;&#x7528;&#x5B57;&#x8282;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> count <span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">;</span> <span class="token comment">//ziplist&#x4E2D;&#x5B58;&#x50A8;&#x7684;&#x5143;&#x7D20;&#x4E2A;&#x6570;&#xFF0C;16&#x5B57;&#x8282;(&#x6700;&#x5927;65535&#x4E2A;)</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> encoding <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">//&#x662F;&#x5426;&#x91C7;&#x7528;&#x4E86;LZF&#x538B;&#x7F29;&#x7B97;&#x6CD5;&#x538B;&#x7F29;&#x8282;&#x70B9; 1&#xFF1A;RAW 2:LZF</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> container <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">//&#x5B58;&#x50A8;&#x7ED3;&#x6784;&#xFF0C;NONE=1, ZIPLIST=2</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> recompress <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//&#x5F53;&#x524D;ziplist&#x662F;&#x5426;&#x9700;&#x8981;&#x518D;&#x6B21;&#x538B;&#x7F29;(&#x5982;&#x679C;&#x524D;&#x9762;&#x88AB;&#x89E3;&#x538B;&#x8FC7;&#x5219;&#x4E3A;true&#xFF0C;&#x8868;&#x793A;&#x9700;&#x8981;&#x518D;&#x6B21;&#x88AB;&#x538B;&#x7F29;)</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> attempted_compress <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//&#x6D4B;&#x8BD5;&#x7528; </span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> extra <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">//&#x540E;&#x671F;&#x7559;&#x7528;</span>
<span class="token punctuation">}</span> quicklistNode<span class="token punctuation">;</span>
</code></pre>
<ul>
<li>compress &#x538B;&#x7F29;&#x6DF1;&#x5EA6;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;list-compress-depth&#x63A7;&#x5236;&#xFF0C;&#x9ED8;&#x8BA4;&#x4E3A;0&#x4E0D;&#x538B;&#x7F29;&#xFF0C;1&#x8868;&#x793A;&#x9996;&#x5C3E;&#x7B2C;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x4E0D;&#x538B;&#x7F29;&#xFF0C;&#x4EE5;&#x6B64;&#x7C7B;&#x63A8;</li>
<li>zl &#x9ED8;&#x8BA4;&#x6307;&#x5411;ziplist&#xFF0C;&#x5982;&#x679C;&#x8282;&#x70B9;&#x88AB;&#x538B;&#x7F29;&#x4E86;&#xFF0C;&#x5219;&#x6307;&#x5411;&#x4E00;&#x4E2A;quicklistLZF&#x5BF9;&#x8C61;</li>
</ul>
<p>quicklistLZF&#x5BF9;&#x8C61;</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">quicklistLZF</span> <span class="token punctuation">{</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> sz<span class="token punctuation">;</span> <span class="token comment">// LZF&#x5927;&#x5C0F;&#xFF0C;&#x5360;&#x7528;4&#x5B57;&#x8282;</span>
    <span class="token keyword">char</span> compressed<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//&#x88AB;&#x538B;&#x7F29;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x5360;&#x7528;N&#x5B57;&#x8282;</span>
<span class="token punctuation">}</span> quicklistLZF<span class="token punctuation">;</span>
</code></pre>
<h2 id="&#x547D;&#x4EE4;"><a name="&#x547D;&#x4EE4;" class="anchor-navigation-ex-anchor" href="#&#x547D;&#x4EE4;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x547D;&#x4EE4;</h2>
<ul>
<li><code>lpush key value1 value2</code> - &#x5C06;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;value&#x63D2;&#x5165;&#x5230;key&#x7684;&#x5934;&#x90E8;&#xFF0C;key&#x4E0D;&#x5B58;&#x5728;&#x5219;&#x521B;&#x5EFA;&#xFF0C;value2&#x5728;value1&#x4E4B;&#x524D;</li>
<li><code>lpushx key value1 value2</code> - &#x5C06;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;value&#x63D2;&#x5165;&#x5230;key&#x7684;&#x5934;&#x90E8;&#xFF0C;key&#x4E0D;&#x5B58;&#x5728;&#x5219;&#x4E0D;&#x505A;&#x4EFB;&#x4F55;&#x5904;&#x7406;&#xFF0C;value2&#x5728;value1&#x4E4B;&#x524D;</li>
<li><code>lpop key</code> - &#x79FB;&#x9664;&#x5E76;&#x8FD4;&#x56DE;key&#x5217;&#x8868;&#x7684;&#x5934;&#x90E8;&#x503C;</li>
<li><code>rpush key value1 value2</code> - &#x5C06;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;value&#x63D2;&#x5165;&#x5230;key&#x7684;&#x5C3E;&#x90E8;&#xFF0C;key&#x4E0D;&#x5B58;&#x5728;&#x5219;&#x521B;&#x5EFA;&#xFF0C;value2&#x5728;value1&#x4E4B;&#x540E;</li>
<li><code>rpushx key value1 value2</code> - &#x5C06;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;value&#x63D2;&#x5165;&#x5230;key&#x7684;&#x5C3E;&#x90E8;&#xFF0C;key&#x4E0D;&#x5B58;&#x5728;&#x5219;&#x4E0D;&#x505A;&#x4EFB;&#x4F55;&#x5904;&#x7406;&#xFF0C;value2&#x5728;value1&#x4E4B;&#x540E;</li>
<li><code>rpop key</code> - &#x79FB;&#x9664;&#x5E76;&#x8FD4;&#x56DE;key&#x5217;&#x8868;&#x7684;&#x5C3E;&#x90E8;&#x503C;</li>
<li><code>llen key</code> - &#x8FD4;&#x56DE;key&#x5217;&#x8868;&#x7684;&#x957F;&#x5EA6;</li>
<li><code>lindex key index</code> - &#x8FD4;&#x56DE;&#x5217;&#x8868;key&#x4E2D;&#x4E0B;&#x6807;&#x4E3A;index&#x7684;&#x5143;&#x7D20;&#xFF0C;index&#x4E3A;&#x6B63;&#x6570;&#xFF08;&#x4ECE;0&#x5F00;&#x59CB;&#xFF09;&#x8868;&#x793A;&#x4ECE;&#x5934;&#x7B97;&#xFF0C;index&#x4E3A;&#x8D1F;&#x6570;&#xFF08;-1&#x5F00;&#x59CB;&#xFF09;&#x8868;&#x793A;&#x4ECE;&#x5C3E;&#x7B97;</li>
<li><code>lrange key start stop</code> - &#x8FD4;&#x56DE;&#x5217;&#x8868;key&#x4E2D;&#x4E0B;&#x6807;[start, stop]&#x4E4B;&#x95F4;&#x7684;&#x5143;&#x7D20;&#xFF0C;&#x5305;&#x62EC;start&#x548C;stop</li>
<li><code>lset key index value</code> - &#x5C06;key&#x5217;&#x8868;&#x4E2D;&#x4E0B;&#x6807;&#x4E3A;index&#x7684;&#x503C;&#x6539;&#x4E3A;value&#xFF0C;key&#x4E0D;&#x5B58;&#x5728;&#x6216;index&#x8D8A;&#x754C;&#x4F1A;&#x62A5;&#x9519;</li>
<li><code>ltrim key start end</code> - &#x622A;&#x53D6;[start, end]&#x7684;&#x503C;&#x5E76;&#x5C06;&#x5176;&#x66F4;&#x65B0;&#x4E3A;key&#x7684;&#x503C;</li>
</ul>
<h1 id="hash-&#x54C8;&#x5E0C;&#x5BF9;&#x8C61;"><a name="hash-&#x54C8;&#x5E0C;&#x5BF9;&#x8C61;" class="anchor-navigation-ex-anchor" href="#hash-&#x54C8;&#x5E0C;&#x5BF9;&#x8C61;"><i class="fa fa-link" aria-hidden="true"></i></a>hash &#x54C8;&#x5E0C;&#x5BF9;&#x8C61;</h1>
<h2 id="&#x54C8;&#x5E0C;&#x7B80;&#x4ECB;"><a name="&#x54C8;&#x5E0C;&#x7B80;&#x4ECB;" class="anchor-navigation-ex-anchor" href="#&#x54C8;&#x5E0C;&#x7B80;&#x4ECB;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x54C8;&#x5E0C;&#x7B80;&#x4ECB;</h2>
<ul>
<li>hash&#x5BF9;&#x8C61;&#x672C;&#x8EAB;&#x662F;&#x4E00;&#x4E2A;key-value&#x5B58;&#x50A8;&#x7ED3;&#x6784;</li>
<li>hash&#x5E95;&#x5C42;&#x5B58;&#x50A8;&#x7ED3;&#x6784;&#x662F;ziplist&#xFF08;&#x538B;&#x7F29;&#x5217;&#x8868;&#xFF09;&#x548C;hashtable&#xFF08;&#x54C8;&#x5E0C;&#x8868;&#xFF09;</li>
<li>hash&#x5BF9;&#x8C61;&#x4E2D;&#x7684;ziplist&#x7ED3;&#x6784;&#x4E2D;&#x7684;entry&#x662F;key&#xFF0C;value&#x7D27;&#x6328;&#x5728;&#x4E00;&#x8D77;&#x7684;</li>
</ul>
<table>
<thead>
<tr>
<th>&#x7F16;&#x7801;&#x5C5E;&#x6027;</th>
<th>&#x63CF;&#x8FF0;</th>
<th>object encoding&#x547D;&#x4EE4;&#x8FD4;&#x56DE;&#x503C;</th>
</tr>
</thead>
<tbody>
<tr>
<td>OBJ_ENCODING_ZIPLIST</td>
<td>&#x4F7F;&#x7528;&#x538B;&#x7F29;&#x5217;&#x8868;&#x5B9E;&#x73B0;&#x54C8;&#x5E0C;&#x5BF9;&#x8C61;</td>
<td>ziplist</td>
</tr>
<tr>
<td>OBJ_ENCODING_HT</td>
<td>&#x4F7F;&#x7528;&#x5B57;&#x5178;&#x5B9E;&#x73B0;&#x54C8;&#x5E0C;&#x5BF9;&#x8C61;</td>
<td>hashtable</td>
</tr>
</tbody>
</table>
<p>&#x54C8;&#x5E0C;&#x5BF9;&#x8C61;&#x6EE1;&#x8DB3;&#x4EE5;&#x4E0B;&#x6761;&#x4EF6;&#x4F1A;&#x4F7F;&#x7528;ziplist</p>
<ul>
<li>&#x54C8;&#x5E0C;&#x5BF9;&#x8C61;&#x4E2D;&#x6240;&#x6709;&#x952E;&#x5BF9;&#x603B;&#x957F;&#x5EA6;&#x5C0F;&#x4E8E;64&#xFF08;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;hash-max-ziplist-value&#x4FEE;&#x6539;&#xFF09;&#x4E2A;&#x5B57;&#x8282;</li>
<li>&#x54C8;&#x5E0C;&#x5BF9;&#x8C61;&#x4E2D;&#x952E;&#x503C;&#x5BF9;&#x6570;&#x91CF;&#x5C0F;&#x4E8E;512&#xFF08;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;hash-max-ziplist-entries&#x4FEE;&#x6539;&#xFF09;</li>
</ul>
<h2 id="&#x54C8;&#x5E0C;&#x7ED3;&#x6784;"><a name="&#x54C8;&#x5E0C;&#x7ED3;&#x6784;" class="anchor-navigation-ex-anchor" href="#&#x54C8;&#x5E0C;&#x7ED3;&#x6784;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x54C8;&#x5E0C;&#x7ED3;&#x6784;</h2>
<p><img src="redisImg/hash&#x7ED3;&#x6784;.jpg" alt="hash&#x7ED3;&#x6784;"></p>
<p>&#x6CE8;&#x610F;&#xFF1A;hash&#x5BF9;&#x8C61;&#x7684;key-value&#x662F;&#x4ECE;dictEntry&#x5BF9;&#x8C61;&#x8FDB;&#x884C;&#x5305;&#x88C5;&#x7684;&#x3002;hash&#x8868;&#x5C31;&#x662F;dictEntry&#x5BF9;&#x8C61;&#x8FDB;&#x884C;&#x518D;&#x4E00;&#x6B21;&#x5305;&#x88C5;&#x5F97;&#x5230;&#x7684;&#x3002;</p>
<p>&#x5B57;&#x5178;&#x662F;redis&#x6570;&#x636E;&#x7ED3;&#x6784;redisObject&#x5728;hash&#x7C7B;&#x578B;&#x4E2D;value&#x6307;&#x5411;&#x7684;&#x7ED3;&#x6784;&#xFF0C;&#x5B9A;&#x4E49;&#x5982;&#x4E0B;</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">dict</span> <span class="token punctuation">{</span>
    dictType <span class="token operator">*</span>type<span class="token punctuation">;</span> <span class="token comment">//&#x5B57;&#x5178;&#x7C7B;&#x578B;&#x7684;&#x4E00;&#x4E9B;&#x7279;&#x5B9A;&#x51FD;&#x6570;</span>
    <span class="token keyword">void</span> <span class="token operator">*</span>privdata<span class="token punctuation">;</span> <span class="token comment">//&#x79C1;&#x6709;&#x6570;&#x636E;&#xFF0C;type&#x4E2D;&#x7684;&#x7279;&#x5B9A;&#x51FD;&#x6570;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x7528;&#x5230;</span>
    dictht ht<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//&#x54C8;&#x5E0C;&#x8868;(&#x6CE8;&#x610F;&#x8FD9;&#x91CC;&#x6709;2&#x4E2A;&#x54C8;&#x5E0C;&#x8868;)</span>
    <span class="token keyword">long</span> rehashidx<span class="token punctuation">;</span> <span class="token comment">//rehash&#x7D22;&#x5F15;&#xFF0C;&#x4E0D;&#x5728;rehash&#x65F6;&#xFF0C;&#x503C;&#x4E3A;-1</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> iterators<span class="token punctuation">;</span> <span class="token comment">//&#x6B63;&#x5728;&#x4F7F;&#x7528;&#x7684;&#x8FED;&#x4EE3;&#x5668;&#x6570;&#x91CF;</span>
<span class="token punctuation">}</span> dict<span class="token punctuation">;</span>
</code></pre>
<p>hash&#x8868;&#x5C31;&#x662F;dictEntry&#x7684;&#x4E00;&#x4E2A;&#x5C01;&#x88C5;&#xFF0C;&#x6210;&#x4E3A;dictht&#xFF0C;dict&#x4E2D;&#x4F1A;&#x6307;&#x5411;dictht&#x3002;</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">dictht</span> <span class="token punctuation">{</span>
    dictEntry <span class="token operator">*</span><span class="token operator">*</span>table<span class="token punctuation">;</span> <span class="token comment">//&#x54C8;&#x5E0C;&#x8868;&#x6570;&#x7EC4;&#xFF0C;&#x6BCF;&#x4E2A;&#x5143;&#x7D20;&#x90FD;&#x662F;dictEntry</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> size<span class="token punctuation">;</span> <span class="token comment">//&#x54C8;&#x5E0C;&#x8868;&#x5927;&#x5C0F;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> sizemask<span class="token punctuation">;</span> <span class="token comment">//&#x63A9;&#x7801;&#x5927;&#x5C0F;&#xFF0C;&#x7528;&#x4E8E;&#x8BA1;&#x7B97;&#x7D22;&#x5F15;&#x503C;&#xFF0C;&#x603B;&#x662F;&#x7B49;&#x4E8E;size-1</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> used<span class="token punctuation">;</span> <span class="token comment">//&#x54C8;&#x5E0C;&#x8868;&#x4E2D;&#x7684;&#x5DF2;&#x6709;&#x8282;&#x70B9;&#x6570;</span>
<span class="token punctuation">}</span> dictht<span class="token punctuation">;</span>
</code></pre>
<h2 id="rehash-&#x64CD;&#x4F5C;"><a name="rehash-&#x64CD;&#x4F5C;" class="anchor-navigation-ex-anchor" href="#rehash-&#x64CD;&#x4F5C;"><i class="fa fa-link" aria-hidden="true"></i></a>rehash &#x64CD;&#x4F5C;</h2>
<p>dict&#x4E2D;&#x4F1A;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;ht[2]&#xFF0C;&#x5176;&#x5143;&#x7D20;&#x4E3A;dictht&#x5BF9;&#x8C61;&#xFF0C;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x53EA;&#x4F1A;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#xFF0C;&#x4E0D;&#x4F1A;&#x4E3A;&#x53E6;&#x4E00;&#x4E2A;&#x5206;&#x914D;&#x521D;&#x59CB;&#x7A7A;&#x95F4;&#x3002;&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x54C8;&#x5E0C;&#x5BF9;&#x8C61;&#x65F6;&#x4F1A;&#x8BA1;&#x7B97;&#x54C8;&#x5E0C;&#x503C;&#x786E;&#x5B9A;&#x843D;&#x5728;&#x54EA;&#x4E2A;&#x4E0B;&#x6807;&#x4E0A;&#xFF0C;&#x5982;&#x679C;&#x53D1;&#x751F;hash&#x78B0;&#x649E;&#xFF0C;&#x540C;&#x4E00;&#x4E2A;&#x4E0B;&#x6807;&#x5C31;&#x4F1A;&#x6709;&#x591A;&#x4E2A;dictEntry&#xFF0C;&#x6BCF;&#x6B21;&#x53D1;&#x751F;&#x51B2;&#x7A81;&#x65F6;&#xFF0C;&#x63D2;&#x5165;&#x7684;&#x503C;&#x603B;&#x5728;&#x6700;&#x524D;&#x9762;&#x3002;</p>
<p>&#x8FDB;&#x884C;rehash&#x6761;&#x4EF6;</p>
<ul>
<li>&#x8D1F;&#x8F7D;&#x56E0;&#x5B50;&#x5927;&#x4E8E;&#x7B49;&#x4E8E; 1 &#x4E14; dict_can_resize &#x4E3A; 1 &#x65F6;&#x3002;</li>
<li>&#x8D1F;&#x8F7D;&#x56E0;&#x5B50;&#x5927;&#x4E8E;&#x7B49;&#x4E8E;&#x5B89;&#x5168;&#x9608;&#x503C;&#xFF08;dict_force_resize_ratio=5&#xFF09;&#x65F6;&#x3002;</li>
</ul>
<blockquote>
<p>&#x8D1F;&#x8F7D;&#x56E0;&#x5B50; = &#x54C8;&#x5E0C;&#x8868;&#x5DF2;&#x4F7F;&#x7528;&#x8282;&#x70B9;&#x6570; / &#x54C8;&#x5E0C;&#x8868;&#x5927;&#x5C0F;&#xFF08;&#x5373;&#xFF1A;h[0].used/h[0].size&#xFF09;</p>
</blockquote>
<h2 id="rehash-&#x6B65;&#x9AA4;"><a name="rehash-&#x6B65;&#x9AA4;" class="anchor-navigation-ex-anchor" href="#rehash-&#x6B65;&#x9AA4;"><i class="fa fa-link" aria-hidden="true"></i></a>rehash &#x6B65;&#x9AA4;</h2>
<p>rehash&#x7684;&#x76EE;&#x7684;&#x4E3B;&#x8981;&#x662F;&#x91CD;&#x65B0;&#x5206;&#x914D;hash&#x6570;&#x7EC4;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x4FDD;&#x5B58;&#x7684;&#x7684;hash&#x5BF9;&#x91CD;&#x65B0;&#x5206;&#x914D;&#x5230;&#x6570;&#x7EC4;&#x7684;&#x4E0D;&#x540C;&#x4E0B;&#x6807;&#x4E0A;&#x53BB;</p>
<ol>
<li>&#x7ED9;&#x5B57;&#x5178;dict&#x7684;ht[1]&#x5206;&#x914D;&#x7A7A;&#x95F4;<ul>
<li>&#x5982;&#x679C;&#x662F;&#x6269;&#x5C55;&#xFF0C;ht[1]&#x7684;&#x5927;&#x5C0F;&#x4E3A;2&#x7684;n&#x6B21;&#x65B9;&#x4E2D;&#x7B2C;&#x4E00;&#x4E2A;&#x5927;&#x4E8E;&#x7B49;&#x4E8E; <code>ht[0].used * 2</code> &#x7684;&#x503C;&#xFF0C;&#x5982;ht[0]&#x6709;&#x4E09;&#x4E2A;hash&#x5BF9;&#x8C61;&#xFF0C;used=3&#xFF0C;&#x5219; <code>ht[0].used * 2=6 &lt; 2^3</code>&#xFF0C;&#x6545;ht[1]&#x7684;&#x5927;&#x5C0F;&#x4E3A;8</li>
<li>&#x5982;&#x679C;&#x662F;&#x6536;&#x7F29;&#xFF0C;ht[1]&#x7684;&#x5927;&#x5C0F;&#x4E3A;2&#x7684;n&#x6B21;&#x65B9;&#x4E2D;&#x7B2C;&#x4E00;&#x4E2A;&#x5927;&#x4E8E;&#x7B49;&#x4E8E;ht[0].used&#x7684;&#x503C;&#x3002;&#x5982;ht[0].used=3&#xFF0C;&#x5219;&#x5206;&#x914D;&#x7A7A;&#x95F4;&#x4E3A;2^2</li>
</ul>
</li>
<li>&#x5C06;&#x5B57;&#x5178;&#x4E2D;&#x7684;&#x5C5E;&#x6027; rehashidx &#x7684;&#x503C;&#x8BBE;&#x7F6E;&#x4E3A; 0&#xFF0C;&#x8868;&#x793A;&#x6B63;&#x5728;&#x6267;&#x884C; rehash &#x64CD;&#x4F5C;</li>
<li>&#x5C06; ht[0] &#x4E2D;&#x6240;&#x6709;&#x7684;&#x952E;&#x503C;&#x5BF9;&#x4F9D;&#x6B21;&#x91CD;&#x65B0;&#x8BA1;&#x7B97;&#x54C8;&#x5E0C;&#x503C;&#xFF0C;&#x5E76;&#x653E;&#x5230; ht[1] &#x6570;&#x7EC4;&#x5BF9;&#x5E94;&#x4F4D;&#x7F6E;&#xFF0C;&#x6BCF;&#x5B8C;&#x6210;&#x4E00;&#x4E2A;&#x952E;&#x503C;&#x5BF9;&#x7684; rehash &#x4E4B;&#x540E; rehashidx &#x7684;&#x503C;&#x9700;&#x8981;&#x81EA;&#x589E; 1&#x3002;</li>
<li>&#x5F53; ht[0] &#x4E2D;&#x6240;&#x6709;&#x7684;&#x952E;&#x503C;&#x5BF9;&#x90FD;&#x8FC1;&#x79FB;&#x5230; ht[1] &#x4E4B;&#x540E;&#xFF0C;&#x91CA;&#x653E; ht[0]&#xFF0C;&#x5E76;&#x5C06; ht[1] &#x4FEE;&#x6539;&#x4E3A; ht[0]&#xFF0C;&#x7136;&#x540E;&#x518D;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x7684; ht[1] &#x6570;&#x7EC4;&#xFF0C;&#x4E3A;&#x4E0B;&#x4E00;&#x6B21; rehash &#x505A;&#x51C6;&#x5907;&#x3002;</li>
<li>&#x5C06;&#x5B57;&#x5178;&#x4E2D;&#x7684;&#x5C5E;&#x6027; rehashidx &#x8BBE;&#x7F6E;&#x4E3A; -1&#xFF0C;&#x8868;&#x793A;&#x6B64;&#x6B21; rehash &#x64CD;&#x4F5C;&#x7ED3;&#x675F;&#xFF0C;&#x7B49;&#x5F85;&#x4E0B;&#x4E00;&#x6B21; rehash&#x3002;</li>
</ol>
<p>redis&#x7684;rehash&#x4E0D;&#x662F;&#x4E00;&#x6B21;&#x5168;&#x90E8;&#x6027;&#x6267;&#x884C;&#x5B8C;&#xFF0C;&#x800C;&#x662F;&#x6E10;&#x8FDB;&#x5F0F;&#x6267;&#x884C;&#xFF0C;&#x5982;&#x679C;&#x65B0;&#x7684;&#x503C;&#x8FDB;&#x6765;&#xFF0C;&#x5219;&#x7EDF;&#x4E00;&#x653E;&#x5230;ht[1]&#x4E2D;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x67E5;&#x8BE2;&#xFF0C;&#x5148;&#x67E5;&#x8BE2;ht[0]&#xFF0C;&#x4E0D;&#x5B58;&#x5728;&#x518D;&#x67E5;&#x8BE2;ht[1]</p>
<h2 id="&#x54C8;&#x5E0C;&#x547D;&#x4EE4;"><a name="&#x54C8;&#x5E0C;&#x547D;&#x4EE4;" class="anchor-navigation-ex-anchor" href="#&#x54C8;&#x5E0C;&#x547D;&#x4EE4;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x54C8;&#x5E0C;&#x547D;&#x4EE4;</h2>
<ul>
<li><code>hset key field value</code> - &#x8BBE;&#x7F6E;&#x5355;&#x4E2A;field&#xFF08;&#x54C8;&#x5E0C;&#x5BF9;&#x8C61;&#x7684;key&#x503C;&#xFF09;</li>
<li><code>hmset key field1 value1 field2 value2</code> - &#x8BBE;&#x7F6E;&#x591A;&#x4E2A;field&#xFF08;&#x54C8;&#x5E0C;&#x5BF9;&#x8C61;&#x7684;key&#x503C;&#xFF09;</li>
<li><code>hsetnx key field value</code> - &#x5C06;key&#x4E2D;field&#x5BF9;&#x5E94;&#x7684;&#x503C;&#x8BBE;&#x7F6E;&#x4E3A;value&#xFF0C;&#x5982;&#x679C;&#x5B58;&#x5728;field&#x5219;&#x4E0D;&#x6267;&#x884C;&#x4EFB;&#x4F55;&#x64CD;&#x4F5C;</li>
<li><code>hget key field</code> - &#x83B7;&#x53D6;&#x54C8;&#x5E0C;&#x8868;key&#x4E2D;filed&#x5BF9;&#x5E94;&#x7684;value</li>
<li><code>hmget key field1 field2</code> - &#x83B7;&#x53D6;&#x54C8;&#x5E0C;&#x8868;key&#x4E2D;&#x591A;&#x4E2A;field&#x5BF9;&#x5E94;&#x7684;value</li>
<li><code>hdel key field1 field2</code> - &#x5220;&#x9664;&#x54C8;&#x5E0C;&#x8868;key&#x4E2D;&#x7684;&#x591A;&#x4E2A;field</li>
<li><code>hlen key</code> - &#x83B7;&#x53D6;&#x54C8;&#x5E0C;&#x8868;key&#x4E2D;&#x7684;&#x6570;&#x91CF;</li>
<li><code>hincrby key field increment</code> - &#x7ED9;&#x54C8;&#x5E0C;&#x8868;key&#x4E2D;field&#x5BF9;&#x5E94;&#x7684;&#x503C;&#x52A0;&#x4E0A;increment&#xFF0C;increment&#x53EF;&#x4EE5;&#x4E3A;&#x8D1F;&#x6570;&#xFF0C;&#x4E0D;&#x662F;&#x6570;&#x5B57;&#x4F1A;&#x62A5;&#x9519;</li>
<li><code>hincrbyfloat key field increment</code> - &#x4E3A;&#x54C8;&#x5E0C;&#x8868;key&#x4E2D;&#x7684;field&#x7684;&#x503C;&#x52A0;&#x4E0A;increment&#xFF0C;increment&#x53EF;&#x4EE5;&#x4E3A;&#x8D1F;&#x6570;&#xFF0C;&#x4E0D;&#x662F;float&#x7C7B;&#x578B;&#x5219;&#x4F1A;&#x62A5;&#x9519;&#x3002;</li>
<li><code>hkeys key</code> - &#x83B7;&#x53D6;&#x54C8;&#x5E0C;&#x8868;key&#x4E2D;&#x7684;&#x6240;&#x6709;field</li>
<li><code>hvals key</code> - &#x83B7;&#x53D6;&#x54C8;&#x5E0C;&#x8868;key&#x4E2D;&#x7684;&#x6240;&#x6709;value</li>
</ul>
<h1 id="sets-&#x96C6;&#x5408;"><a name="sets-&#x96C6;&#x5408;" class="anchor-navigation-ex-anchor" href="#sets-&#x96C6;&#x5408;"><i class="fa fa-link" aria-hidden="true"></i></a>sets &#x96C6;&#x5408;</h1>
<h2 id="&#x96C6;&#x5408;&#x7B80;&#x4ECB;"><a name="&#x96C6;&#x5408;&#x7B80;&#x4ECB;" class="anchor-navigation-ex-anchor" href="#&#x96C6;&#x5408;&#x7B80;&#x4ECB;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x96C6;&#x5408;&#x7B80;&#x4ECB;</h2>
<ul>
<li>&#x96C6;&#x5408;&#x5BF9;&#x8C61;&#x662F;&#x4E00;&#x4E2A;&#x5305;&#x542B;&#x5B57;&#x7B26;&#x4E32;&#x7C7B;&#x578B;&#x5143;&#x7D20;&#x7684;&#x65E0;&#x5E8F;&#x96C6;&#x5408;</li>
<li>&#x96C6;&#x5408;&#x4E2D;&#x5143;&#x7D20;&#x552F;&#x4E00;&#x4E0D;&#x53EF;&#x91CD;&#x590D;</li>
<li>&#x96C6;&#x5408;&#x5E95;&#x5C42;&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x662F;intset &#x548C; hashtable</li>
</ul>
<table>
<thead>
<tr>
<th>&#x7F16;&#x7801;&#x5C5E;&#x6027;</th>
<th>&#x63CF;&#x8FF0;</th>
<th>object encoding &#x547D;&#x4EE4;&#x8FD4;&#x56DE;&#x503C;</th>
</tr>
</thead>
<tbody>
<tr>
<td>OBJ_ENCODING_INTSET</td>
<td>&#x4F7F;&#x7528;&#x6574;&#x6570;&#x96C6;&#x5408;&#x5B9E;&#x73B0;&#x7684;&#x96C6;&#x5408;&#x5BF9;&#x8C61;</td>
<td>intset</td>
</tr>
<tr>
<td>OBJ_ENCODING_HT</td>
<td>&#x4F7F;&#x7528;&#x5B57;&#x5178;&#x5B9E;&#x73B0;&#x7684;&#x96C6;&#x5408;&#x5BF9;&#x8C61;</td>
<td>hashtable</td>
</tr>
</tbody>
</table>
<p>&#x5F53;&#x540C;&#x65F6;&#x6EE1;&#x8DB3;&#x4EE5;&#x4E0B;&#x4E24;&#x4E2A;&#x6761;&#x4EF6;&#x65F6;&#xFF0C;&#x4F1A;&#x4F7F;&#x7528;intset</p>
<ul>
<li>&#x96C6;&#x5408;&#x5BF9;&#x8C61;&#x4FDD;&#x5B58;&#x7684;&#x6240;&#x6709;&#x5143;&#x7D20;&#x90FD;&#x662F;&#x6574;&#x6570;&#x503C;</li>
<li>&#x96C6;&#x5408;&#x5BF9;&#x8C61;&#x4FDD;&#x5B58;&#x7684;&#x5143;&#x7D20;&#x6570;&#x91CF;&#x5C0F;&#x4E8E;512&#xFF08;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;set-max-intset-entries&#x63A7;&#x5236;&#xFF09;</li>
</ul>
<h2 id="intset&#x6574;&#x6570;&#x96C6;&#x5408;&#x7ED3;&#x6784;"><a name="intset&#x6574;&#x6570;&#x96C6;&#x5408;&#x7ED3;&#x6784;" class="anchor-navigation-ex-anchor" href="#intset&#x6574;&#x6570;&#x96C6;&#x5408;&#x7ED3;&#x6784;"><i class="fa fa-link" aria-hidden="true"></i></a>intset&#x6574;&#x6570;&#x96C6;&#x5408;&#x7ED3;&#x6784;</h2>
<p>intset&#x53EF;&#x4EE5;&#x4FDD;&#x5B58;&#x7C7B;&#x578B;&#x4E3A;int16_t&#x3001;int32_t&#x3001;int64_t&#x7684;&#x6574;&#x6570;</p>
<p>intset&#x5B9A;&#x4E49;&#xFF1A;</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">intset</span> <span class="token punctuation">{</span>
    <span class="token class-name">uint32_t</span> encoding<span class="token punctuation">;</span> <span class="token comment">//&#x7F16;&#x7801;&#x65B9;&#x5F0F;</span>
    <span class="token class-name">uint32_t</span> length<span class="token punctuation">;</span> <span class="token comment">//&#x5F53;&#x524D;&#x96C6;&#x5408;&#x4E2D;&#x7684;&#x5143;&#x7D20;&#x6570;&#x91CF;</span>
    <span class="token class-name">int8_t</span> contents<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//&#x96C6;&#x5408;&#x4E2D;&#x5177;&#x4F53;&#x7684;&#x5143;&#x7D20;</span>
<span class="token punctuation">}</span> intset<span class="token punctuation">;</span>
</code></pre>
<p>encoding:</p>
<ul>
<li>INTSET_ENC_INT16&#xFF1A;&#x6B64;&#x65F6; contents[] &#x5185;&#x7684;&#x6BCF;&#x4E2A;&#x5143;&#x7D20;&#x90FD;&#x662F;&#x4E00;&#x4E2A; int16_t &#x7C7B;&#x578B;&#x7684;&#x6574;&#x6570;&#x503C;&#xFF0C;&#x8303;&#x56F4;&#x4E3A;-2^15~2^15-1</li>
<li>INTSET_ENC_INT32&#xFF1A;&#x6B64;&#x65F6; contents[] &#x5185;&#x7684;&#x6BCF;&#x4E2A;&#x5143;&#x7D20;&#x90FD;&#x662F;&#x4E00;&#x4E2A; int32_t &#x7C7B;&#x578B;&#x7684;&#x6574;&#x6570;&#x503C;&#xFF0C;&#x8303;&#x56F4;&#x4E3A;-2^31~2^31-1</li>
<li>INTSET_ENC_INT64&#xFF1A;&#x6B64;&#x65F6; contents[] &#x5185;&#x7684;&#x6BCF;&#x4E2A;&#x5143;&#x7D20;&#x90FD;&#x662F;&#x4E00;&#x4E2A; int64_t &#x7C7B;&#x578B;&#x7684;&#x6574;&#x6570;&#x503C;&#xFF0C;&#x8303;&#x56F4;&#x4E3A;-2^63~2^63-1</li>
</ul>
<p>content[]: &#x7ED3;&#x6784;&#x4E0A;&#x5B9A;&#x4E49;&#x4E3A;int8_t&#xFF0C;&#x5B9E;&#x9645;&#x7531;encoding&#x51B3;&#x5B9A;</p>
<p>&#x7C7B;&#x578B;&#x7684;&#x5347;&#x7EA7;&#xFF1A;</p>
<p>&#x5F53;&#x4E00;&#x4E2A;32&#x4F4D;&#x7684;&#x6574;&#x6570;&#x63D2;&#x5165;&#x5230;int16_t&#x7C7B;&#x578B;&#x4E2D;&#x65F6;&#xFF0C;&#x4F1A;&#x8FDB;&#x884C;&#x7C7B;&#x578B;&#x7684;&#x5347;&#x7EA7;&#xFF1A;</p>
<ol>
<li>&#x6839;&#x636E;&#x65B0;&#x6DFB;&#x52A0;&#x5143;&#x7D20;&#x7684;&#x7C7B;&#x578B;&#x6765;&#x6269;&#x5C55;&#x5E95;&#x5C42;&#x6570;&#x7EC4;&#x7A7A;&#x95F4;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x6309;&#x7167;&#x5347;&#x7EA7;&#x540E;&#x73B0;&#x6709;&#x5143;&#x7D20;&#x7684;&#x4F4D;&#x6570;&#x6765;&#x5206;&#x914D;&#x65B0;&#x7684;&#x7A7A;&#x95F4;&#x3002;</li>
<li>&#x5C06;&#x73B0;&#x6709;&#x7684;&#x5143;&#x7D20;&#x8FDB;&#x884C;&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#xFF0C;&#x5E76;&#x5C06;&#x8F6C;&#x6362;&#x7C7B;&#x578B;&#x540E;&#x7684;&#x5143;&#x7D20;&#x4ECE;&#x540E;&#x5230;&#x524D;&#x9010;&#x4E2A;&#x91CD;&#x65B0;&#x653E;&#x56DE;&#x5230;&#x6570;&#x7EC4;&#x5185;&#x3002;</li>
<li>&#x5C06;&#x65B0;&#x5143;&#x7D20;&#x653E;&#x5230;&#x6570;&#x7EC4;&#x7684;&#x5934;&#x90E8;&#x6216;&#x8005;&#x5C3E;&#x90E8;&#xFF08;&#x56E0;&#x4E3A;&#x89E6;&#x53D1;&#x5347;&#x7EA7;&#x7684;&#x6761;&#x4EF6;&#x5C31;&#x662F;&#x5F53;&#x524D;&#x6570;&#x7EC4;&#x7684;&#x6574;&#x6570;&#x7C7B;&#x578B;&#x65E0;&#x6CD5;&#x5B58;&#x50A8;&#x65B0;&#x5143;&#x7D20;&#xFF0C;&#x6240;&#x4EE5;&#x65B0;&#x5143;&#x7D20;&#x8981;&#x4E48;&#x6BD4;&#x73B0;&#x6709;&#x5143;&#x7D20;&#x90FD;&#x5927;&#xFF0C;&#x8981;&#x4E48;&#x5C31;&#x6BD4;&#x73B0;&#x6709;&#x5143;&#x7D20;&#x90FD;&#x5C0F;&#xFF09;&#x3002;</li>
<li>&#x5C06; encoding &#x5C5E;&#x6027;&#x4FEE;&#x6539;&#x4E3A;&#x6700;&#x65B0;&#x7684;&#x7F16;&#x7801;&#xFF0C;&#x5E76;&#x4E14;&#x540C;&#x6B65;&#x4FEE;&#x6539; length &#x5C5E;&#x6027;&#x3002;</li>
</ol>
<p>&#x6CE8;&#x610F;&#xFF1A;&#x7C7B;&#x578B;&#x5347;&#x7EA7;&#x540E;&#x65E0;&#x6CD5;&#x8FDB;&#x884C;&#x964D;&#x7EA7;</p>
<h2 id="&#x96C6;&#x5408;&#x547D;&#x4EE4;"><a name="&#x96C6;&#x5408;&#x547D;&#x4EE4;" class="anchor-navigation-ex-anchor" href="#&#x96C6;&#x5408;&#x547D;&#x4EE4;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x96C6;&#x5408;&#x547D;&#x4EE4;</h2>
<ul>
<li><code>sadd key member1 member2</code> - &#x5C06;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5143;&#x7D20;&#x52A0;&#x5165;&#x5230;&#x96C6;&#x5408;key&#x4E2D;&#xFF0C;&#x8FD4;&#x56DE;&#x6210;&#x529F;&#x52A0;&#x5165;&#x7684;&#x6761;&#x76EE;&#xFF0C;&#x5DF2;&#x5B58;&#x5728;&#x7684;&#x5143;&#x7D20;&#x4F1A;&#x88AB;&#x5FFD;&#x7565;</li>
<li><code>sismember key member</code> - &#x5224;&#x65AD;member&#x662F;&#x5426;&#x5728;key&#x4E2D;</li>
<li><code>srem key member1 member2</code> - &#x79FB;&#x9664;key&#x4E2D;&#x6307;&#x5B9A;&#x7684;&#x5143;&#x7D20;&#xFF0C;&#x4E0D;&#x5B58;&#x5728;&#x4F1A;&#x88AB;&#x5FFD;&#x7565;</li>
<li><code>smove source dest member</code> - &#x5C06;&#x5143;&#x7D20;&#x4ECE;source&#x79FB;&#x52A8;&#x5230;dest&#x4E2D;&#xFF0C;&#x5143;&#x7D20;&#x4E0D;&#x5B58;&#x5728;&#x4F1A;&#x88AB;&#x5FFD;&#x7565;</li>
<li><code>smembers key</code> - &#x8FD4;&#x56DE;&#x96C6;&#x5408;&#x4E2D;&#x6240;&#x6709;&#x7684;&#x5143;&#x7D20;</li>
</ul>
<h1 id="sorted-sets-&#x6709;&#x5E8F;&#x96C6;&#x5408;"><a name="sorted-sets-&#x6709;&#x5E8F;&#x96C6;&#x5408;" class="anchor-navigation-ex-anchor" href="#sorted-sets-&#x6709;&#x5E8F;&#x96C6;&#x5408;"><i class="fa fa-link" aria-hidden="true"></i></a>Sorted sets &#x6709;&#x5E8F;&#x96C6;&#x5408;</h1>
<h2 id="&#x6709;&#x5E8F;&#x96C6;&#x5408;&#x7B80;&#x4ECB;"><a name="&#x6709;&#x5E8F;&#x96C6;&#x5408;&#x7B80;&#x4ECB;" class="anchor-navigation-ex-anchor" href="#&#x6709;&#x5E8F;&#x96C6;&#x5408;&#x7B80;&#x4ECB;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x6709;&#x5E8F;&#x96C6;&#x5408;&#x7B80;&#x4ECB;</h2>
<ul>
<li>&#x6709;&#x5E8F;&#x96C6;&#x5408;&#x4E2D;&#x6BCF;&#x4E2A;&#x5143;&#x7D20;&#x90FD;&#x4F1A;&#x5173;&#x8054;&#x4E00;&#x4E2A;double&#x7C7B;&#x578B;&#x7684;&#x5206;&#x6570;&#xFF0C;&#x7136;&#x540E;&#x6309;&#x7167;&#x5206;&#x6570;&#x4ECE;&#x5C0F;&#x5230;&#x5927;&#x6392;&#x5E8F;</li>
<li>&#x6709;&#x5E8F;&#x96C6;&#x5408;&#x5BF9;&#x8C61;&#x5E95;&#x5C42;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x6709;&#x4E24;&#x79CD;&#xFF1A;skiplist&#x548C;ziplist</li>
</ul>
<table>
<thead>
<tr>
<th>&#x7F16;&#x7801;&#x5C5E;&#x6027;</th>
<th>&#x63CF;&#x8FF0;</th>
<th>object encoding&#x547D;&#x4EE4;&#x8FD4;&#x56DE;&#x503C;</th>
</tr>
</thead>
<tbody>
<tr>
<td>OBJ_ENCODING_SKIPLIST</td>
<td>&#x4F7F;&#x7528;&#x8DF3;&#x8DC3;&#x8868;&#x5B9E;&#x73B0;&#x7684;&#x6709;&#x5E8F;&#x96C6;&#x5408;&#x5BF9;&#x8C61;</td>
<td>skiplist</td>
</tr>
<tr>
<td>OBJ_ENCODING_ZIPLIST</td>
<td>&#x4F7F;&#x7528;&#x538B;&#x7F29;&#x5217;&#x8868;&#x5B9E;&#x73B0;&#x7684;&#x6709;&#x5E8F;&#x96C6;&#x5408;&#x5BF9;&#x8C61;</td>
<td>ziplist</td>
</tr>
</tbody>
</table>
<p>&#x5F53;&#x6709;&#x5E8F;&#x96C6;&#x5408;&#x5BF9;&#x8C61;&#x540C;&#x65F6;&#x6EE1;&#x8DB3;&#x4EE5;&#x4E0B;&#x4E24;&#x4E2A;&#x6761;&#x4EF6;&#x65F6;&#xFF0C;&#x4F1A;&#x4F7F;&#x7528; ziplist &#x7F16;&#x7801;&#x8FDB;&#x884C;&#x5B58;&#x50A8;&#xFF1A;</p>
<ul>
<li>&#x6709;&#x5E8F;&#x96C6;&#x5408;&#x5BF9;&#x8C61;&#x4E2D;&#x4FDD;&#x5B58;&#x7684;&#x5143;&#x7D20;&#x4E2A;&#x6570;&#x5C0F;&#x4E8E;128&#x4E2A;&#xFF08;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;zset-max-ziplist-entries&#x63A7;&#x5236;&#xFF09;</li>
<li>&#x6709;&#x5E8F;&#x96C6;&#x5408;&#x5BF9;&#x8C61;&#x4E2D;&#x4FDD;&#x5B58;&#x7684;&#x6240;&#x6709;&#x5143;&#x7D20;&#x7684;&#x603B;&#x957F;&#x5EA6;&#x5C0F;&#x4E8E;64&#x5B57;&#x8282;&#xFF08;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;zset-max-ziplist-value&#x63A7;&#x5236;&#xFF09;</li>
</ul>
<h2 id="skiplist&#x7ED3;&#x6784;"><a name="skiplist&#x7ED3;&#x6784;" class="anchor-navigation-ex-anchor" href="#skiplist&#x7ED3;&#x6784;"><i class="fa fa-link" aria-hidden="true"></i></a>skiplist&#x7ED3;&#x6784;</h2>
<p>&#x4F7F;&#x7528;skiplist&#x7684;&#x6709;&#x5E8F;&#x96C6;&#x5408;&#x4F7F;&#x7528;&#x4E86;zset&#x7ED3;&#x6784;&#x4F5C;&#x4E3A;&#x6709;&#x5E8F;&#x96C6;&#x5408;&#x7684;&#x503C;&#xFF0C;zset&#x4E2D;&#x5305;&#x542B;&#x4E86;&#x4E00;&#x4E2A;&#x54C8;&#x5E0C;&#x5B57;&#x5178;&#x548C;&#x4E00;&#x4E2A;skiplist</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">zset</span> <span class="token punctuation">{</span>
    dict <span class="token operator">*</span>dict<span class="token punctuation">;</span><span class="token comment">//&#x5B57;&#x5178;&#x5BF9;&#x8C61;</span>
    zskiplist <span class="token operator">*</span>zsl<span class="token punctuation">;</span><span class="token comment">//&#x8DF3;&#x8DC3;&#x8868;&#x5BF9;&#x8C61;</span>
<span class="token punctuation">}</span> zset<span class="token punctuation">;</span>
</code></pre>
<p>&#x5176;&#x4E2D;&#xFF0C;zskiplist&#x662F;&#x4E00;&#x4E2A;&#x7531;&#x591A;&#x4E2A;zskiplistNode&#x7EC4;&#x6210;&#x7684;&#x5BF9;&#x8C61;</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">zskiplist</span> <span class="token punctuation">{</span>
    <span class="token keyword">struct</span> <span class="token class-name">zskiplistNode</span> <span class="token operator">*</span>header<span class="token punctuation">,</span> <span class="token operator">*</span>tail<span class="token punctuation">;</span><span class="token comment">//&#x8DF3;&#x8DC3;&#x8868;&#x7684;&#x5934;&#x8282;&#x70B9;&#x548C;&#x5C3E;&#x7ED3;&#x70B9;&#x6307;&#x9488;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> length<span class="token punctuation">;</span><span class="token comment">//&#x8DF3;&#x8DC3;&#x8868;&#x7684;&#x8282;&#x70B9;&#x6570;</span>
    <span class="token keyword">int</span> level<span class="token punctuation">;</span><span class="token comment">//&#x6240;&#x6709;&#x8282;&#x70B9;&#x4E2D;&#x6700;&#x5927;&#x7684;&#x5C42;&#x6570;</span>
<span class="token punctuation">}</span> zskiplist<span class="token punctuation">;</span>
</code></pre>
<p>&#x901A;&#x8FC7;zskiplist&#x5934;&#x5C3E;&#x8282;&#x70B9;&#x548C;&#x6700;&#x5927;&#x5C42;&#x6570;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x5F97;&#x77E5;zskiplistNode&#x7684;&#x904D;&#x5386;&#x65B9;&#x6CD5;&#xFF0C;skiplistNode&#x5B9A;&#x4E49;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">zskiplistNode</span> <span class="token punctuation">{</span>
    sds ele<span class="token punctuation">;</span><span class="token comment">//&#x5143;&#x7D20;</span>
    <span class="token keyword">double</span> score<span class="token punctuation">;</span><span class="token comment">//&#x5206;&#x503C;</span>
    <span class="token keyword">struct</span> <span class="token class-name">zskiplistNode</span> <span class="token operator">*</span>backward<span class="token punctuation">;</span><span class="token comment">//&#x540E;&#x9000;&#x6307;&#x9488;</span>
    <span class="token keyword">struct</span> <span class="token class-name">zskiplistLevel</span> <span class="token punctuation">{</span><span class="token comment">//&#x5C42;</span>
        <span class="token keyword">struct</span> <span class="token class-name">zskiplistNode</span> <span class="token operator">*</span>forward<span class="token punctuation">;</span><span class="token comment">//&#x524D;&#x8FDB;&#x6307;&#x9488;</span>
        <span class="token keyword">unsigned</span> <span class="token keyword">long</span> span<span class="token punctuation">;</span><span class="token comment">//&#x5F53;&#x524D;&#x8282;&#x70B9;&#x5230;&#x4E0B;&#x4E00;&#x4E2A;&#x8282;&#x70B9;&#x7684;&#x8DE8;&#x5EA6;&#xFF08;&#x8DE8;&#x8D8A;&#x7684;&#x8282;&#x70B9;&#x6570;&#xFF09;</span>
    <span class="token punctuation">}</span> level<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> zskiplistNode<span class="token punctuation">;</span>
</code></pre>
<ul>
<li>level &#x5C42; &#x8868;&#x793A;&#x8DF3;&#x8DC3;&#x8868;&#x7684;&#x5C42;&#xFF0C;&#x662F;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;&#xFF0C;&#x6240;&#x4EE5;&#x4E00;&#x4E2A;&#x8282;&#x70B9;&#x53EF;&#x4EE5;&#x6709;&#x591A;&#x4E2A;&#x5C42;&#xFF0C;&#x7A0B;&#x5E8F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4E0D;&#x540C;&#x7684;&#x5C42;&#x6765;&#x9009;&#x62E9;&#x6700;&#x5FEB;&#x6377;&#x7684;&#x8BBF;&#x95EE;&#x65B9;&#x5F0F;&#xFF0C;&#x6BCF;&#x6B21;&#x521B;&#x5EFA;&#x65B0;&#x7684;&#x8282;&#x70B9;&#x65F6;&#x6839;&#x636E;&#x5E42;&#x6B21;&#x5B9A;&#x5F8B;&#x968F;&#x673A;&#x751F;&#x6210;&#x4E00;&#x4E2A;1&#xFF5E;32&#x7684;&#x6570;&#x5B57;</li>
<li>forward &#x524D;&#x8FDB;&#x6307;&#x9488; &#x6BCF;&#x4E2A;&#x5C42;&#x90FD;&#x6709;&#x4E00;&#x4E2A;&#x6307;&#x5411;&#x94FE;&#x8868;&#x5C3E;&#x90E8;&#x65B9;&#x5411;&#x7684;&#x6307;&#x9488;&#xFF0C;&#x904D;&#x5386;&#x65F6;&#x9700;&#x8981;&#x4F7F;&#x7528;</li>
<li>span &#x8DE8;&#x5EA6; &#x8BB0;&#x5F55;&#x4E24;&#x4E2A;&#x8282;&#x70B9;&#x4E4B;&#x95F4;&#x7684;&#x8DDD;&#x79BB;&#xFF0C;&#x5982;&#x679C;&#x4E3A;RULL&#xFF0C;&#x8868;&#x793A;&#x8DE8;&#x5EA6;&#x4E3A;&#x96F6;</li>
<li>backward &#x540E;&#x9000;&#x6307;&#x9488; &#x540E;&#x9000;&#x6307;&#x9488;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#xFF0C;&#x4E14;&#x53EA;&#x80FD;&#x540E;&#x9000;&#x5230;&#x94FE;&#x8868;&#x5F53;&#x524D;&#x4F4D;&#x7F6E;&#x7684;&#x524D;&#x4E00;&#x4E2A;&#x8282;&#x70B9;</li>
<li>ele &#x8DF3;&#x8DC3;&#x8868;&#x4E2D;&#x7684;&#x5143;&#x7D20;&#xFF0C;&#x662F;&#x4E00;&#x4E2A;sds&#x5BF9;&#x8C61;&#xFF0C;&#x5FC5;&#x987B;&#x552F;&#x4E00;&#xFF0C;&#x4E0D;&#x80FD;&#x91CD;&#x590D;</li>
<li>score &#x5206;&#x6570;&#xFF0C;&#x8868;&#x793A;&#x5143;&#x7D20;&#x7684;&#x6743;&#x91CD;&#x8DF3;&#x8DC3;&#x8868;&#x4F1A;&#x5C06;&#x8282;&#x70B9;&#x6309;&#x7167;&#x5206;&#x503C;&#x4ECE;&#x5C0F;&#x5230;&#x5927;&#x6392;&#x5217;&#xFF0C;&#x4E0D;&#x540C;&#x8282;&#x70B9;&#x5206;&#x503C;&#x53EF;&#x4EE5;&#x91CD;&#x590D;</li>
</ul>
<p>redis&#x4E2D;skiplist&#x7684;&#x7ED3;&#x6784;</p>
<p><img src="redisImg/skiplist&#x7ED3;&#x6784;.jpg" alt="skiplist&#x7ED3;&#x6784;"></p>
<p>&#x540C;&#x65F6;&#x4F7F;&#x7528;skiplist&#x548C;&#x5B57;&#x5178;&#x7684;&#x539F;&#x56E0;&#xFF1A;</p>
<ul>
<li>&#x67E5;&#x627E;&#x5355;&#x4E2A;&#x5143;&#x7D20;&#x65F6;&#xFF0C;&#x4F7F;&#x7528;&#x5B57;&#x5178;&#x66F4;&#x5FEB;&#xFF0C;&#x4F46;&#x662F;&#x5B57;&#x5178;&#x65E0;&#x5E8F;</li>
<li>&#x67E5;&#x627E;&#x6392;&#x5217;&#x987A;&#x5E8F;&#x662F;&#xFF0C;&#x4F7F;&#x7528;skiplist&#x6709;&#x5E8F;</li>
</ul>
<h2 id="&#x6709;&#x5E8F;&#x96C6;&#x5408;&#x547D;&#x4EE4;"><a name="&#x6709;&#x5E8F;&#x96C6;&#x5408;&#x547D;&#x4EE4;" class="anchor-navigation-ex-anchor" href="#&#x6709;&#x5E8F;&#x96C6;&#x5408;&#x547D;&#x4EE4;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x6709;&#x5E8F;&#x96C6;&#x5408;&#x547D;&#x4EE4;</h2>
<ul>
<li><code>zadd key score1 member1 score2 member2</code> - &#x5C06;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5143;&#x7D20;&#xFF08;member&#xFF09;&#x53CA;&#x5176; score &#x6DFB;&#x52A0;&#x5230;&#x6709;&#x5E8F;&#x96C6;&#x5408;key&#x4E2D;&#x3002;</li>
<li><code>zscore key member</code> - &#x8FD4;&#x56DE;&#x6709;&#x5E8F;&#x96C6;&#x5408;key&#x4E2D;member&#x6210;&#x5458;&#x7684;score&#x3002;</li>
<li><code>zincrby key num member</code> - &#x5C06;&#x6709;&#x5E8F;&#x96C6;&#x5408;key&#x4E2D;&#x7684;member&#x52A0;&#x4E0A;num&#xFF0C;num&#x53EF;&#x4EE5;&#x4E3A;&#x8D1F;&#x6570;&#x3002;</li>
<li><code>zcount key min max</code> - &#x8FD4;&#x56DE;&#x6709;&#x5E8F;&#x96C6;&#x5408;key&#x4E2D;score&#x503C;&#x5728; [min,max] &#x533A;&#x95F4;&#x7684;member&#x6570;&#x91CF;&#x3002;</li>
<li><code>zrange key start stop</code> - &#x8FD4;&#x56DE;&#x6709;&#x5E8F;&#x96C6;&#x5408;key&#x4E2D;score&#x4ECE;&#x5C0F;&#x5230;&#x5927;&#x6392;&#x5217;&#x540E;&#x5728;[start,stop] &#x533A;&#x95F4;&#x7684;&#x6240;&#x6709;member&#x3002;</li>
<li><code>zrevrange key start stop</code> - &#x8FD4;&#x56DE;&#x6709;&#x5E8F;&#x96C6;&#x5408;key&#x4E2D;score&#x4ECE;&#x5927;&#x5230;&#x5C0F;&#x6392;&#x5217;&#x540E;&#x5728;[start,stop]&#x533A;&#x95F4;&#x7684;&#x6240;&#x6709; member&#x3002;</li>
<li><code>zrangebyscore key min max</code> - &#x8FD4;&#x56DE;&#x6709;&#x5E8F;&#x96C6;&#x5408;&#x4E2D;&#x6309;score&#x4ECE;&#x5C0F;&#x5230;&#x5927;&#x6392;&#x5217;&#x540E;&#x5728;[min,max]&#x533A;&#x95F4;&#x7684;&#x6240;&#x6709;&#x5143;&#x7D20;&#x3002;&#x6CE8;&#x610F;&#x8FD9;&#x91CC;&#x9ED8;&#x8BA4;&#x662F;&#x95ED;&#x533A;&#x95F4;&#xFF0C;&#x4F46;&#x662F;&#x53EF;&#x4EE5;&#x5728;max&#x548C;min&#x7684;&#x6570;&#x503C;&#x524D;&#x9762;&#x52A0;&#x4E0A;(&#x6216;&#x8005;[&#x6765;&#x63A7;&#x5236;&#x5F00;&#x95ED;&#x533A;&#x95F4;&#x3002;</li>
<li><code>zrevrangebyscore key max min</code> - &#x8FD4;&#x56DE;&#x6709;&#x5E8F;&#x96C6;&#x5408;&#x4E2D;&#x6309;score&#x4ECE;&#x5927;&#x5230;&#x5C0F;&#x6392;&#x5217;&#x540E;&#x5728;[min,max]&#x533A;&#x95F4;&#x7684;&#x6240;&#x6709;&#x5143;&#x7D20;&#x3002;&#x6CE8;&#x610F;&#x8FD9;&#x91CC;&#x9ED8;&#x8BA4;&#x662F;&#x95ED;&#x533A;&#x95F4;&#xFF0C;&#x4F46;&#x662F;&#x53EF;&#x4EE5;&#x5728;max&#x548C;min&#x7684;&#x6570;&#x503C;&#x524D;&#x9762;&#x52A0;&#x4E0A;(&#x6216;&#x8005;[&#x6765;&#x63A7;&#x5236;&#x5F00;&#x95ED;&#x533A;&#x95F4;&#x3002;</li>
<li><code>zrank key member</code> - &#x8FD4;&#x56DE;&#x6709;&#x5E8F;&#x96C6;&#x5408;&#x4E2D;member&#x4E2D;&#x5143;&#x7D20;&#x6392;&#x540D;&#xFF08;&#x4ECE;&#x5C0F;&#x5230;&#x5927;&#xFF09;&#xFF0C;&#x8FD4;&#x56DE;&#x7684;&#x7ED3;&#x679C;&#x4ECE;0&#x5F00;&#x59CB;&#x8BA1;&#x7B97;&#x3002;</li>
<li><code>zrevrank key member</code> - &#x8FD4;&#x56DE;&#x6709;&#x5E8F;&#x96C6;&#x5408;&#x4E2D;member&#x4E2D;&#x5143;&#x7D20;&#x6392;&#x540D;&#xFF08;&#x4ECE;&#x5927;&#x5230;&#x5C0F;&#xFF09;&#xFF0C;&#x8FD4;&#x56DE;&#x7684;&#x7ED3;&#x679C;&#x4ECE;0&#x5F00;&#x59CB;&#x8BA1;&#x7B97;&#x3002;</li>
<li><code>zlexcount key min max</code> - &#x8FD4;&#x56DE;&#x6709;&#x5E8F;&#x96C6;&#x5408;&#x4E2D;min&#x548C;max&#x4E4B;&#x95F4;&#x7684;member&#x6570;&#x91CF;&#x3002;&#x6CE8;&#x610F;&#x8FD9;&#x4E2A;&#x547D;&#x4EE4;&#x4E2D;&#x7684;min&#x548C;max&#x524D;&#x9762;&#x5FC5;&#x987B;&#x52A0;(&#x6216;&#x8005;[&#x6765;&#x63A7;&#x5236;&#x5F00;&#x95ED;&#x533A;&#x95F4;&#xFF0C;&#x7279;&#x6B8A;&#x503C;-&#x548C;+&#x5206;&#x522B;&#x8868;&#x793A;&#x8D1F;&#x65E0;&#x7A77;&#x548C;&#x6B63;&#x65E0;&#x7A77;&#x3002;</li>
</ul>
<h1 id="&#x53D1;&#x5E03;&#x548C;&#x8BA2;&#x9605;"><a name="&#x53D1;&#x5E03;&#x548C;&#x8BA2;&#x9605;" class="anchor-navigation-ex-anchor" href="#&#x53D1;&#x5E03;&#x548C;&#x8BA2;&#x9605;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x53D1;&#x5E03;&#x548C;&#x8BA2;&#x9605;</h1>
<p>&#x53CC;&#x7AEF;&#x5217;&#x8868;&#x5B9E;&#x73B0;&#x53D1;&#x5E03;&#x548C;&#x8BA2;&#x9605;&#x7684;&#x95EE;&#x9898;&#xFF1A;</p>
<ul>
<li>&#x5982;&#x679C;&#x751F;&#x4EA7;&#x8005;&#x751F;&#x4EA7;&#x6D88;&#x606F;&#x7684;&#x901F;&#x5EA6;&#x8FDC;&#x5927;&#x4E8E;&#x6D88;&#x8D39;&#x8005;&#x6D88;&#x8D39;&#x6D88;&#x606F;&#x7684;&#x901F;&#x5EA6;&#xFF0C;&#x90A3;&#x4E48;&#x94FE;&#x8868;&#x4E2D;&#x672A;&#x6D88;&#x8D39;&#x7684;&#x6D88;&#x606F;&#x4F1A;&#x5927;&#x91CF;&#x5806;&#x79EF;&#xFF0C;&#x5BFC;&#x81F4;&#x5360;&#x7528;&#x5927;&#x91CF;&#x7684;&#x5185;&#x5B58;&#x3002;</li>
<li>&#x57FA;&#x4E8E;&#x94FE;&#x8868;&#x5B9E;&#x73B0;&#x7684;&#x6D88;&#x606F;&#x961F;&#x5217;&#xFF0C;&#x4E0D;&#x652F;&#x6301;&#x4E00;&#x5BF9;&#x591A;&#x7684;&#x6D88;&#x606F;&#x5206;&#x53D1;&#x3002;</li>
</ul>
<p>redis&#x5B9E;&#x73B0;&#x53D1;&#x5E03;&#x548C;&#x8BA2;&#x9605;&#x65B9;&#x5F0F;&#xFF1A;&#x57FA;&#x4E8E;&#x9891;&#x9053;&#x548C;&#x57FA;&#x4E8E;&#x6A21;&#x5F0F;</p>
<p>&#x5F53;&#x540C;&#x65F6;&#x5B58;&#x5728;&#x57FA;&#x4E8E;&#x9891;&#x9053;&#x548C;&#x57FA;&#x4E8E;&#x6A21;&#x5F0F;&#x4E24;&#x79CD;&#x8BA2;&#x9605;&#xFF0C;Redis&#x4F1A;&#x9996;&#x5148;&#x5BFB;&#x627E;&#x9891;&#x9053;&#x5B57;&#x5178;&#xFF0C;&#x518D;&#x53BB;&#x904D;&#x5386;&#x6A21;&#x5F0F;&#x94FE;&#x8868;</p>
<h2 id="&#x57FA;&#x4E8E;&#x9891;&#x9053;"><a name="&#x57FA;&#x4E8E;&#x9891;&#x9053;" class="anchor-navigation-ex-anchor" href="#&#x57FA;&#x4E8E;&#x9891;&#x9053;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x57FA;&#x4E8E;&#x9891;&#x9053;</h2>
<h3 id="&#x57FA;&#x4E8E;&#x9891;&#x9053;&#x5B9E;&#x73B0;&#x539F;&#x7406;"><a name="&#x57FA;&#x4E8E;&#x9891;&#x9053;&#x5B9E;&#x73B0;&#x539F;&#x7406;" class="anchor-navigation-ex-anchor" href="#&#x57FA;&#x4E8E;&#x9891;&#x9053;&#x5B9E;&#x73B0;&#x539F;&#x7406;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x57FA;&#x4E8E;&#x9891;&#x9053;&#x5B9E;&#x73B0;&#x539F;&#x7406;</h3>
<p>&#x5BA2;&#x6237;&#x7AEF;&#x4E0E;&#x5176;&#x8BA2;&#x9605;&#x7684;&#x9891;&#x9053;&#x4FE1;&#x606F;&#x88AB;&#x4FDD;&#x5B58;&#x5728;redisServer&#x5BF9;&#x8C61;&#x4E2D;&#x7684;pubsub_channels&#x5C5E;&#x6027;&#x4E2D;</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">struct</span> <span class="token class-name">redisServer</span> <span class="token punctuation">{</span>
    dict <span class="token operator">*</span>pubsub_channels<span class="token punctuation">;</span><span class="token comment">//&#x4FDD;&#x5B58;&#x4E86;&#x5BA2;&#x6237;&#x7AEF;&#x53CA;&#x5176;&#x8BA2;&#x9605;&#x7684;&#x9891;&#x9053;&#x4FE1;&#x606F;</span>
    <span class="token comment">//... &#x7701;&#x7565;&#x5176;&#x4ED6;&#x4FE1;&#x606F;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>pubsub_channels&#x5C5E;&#x6027;&#x662F;&#x4E00;&#x4E2A;&#x5B57;&#x5178;&#xFF0C;key&#x4E3A;&#x9891;&#x9053;&#x540D;&#xFF0C;value&#x4E3A;&#x94FE;&#x8868;&#xFF0C;&#x5206;&#x522B;&#x4E3A;&#x6BCF;&#x4E2A;&#x5BA2;&#x6237;&#x7AEF;&#x7684;id</p>
<p><img src="redisImg/&#x57FA;&#x4E8E;&#x9891;&#x9053;&#x53D1;&#x5E03;&#x4E0E;&#x8BA2;&#x9605;.jpg" alt="&#x57FA;&#x4E8E;&#x9891;&#x9053;&#x53D1;&#x5E03;&#x4E0E;&#x8BA2;&#x9605;&#x7ED3;&#x6784;"></p>
<p>&#x8BA2;&#x9605;&#xFF1A;&#x8BA2;&#x9605;&#x7684;&#x65F6;&#x5019;&#x9996;&#x5148;&#x4F1A;&#x68C0;&#x67E5;&#x5B57;&#x5178;&#x662F;&#x5426;&#x5B58;&#x5728;&#x8FD9;&#x4E2A;&#x9891;&#x9053;&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x5B58;&#x5728;&#xFF0C;&#x5219;&#x9700;&#x8981;&#x5728;&#x5F53;&#x524D;&#x9891;&#x9053;&#x521B;&#x5EFA;&#x5B57;&#x5178;&#xFF0C;&#x540C;&#x65F6;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x94FE;&#x8868;&#x4F5C;&#x4E3A;value&#xFF0C;&#x5C06;&#x5F53;&#x524D;&#x5BA2;&#x6237;&#x7AEF;id&#x653E;&#x5165;&#x94FE;&#x8868;&#x3002;&#x5982;&#x679C;&#x5B58;&#x5728;&#xFF0C;&#x76F4;&#x63A5;&#x5C06;&#x5F53;&#x524D;&#x5BA2;&#x6237;&#x7AEF;id&#x653E;&#x5165;&#x94FE;&#x8868;&#x672B;&#x5C3E;</p>
<p>&#x53D6;&#x6D88;&#x8BA2;&#x9605;&#xFF1A;&#x53D6;&#x6D88;&#x8BA2;&#x9605;&#x7684;&#x65F6;&#x5019;&#x9700;&#x8981;&#x5C06;&#x8BE5;&#x5BA2;&#x6237;&#x7AEF;id&#x4ECE;&#x5BF9;&#x5E94;&#x7684;&#x94FE;&#x8868;&#x4E2D;&#x79FB;&#x9664;&#xFF0C;&#x5982;&#x679C;&#x79FB;&#x9664;&#x4E4B;&#x540E;&#x94FE;&#x8868;&#x4E3A;&#x7A7A;&#xFF0C;&#x5219;&#x9700;&#x8981;&#x540C;&#x65F6;&#x5C06;&#x8BE5;&#x9891;&#x9053;&#x4ECE;&#x5B57;&#x5178;&#x4E2D;&#x5220;&#x9664;</p>
<p>&#x53D1;&#x9001;&#x6D88;&#x606F;&#xFF1A;&#x53D1;&#x9001;&#x6D88;&#x606F;&#x65F6;&#x9996;&#x5148;&#x4F1A;&#x53BB;pubsub_channels&#x5B57;&#x5178;&#x5185;&#x5BFB;&#x627E;&#x952E;&#xFF0C;&#x5982;&#x679C;&#x53D1;&#x73B0;&#x6709;&#x53EF;&#x4EE5;&#x5339;&#x914D;&#x7684;&#x952E;&#xFF0C;&#x5219;&#x627E;&#x5230;&#x5BF9;&#x5E94;&#x7684;&#x94FE;&#x8868;&#xFF0C;&#x8FDB;&#x884C;&#x904D;&#x5386;&#x53D1;&#x9001;&#x6D88;&#x606F;</p>
<h3 id="&#x57FA;&#x4E8E;&#x9891;&#x9053;&#x53D1;&#x5E03;&#x8BA2;&#x9605;&#x547D;&#x4EE4;"><a name="&#x57FA;&#x4E8E;&#x9891;&#x9053;&#x53D1;&#x5E03;&#x8BA2;&#x9605;&#x547D;&#x4EE4;" class="anchor-navigation-ex-anchor" href="#&#x57FA;&#x4E8E;&#x9891;&#x9053;&#x53D1;&#x5E03;&#x8BA2;&#x9605;&#x547D;&#x4EE4;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x57FA;&#x4E8E;&#x9891;&#x9053;&#x53D1;&#x5E03;&#x8BA2;&#x9605;&#x547D;&#x4EE4;</h3>
<ul>
<li><code>subscribe channel-1 channel-2</code> - &#x8BA2;&#x9605;&#x4E00;&#x4E2A;&#x6216;&#x8005;&#x591A;&#x4E2A;&#x9891;&#x9053;</li>
<li><code>unsubscribe channel-1</code> - &#x53D6;&#x6D88;&#x9891;&#x9053;&#x7684;&#x8BA2;&#x9605;</li>
<li><code>publish channel-1 message</code> - &#x5411;&#x9891;&#x9053;channel-1&#x53D1;&#x9001;&#x6D88;&#x606F;message</li>
<li><code>pubsub channels [channel_name]</code> - &#x67E5;&#x770B;&#x5F53;&#x524D;&#x670D;&#x52A1;&#x5668;&#x88AB;&#x8BA2;&#x9605;&#x7684;&#x9891;&#x9053;&#xFF0C;&#x4E0D;&#x5E26;&#x53C2;&#x6570;&#x5219;&#x8FD4;&#x56DE;&#x6240;&#x6709;&#x9891;&#x9053;&#xFF0C;&#x540E;&#x9762;&#x7684;&#x53C2;&#x6570;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x901A;&#x914D;&#x7B26;?&#x6216;*</li>
<li><code>pubsub numsub channel_name [channel_name]</code> - &#x67E5;&#x770B;&#x6307;&#x5B9A;&#x9891;&#x9053;&#x7684;&#x8BA2;&#x9605;&#x6570;&#xFF08;&#x53EF;&#x540C;&#x65F6;&#x67E5;&#x770B;&#x591A;&#x4E2A;&#xFF09;</li>
</ul>
<h2 id="&#x57FA;&#x4E8E;&#x6A21;&#x5F0F;"><a name="&#x57FA;&#x4E8E;&#x6A21;&#x5F0F;" class="anchor-navigation-ex-anchor" href="#&#x57FA;&#x4E8E;&#x6A21;&#x5F0F;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x57FA;&#x4E8E;&#x6A21;&#x5F0F;</h2>
<h3 id="&#x57FA;&#x4E8E;&#x6A21;&#x5F0F;&#x5B9E;&#x73B0;&#x539F;&#x7406;"><a name="&#x57FA;&#x4E8E;&#x6A21;&#x5F0F;&#x5B9E;&#x73B0;&#x539F;&#x7406;" class="anchor-navigation-ex-anchor" href="#&#x57FA;&#x4E8E;&#x6A21;&#x5F0F;&#x5B9E;&#x73B0;&#x539F;&#x7406;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x57FA;&#x4E8E;&#x6A21;&#x5F0F;&#x5B9E;&#x73B0;&#x539F;&#x7406;</h3>
<p>&#x5BA2;&#x6237;&#x7AEF;&#x4E0E;&#x5176;&#x8BA2;&#x9605;&#x7684;&#x6A21;&#x5F0F;&#x4FE1;&#x606F;&#x88AB;&#x4FDD;&#x5B58;&#x5728; redisServer &#x5BF9;&#x8C61;&#x4E2D;&#x7684; pubsub_patterns &#x5C5E;&#x6027;&#x4E2D;</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">struct</span> <span class="token class-name">redisServer</span> <span class="token punctuation">{</span>
    list pubsub_patterns<span class="token punctuation">;</span><span class="token comment">//&#x4FDD;&#x5B58;&#x4E86;&#x5BA2;&#x6237;&#x7AEF;&#x53CA;&#x5176;&#x8BA2;&#x9605;&#x7684;&#x6A21;&#x5F0F;&#x4FE1;&#x606F;</span>
    <span class="token comment">//...&#x7701;&#x7565;&#x5176;&#x4ED6;&#x4FE1;&#x606F;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>pubsub_patterns&#x662F;&#x4E00;&#x4E2A;&#x5217;&#x8868;&#xFF0C;&#x5185;&#x90E8;&#x4E3A;&#x7ED3;&#x6784;&#x4E3A;</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">pubsubPattern</span> <span class="token punctuation">{</span>
    client <span class="token operator">*</span>client<span class="token punctuation">;</span> <span class="token comment">//&#x8BA2;&#x9605;&#x6A21;&#x5F0F;&#x7684;&#x5BA2;&#x6237;&#x7AEF;</span>
    robj <span class="token operator">*</span>pattern<span class="token punctuation">;</span> <span class="token comment">//&#x88AB;&#x8BA2;&#x9605;&#x7684;&#x6A21;&#x5F0F;</span>
<span class="token punctuation">}</span> pubsubPattern<span class="token punctuation">;</span>
</code></pre>
<p><img src="redisImg/&#x57FA;&#x4E8E;&#x6A21;&#x5F0F;&#x53D1;&#x5E03;&#x4E0E;&#x8BA2;&#x9605;.jpg" alt="&#x57FA;&#x4E8E;&#x6A21;&#x5F0F;&#x53D1;&#x5E03;&#x4E0E;&#x8BA2;&#x9605;&#x7ED3;&#x6784;"></p>
<p>&#x8BA2;&#x9605;&#xFF1A;&#x65B0;&#x5EFA;&#x4E00;&#x4E2A;pubsubPattern&#x6570;&#x636E;&#x7ED3;&#x6784;&#x52A0;&#x5165;&#x5230;&#x94FE;&#x8868;pubsub_patterns&#x7684;&#x7ED3;&#x5C3E;&#x3002;</p>
<p>&#x53D6;&#x6D88;&#x8BA2;&#x9605;&#xFF1A;&#x4ECE;&#x94FE;&#x8868;&#x4E2D;&#x5C06;&#x5F53;&#x524D;&#x53D6;&#x6D88;&#x8BA2;&#x9605;&#x7684;&#x5BA2;&#x6237;&#x7AEF;pubsubPattern&#x4ECE;&#x94FE;&#x8868;pubsub_patterns&#x4E2D;&#x79FB;&#x9664;&#x3002;</p>
<p>&#x53D1;&#x9001;&#x6D88;&#x606F;&#xFF1A;&#x6B64;&#x65F6;&#x9700;&#x8981;&#x904D;&#x5386;&#x6574;&#x4E2A;&#x94FE;&#x8868;&#x6765;&#x5BFB;&#x627E;&#x80FD;&#x5339;&#x914D;&#x7684;&#x6A21;&#x5F0F;&#x3002;&#x4E4B;&#x6240;&#x4EE5;&#x57FA;&#x4E8E;&#x6A21;&#x5F0F;&#x573A;&#x666F;&#x4F7F;&#x7528;&#x94FE;&#x8868;&#x662F;&#x56E0;&#x4E3A;&#x6A21;&#x5F0F;&#x652F;&#x6301;&#x901A;&#x914D;&#x7B26;&#xFF0C;&#x6240;&#x4EE5;&#x6CA1;&#x6709;&#x529E;&#x6CD5;&#x76F4;&#x63A5;&#x7528;&#x5B57;&#x5178;&#x5B9E;&#x73B0;&#x3002;</p>
<h3 id="&#x57FA;&#x4E8E;&#x6A21;&#x5F0F;&#x53D1;&#x5E03;&#x8BA2;&#x9605;&#x547D;&#x4EE4;"><a name="&#x57FA;&#x4E8E;&#x6A21;&#x5F0F;&#x53D1;&#x5E03;&#x8BA2;&#x9605;&#x547D;&#x4EE4;" class="anchor-navigation-ex-anchor" href="#&#x57FA;&#x4E8E;&#x6A21;&#x5F0F;&#x53D1;&#x5E03;&#x8BA2;&#x9605;&#x547D;&#x4EE4;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x57FA;&#x4E8E;&#x6A21;&#x5F0F;&#x53D1;&#x5E03;&#x8BA2;&#x9605;&#x547D;&#x4EE4;</h3>
<ul>
<li><code>psubscribe pattern-1 pattern-2</code> - &#x8BA2;&#x9605;&#x4E00;&#x4E2A;&#x6216;&#x8005;&#x591A;&#x4E2A;&#x6A21;&#x5F0F;&#xFF0C;&#x6A21;&#x5F0F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x901A;&#x914D;&#x7B26;?&#x548C;*&#x6765;&#x8868;&#x793A;&#x3002;</li>
<li><code>pubsubscribe pattern-1 pattern-1</code> - &#x53D6;&#x6D88;&#x6A21;&#x5F0F;&#x7684;&#x8BA2;&#x9605;&#xFF08;&#x57FA;&#x4E8E;&#x547D;&#x4EE4;&#x64CD;&#x4F5C;&#xFF0C;&#x754C;&#x9762;&#x4E0A;&#x65E0;&#x6CD5;&#x9000;&#x8BA2;&#xFF09;</li>
<li><code>publish channel-1 message</code> - &#x5411;&#x9891;&#x9053;channel-1&#x53D1;&#x9001;&#x6D88;&#x606F;message&#x3002;&#x8FD9;&#x91CC;&#x548C;&#x4E0A;&#x9762;&#x57FA;&#x4E8E;&#x9891;&#x9053;&#x547D;&#x4EE4;&#x662F;&#x4E00;&#x6837;&#x7684;&#x3002;</li>
<li><code>pubsub numpat</code> - &#x67E5;&#x8BE2;&#x5F53;&#x524D;&#x670D;&#x52A1;&#x5668;&#x88AB;&#x8BA2;&#x9605;&#x6A21;&#x5F0F;&#x7684;&#x6570;&#x91CF;</li>
</ul>
<h1 id="lua&#x811A;&#x672C;"><a name="lua&#x811A;&#x672C;" class="anchor-navigation-ex-anchor" href="#lua&#x811A;&#x672C;"><i class="fa fa-link" aria-hidden="true"></i></a>Lua&#x811A;&#x672C;</h1>
<h2 id="lua&#x811A;&#x672C;&#x7B80;&#x4ECB;"><a name="lua&#x811A;&#x672C;&#x7B80;&#x4ECB;" class="anchor-navigation-ex-anchor" href="#lua&#x811A;&#x672C;&#x7B80;&#x4ECB;"><i class="fa fa-link" aria-hidden="true"></i></a>Lua&#x811A;&#x672C;&#x7B80;&#x4ECB;</h2>
<ul>
<li>Redis&#x4ECE;2.6&#x7248;&#x672C;&#x5F00;&#x59CB;&#x652F;&#x6301;Lua&#x811A;&#x672C;</li>
<li>Redis&#x670D;&#x52A1;&#x5668;&#x4E2D;&#x5D4C;&#x5165;&#x4E86;Lua&#x73AF;&#x5883;</li>
</ul>
<h2 id="&#x8C03;&#x7528;lua&#x811A;&#x672C;"><a name="&#x8C03;&#x7528;lua&#x811A;&#x672C;" class="anchor-navigation-ex-anchor" href="#&#x8C03;&#x7528;lua&#x811A;&#x672C;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x8C03;&#x7528;lua&#x811A;&#x672C;</h2>
<p><code>eval lua-script numkeys key [key ...] arg [arg ...]</code></p>
<ul>
<li>eval - &#x6267;&#x884C;lua&#x811A;&#x672C;&#x7684;&#x547D;&#x4EE4;</li>
<li>lua-script - Lua&#x811A;&#x672C;&#x5185;&#x5BB9;</li>
<li>numkeys - &#x8868;&#x793A;&#x7684;&#x662F;lua&#x811A;&#x672C;&#x4E2D;&#x9700;&#x8981;&#x7528;&#x5230;&#x591A;&#x5C11;&#x4E2A;key&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x5199;&#x5219;&#x662F;0</li>
<li>key [key ...] - &#x5C06;key&#x6309;&#x987A;&#x5E8F;&#x4F20;&#x5165;&#x5230;lua&#x811A;&#x672C;&#x4E2D;&#xFF0C;numkeys&#x4E3A;0&#x65F6;&#x53EF;&#x7701;&#x7565;</li>
<li>arg - lua&#x811A;&#x672C;&#x4E2D;&#x7528;&#x5230;&#x7684;&#x53C2;&#x6570;&#xFF0C;&#x6CA1;&#x6709;&#x5219;&#x53EF;&#x4EE5;&#x7701;&#x7565;</li>
</ul>
<p>&#x793A;&#x4F8B;&#xFF1A;<code>eval &quot;return &apos;Hello Redis&apos;&quot; 0</code></p>
<h2 id="lua&#x811A;&#x672C;&#x6267;&#x884C;redis"><a name="lua&#x811A;&#x672C;&#x6267;&#x884C;redis" class="anchor-navigation-ex-anchor" href="#lua&#x811A;&#x672C;&#x6267;&#x884C;redis"><i class="fa fa-link" aria-hidden="true"></i></a>lua&#x811A;&#x672C;&#x6267;&#x884C;redis</h2>
<p><code>redis.call(command, key [key ...] argv [argv&#x2026;])</code></p>
<ul>
<li>command - redis&#x4E2D;&#x7684;&#x547D;&#x4EE4;&#xFF0C;&#x5982;set&#xFF0C;get&#x7B49;</li>
<li>key - &#x64CD;&#x4F5C;redis&#x7684;key&#x503C;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E;&#x8C03;&#x7528;&#x65B9;&#x6CD5;&#x7684;&#x5F62;&#x53C2;</li>
<li>param - &#x4EE3;&#x8868;&#x53C2;&#x6570;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E;&#x8C03;&#x7528;&#x65B9;&#x6CD5;&#x7684;&#x5B9E;&#x53C2;</li>
</ul>
<p>&#x793A;&#x4F8B;&#xFF1A;<code>eval &quot;return redis.call(&apos;set&apos;,KEYS[1],ARGV[1])&quot; 1 name lonely_wolf</code></p>
<p>&#x7B49;&#x540C;&#x4E8E;&#xFF1A;<code>set name lonely_wolf</code></p>
<p>&#x6CE8;&#x610F;&#xFF1A;KEYS&#x548C;ARGS&#x5FC5;&#x987B;&#x5927;&#x5199;&#xFF0C;&#x53C2;&#x6570;&#x4E0B;&#x6807;&#x4ECE;1&#x5F00;&#x59CB;&#xFF0C;1&#x8868;&#x793A;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x53C2;&#x6570;</p>
<h2 id="lua&#x811A;&#x672C;&#x6458;&#x8981;"><a name="lua&#x811A;&#x672C;&#x6458;&#x8981;" class="anchor-navigation-ex-anchor" href="#lua&#x811A;&#x672C;&#x6458;&#x8981;"><i class="fa fa-link" aria-hidden="true"></i></a>lua&#x811A;&#x672C;&#x6458;&#x8981;</h2>
<p>&#x6709;&#x65F6;&#x5019;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x6267;&#x884C;&#x7684;&#x4E00;&#x4E2A; Lua &#x811A;&#x672C;&#x5F88;&#x957F;&#xFF0C;&#x90A3;&#x4E48;&#x76F4;&#x63A5;&#x8C03;&#x7528; Lua &#x811A;&#x672C;&#x4F1A;&#x975E;&#x5E38;&#x4E0D;&#x65B9;&#x4FBF;&#xFF0C;&#x6240;&#x4EE5; Redis &#x5F53;&#x4E2D;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x547D;&#x4EE4; script load &#x6765;&#x624B;&#x52A8;&#x7ED9;&#x6BCF;&#x4E2A; Lua &#x811A;&#x672C;&#x751F;&#x6210;&#x6458;&#x8981;&#xFF0C;&#x8FD9;&#x91CC;&#x4E4B;&#x6240;&#x4EE5;&#x8981;&#x8BF4;&#x624B;&#x52A8;&#x7684;&#x539F;&#x56E0;&#x662F;&#x5373;&#x4F7F;&#x6211;&#x4EEC;&#x4E0D;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x547D;&#x4EE4;&#xFF0C;&#x6BCF;&#x6B21;&#x8C03;&#x7528;&#x5B8C; Lua &#x811A;&#x672C;&#x7684;&#x65F6;&#x5019;&#xFF0C;Redis &#x4E5F;&#x4F1A;&#x4E3A;&#x6BCF;&#x4E2A; Lua &#x811A;&#x672C;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x6458;&#x8981;&#x3002;</p>
<ul>
<li><code>script load lua_src</code> - &#x4E3A;lua_src&#x5185;&#x5BB9;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x6458;&#x8981;</li>
<li><code>script exists &#x6458;&#x8981;</code> - &#x5224;&#x65AD;&#x4E00;&#x4E2A;&#x6458;&#x8981;&#x662F;&#x5426;&#x5B58;&#x5728;&#xFF0C;0&#x8868;&#x793A;&#x4E0D;&#x5B58;&#x5728;&#xFF0C;1&#x8868;&#x793A;&#x5B58;&#x5728;</li>
<li><code>evalsha &quot;&#x6458;&#x8981;id&quot; key [key ...] value [value ...]</code> - &#x901A;&#x8FC7;&#x6458;&#x8981;&#x6267;&#x884C;lua&#x811A;&#x672C;</li>
<li><code>script flush</code> - &#x6E05;&#x9664;&#x6240;&#x6709;lua&#x811A;&#x672C;&#x7F13;&#x5B58;</li>
</ul>
<p>&#x793A;&#x4F8B;&#xFF1A;</p>
<pre class="language-"><code class="lang-redis">script load &quot;return redis.call(&apos;set&apos;,KEYS[1],ARGV[1])&quot;  //&#x7ED9;&#x5F53;&#x524D; Lua&#x811A;&#x672C;&#x751F;&#x6210;&#x6458;&#x8981;&#xFF0C;&#x8FD9;&#x65F6;&#x5019;&#x4F1A;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x6458;&#x8981;
evalsha &quot;c686f316aaf1eb01d5a4de1b0b63cd233010e63d&quot; 1 address china  //&#x76F8;&#x5F53;&#x4E8E;&#x6267;&#x884C;&#x547D;&#x4EE4; set address china
get address //&#x83B7;&#x53D6; adress&#xFF0C;&#x786E;&#x8BA4;&#x4E0A;&#x9762;&#x7684;&#x811A;&#x672C;&#x662F;&#x5426;&#x6267;&#x884C;&#x6210;&#x529F;
script exists &quot;c686f316aaf1eb01d5a4de1b0b63cd233010e63d&quot;  //&#x5224;&#x65AD;&#x5F53;&#x524D;&#x6458;&#x8981;&#x7684; Lua&#x811A;&#x672C;&#x662F;&#x5426;&#x5B58;&#x5728;
script flush //&#x6E05;&#x9664;&#x6240;&#x6709; Lua&#x811A;&#x672C;&#x7F13;&#x5B58;
script exists &quot;c686f316aaf1eb01d5a4de1b0b63cd233010e63d&quot;  //&#x6E05;&#x9664;&#x4E4B;&#x540E;&#x8FD9;&#x91CC;&#x5C31;&#x4E0D;&#x5B58;&#x5728;&#x4E86;
</code></pre>
<h2 id="lua&#x811A;&#x672C;&#x6587;&#x4EF6;"><a name="lua&#x811A;&#x672C;&#x6587;&#x4EF6;" class="anchor-navigation-ex-anchor" href="#lua&#x811A;&#x672C;&#x6587;&#x4EF6;"><i class="fa fa-link" aria-hidden="true"></i></a>lua&#x811A;&#x672C;&#x6587;&#x4EF6;</h2>
<p>&#x65B0;&#x5EFA;&#x4E00;&#x4E2A;test.lua&#x811A;&#x672C;</p>
<pre class="language-"><code class="lang-lua">redis<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">&apos;set&apos;</span><span class="token punctuation">,</span>KEYS<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>ARGV<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">return</span> redis<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">&apos;get&apos;</span><span class="token punctuation">,</span>KEYS<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre>
<p>bash&#x547D;&#x4EE4;&#x884C;&#x6267;&#x884C;</p>
<pre class="language-"><code class="lang-bash"><span class="token comment"># &#x6CE8;&#x610F; key &#x548C; arg &#x53C2;&#x6570;&#x4E4B;&#x95F4;&#x8981;&#x4EE5;&#x9017;&#x53F7;&#x9694;&#x5F00;&#xFF0C;&#x4E14;&#x9017;&#x53F7;&#x4E24;&#x8FB9;&#x7684;&#x7A7A;&#x683C;&#x4E0D;&#x80FD;&#x7701;&#x7565;</span>
redis-cli <span class="token parameter variable">--eval</span> /home/project/test.lua <span class="token number">1</span> age , <span class="token number">18</span>
</code></pre>
<h2 id="lua&#x811A;&#x672C;&#x5F02;&#x5E38;"><a name="lua&#x811A;&#x672C;&#x5F02;&#x5E38;" class="anchor-navigation-ex-anchor" href="#lua&#x811A;&#x672C;&#x5F02;&#x5E38;"><i class="fa fa-link" aria-hidden="true"></i></a>lua&#x811A;&#x672C;&#x5F02;&#x5E38;</h2>
<ul>
<li>redis&#x9ED8;&#x8BA4;&#x811A;&#x672C;&#x8D85;&#x65F6;&#x65F6;&#x95F4;lua-time-limit &#x4E3A;5000&#x6BEB;&#x79D2;</li>
<li><code>script kill</code> - &#x811A;&#x672C;&#x9677;&#x5165;&#x6B7B;&#x5FAA;&#x73AF;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x4E2D;&#x65AD;&#x6267;&#x884C;&#xFF0C;&#x4F46;&#x662F;&#x8981;&#x6C42;&#x5F53;&#x524D;&#x811A;&#x672C;&#x5FC5;&#x987B;&#x6CA1;&#x6709;&#x6210;&#x529F;&#x6267;&#x884C;&#x8FC7;redis&#x64CD;&#x4F5C;&#x7684;&#x547D;&#x4EE4;</li>
<li><code>shutdown nosave</code> - &#x5F3A;&#x5236;&#x9000;&#x51FA;lua&#x811A;&#x672C;</li>
</ul>
<h1 id="redis&#x6301;&#x4E45;&#x5316;"><a name="redis&#x6301;&#x4E45;&#x5316;" class="anchor-navigation-ex-anchor" href="#redis&#x6301;&#x4E45;&#x5316;"><i class="fa fa-link" aria-hidden="true"></i></a>redis&#x6301;&#x4E45;&#x5316;</h1>
<h2 id="&#x6301;&#x4E45;&#x5316;&#x7B80;&#x4ECB;"><a name="&#x6301;&#x4E45;&#x5316;&#x7B80;&#x4ECB;" class="anchor-navigation-ex-anchor" href="#&#x6301;&#x4E45;&#x5316;&#x7B80;&#x4ECB;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x6301;&#x4E45;&#x5316;&#x7B80;&#x4ECB;</h2>
<ul>
<li>redis&#x63D0;&#x4F9B;&#x4E86;&#x4E24;&#x79CD;&#x6301;&#x4E45;&#x5316;&#x673A;&#x5236;&#xFF0C;RDB&#x548C;AOF</li>
</ul>
<h2 id="rdb&#x6301;&#x4E45;&#x5316;"><a name="rdb&#x6301;&#x4E45;&#x5316;" class="anchor-navigation-ex-anchor" href="#rdb&#x6301;&#x4E45;&#x5316;"><i class="fa fa-link" aria-hidden="true"></i></a>RDB&#x6301;&#x4E45;&#x5316;</h2>
<ul>
<li>RDB&#x5168;&#x79F0;&#x4E3A; Redis DataBase</li>
<li>redis&#x9ED8;&#x8BA4;&#x7684;&#x7684;&#x6301;&#x4E45;&#x5316;&#x65B9;&#x6848;</li>
<li>&#x4F1A;&#x751F;&#x6210;&#x4E00;&#x4E2A;dump.rdb&#x6587;&#x4EF6;&#xFF0C;&#x91CD;&#x542F;&#x540E;&#x901A;&#x8FC7;&#x89E3;&#x6790;dump.rdb&#x6587;&#x4EF6;&#x8FDB;&#x884C;&#x6570;&#x636E;&#x6062;&#x590D;</li>
<li>&#x652F;&#x6301;&#x624B;&#x52A8;&#x89E6;&#x53D1;&#x548C;&#x81EA;&#x52A8;&#x89E6;&#x53D1;</li>
</ul>
<p>&#x4F18;&#x70B9;&#xFF1A;</p>
<ul>
<li>RDB &#x662F;&#x4E00;&#x4E2A;&#x975E;&#x5E38;&#x7D27;&#x51D1;&#x7684;&#x538B;&#x7F29;&#x6587;&#x4EF6;&#xFF0C;&#x4FDD;&#x5B58;&#x4E86;&#x4E0D;&#x540C;&#x65F6;&#x95F4;&#x70B9;&#x4E0A;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x975E;&#x5E38;&#x9002;&#x5408;&#x7528;&#x6765;&#x707E;&#x5907;&#x548C;&#x6570;&#x636E;&#x6062;&#x590D;&#x3002;</li>
<li>RDB &#x6700;&#x5927;&#x9650;&#x5EA6;&#x5730;&#x63D0;&#x9AD8;&#x4E86;Redis&#x7684;&#x6027;&#x80FD;&#xFF0C;&#x56E0;&#x4E3A;&#x7236;&#x8FDB;&#x7A0B;&#x53EA;&#x9700;&#x8981;&#x6D3E;&#x751F;&#x4E00;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x7236;&#x8FDB;&#x7A0B;&#x6C38;&#x8FDC;&#x4E0D;&#x4F1A;&#x6267;&#x884C;&#x78C1;&#x76D8; I/O &#x6216;&#x7C7B;&#x4F3C;&#x7684;&#x8017;&#x65F6;&#x64CD;&#x4F5C;&#x3002;</li>
<li>&#x4E0E;AOF&#x6301;&#x4E45;&#x5316;&#x673A;&#x5236;&#x6BD4;&#x8F83;&#xFF0C;RDB&#x65B9;&#x5F0F;&#x6062;&#x590D;&#x6570;&#x636E;&#x7684;&#x901F;&#x5EA6;&#x66F4;&#x5FEB;</li>
</ul>
<p>&#x7F3A;&#x70B9;&#xFF1A;</p>
<ul>
<li>RDB&#x65E0;&#x6CD5;&#x505A;&#x5230;&#x5B9E;&#x65F6;&#x5907;&#x4EFD;&#xFF0C;&#x5982;&#x679C;Redis&#x56E0;&#x5F02;&#x5E38;&#x505C;&#x6B62;&#x5DE5;&#x4F5C;&#x800C;&#x6CA1;&#x6709;&#x6B63;&#x786E;&#x7684;&#x5173;&#x673A;&#xFF0C;&#x90A3;&#x4E48;&#x4ECE;&#x4E0A;&#x4E00;&#x6B21;&#x5907;&#x4EFD;&#x5230;&#x5F02;&#x5E38;&#x5B95;&#x673A;&#x7684;&#x8FD9;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#x7684;&#x6570;&#x636E;&#x5C06;&#x4F1A;&#x4E22;&#x5931;</li>
<li>RDB&#x901A;&#x5E38;&#x9700;&#x8981;&#x7236;&#x8FDB;&#x7A0B;&#x6765;&#x6267;&#x884C;fork&#x64CD;&#x4F5C;&#x521B;&#x5EFA;&#x5B50;&#x7EBF;&#x7A0B;&#xFF0C;&#x6240;&#x4EE5;&#x5982;&#x679C;&#x9891;&#x7E41;&#x6267;&#x884C;fork&#x64CD;&#x4F5C;&#x800C;CPU&#x6027;&#x80FD;&#x53C8;&#x4E0D;&#x662F;&#x5F88;&#x9AD8;&#x7684;&#x8BDD;&#x53EF;&#x80FD;&#x4F1A;&#x9020;&#x6210;&#x77ED;&#x65F6;&#x95F4;&#x5185;&#x7236;&#x8FDB;&#x7A0B;&#x4E0D;&#x53EF;&#x7528;</li>
</ul>
<p>&#x81EA;&#x52A8;&#x89E6;&#x53D1;&#x6761;&#x4EF6;</p>
<ul>
<li>&#x6267;&#x884C;flushall&#x547D;&#x4EE4;&#xFF08;flushdb&#x4E0D;&#x4F1A;&#x89E6;&#x53D1;&#xFF09;&#x65F6;&#xFF0C;&#x6B64;&#x65F6;&#x751F;&#x6210;&#x7684;dump&#x6587;&#x4EF6;&#x5185;&#x6570;&#x636E;&#x662F;&#x7A7A;&#x7684;</li>
<li>&#x6267;&#x884C;shutdown&#x547D;&#x4EE4;&#x65F6;</li>
<li>&#x901A;&#x8FC7;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x81EA;&#x52A8;&#x751F;&#x6210;&#xFF0C;redis&#x9ED8;&#x8BA4;&#x914D;&#x7F6E;&#x5982;&#x4E0B;&#xFF0C;&#x8FBE;&#x5230;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;&#x6761;&#x4EF6;&#x5C31;&#x4F1A;&#x89E6;&#x53D1;</li>
</ul>
<pre class="language-"><code class="lang-redis">save 900 1 #900&#x79D2;&#x5185;&#x81F3;&#x5C11;&#x6709;1&#x4E2A;key&#x88AB;&#x6DFB;&#x52A0;&#x6216;&#x8005;&#x66F4;&#x65B0;
save 300 10 #300&#x79D2;&#x5185;&#x81F3;&#x5C11;&#x6709;10&#x4E2A;key&#x88AB;&#x6DFB;&#x52A0;&#x6216;&#x8005;&#x66F4;&#x65B0;
save 60 10000 #60&#x79D2;&#x5185;&#x81F3;&#x5C11;&#x6709;10000&#x4E2A;key&#x88AB;&#x6DFB;&#x52A0;&#x6216;&#x8005;&#x66F4;&#x65B0;
</code></pre>
<p>&#x624B;&#x52A8;&#x89E6;&#x53D1;</p>
<ul>
<li>save - &#x8FD9;&#x4E2A;&#x547D;&#x4EE4;&#x4F1A;&#x963B;&#x585E;redis&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x76F4;&#x5230;&#x6210;&#x529F;&#x521B;&#x5EFA;RDB&#x6587;&#x4EF6;&#xFF0C;&#x5728;&#x6B64;&#x671F;&#x95F4;&#x4E0D;&#x80FD;&#x6267;&#x884C;redis&#x547D;&#x4EE4;</li>
<li>bgsave - &#x7236;&#x8FDB;&#x7A0B;&#x4F1A;fork&#x4E00;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#xFF0C;&#x5B50;&#x8FDB;&#x7A0B;&#x8D1F;&#x8D23;RDB&#x6587;&#x4EF6;&#x751F;&#x6210;</li>
</ul>
<p>&#x6CE8;&#x610F;&#xFF1A;</p>
<ul>
<li>&#x4E24;&#x4E2A;&#x547D;&#x4EE4;&#x4E0D;&#x80FD;&#x540C;&#x65F6;&#x6267;&#x884C;&#xFF0C;&#x4E00;&#x4E2A;&#x6267;&#x884C;&#x53E6;&#x4E00;&#x4E2A;&#x4F1A;&#x88AB;&#x62D2;&#x7EDD;&#x6267;&#x884C;</li>
<li>lastsave &#x53EF;&#x4EE5;&#x67E5;&#x770B;&#x6700;&#x8FD1;&#x6210;&#x529F;&#x6267;&#x884C;save&#x6216;bgsave&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x8FD4;&#x56DE;&#x7684;&#x662F;unix&#x65F6;&#x95F4;&#x6233;</li>
</ul>
<p>RDB&#x673A;&#x5236;&#x7684;&#x76F8;&#x5173;&#x914D;&#x7F6E;&#xFF0C;&#x524D;&#x9762;&#x52A0;config get&#x8868;&#x793A;&#x4ECE;&#x547D;&#x4EE4;&#x884C;&#x83B7;&#x53D6;&#x8BE5;&#x914D;&#x7F6E;</p>
<ul>
<li><code>config get dir</code> - rdb&#x6587;&#x4EF6;&#x7684;&#x76EE;&#x5F55;&#xFF0C;&#x9ED8;&#x8BA4;&#x662F;&#x5B89;&#x88C5;&#x76EE;&#x5F55;</li>
<li><code>config get dbfilename</code> - rdb&#x6587;&#x4EF6;&#x540D;&#xFF0C;&#x9ED8;&#x8BA4;&#x662F;dump.rdb</li>
<li><code>config get rdbcompression</code> - rdb&#x6587;&#x4EF6;&#x662F;&#x5426;&#x662F;LZF&#x538B;&#x7F29;&#x6587;&#x4EF6;,&#x9ED8;&#x8BA4;&#x662F;yes</li>
<li><code>config get rdbchecksum</code> - &#x662F;&#x5426;&#x5F00;&#x542F;&#x6570;&#x636E;&#x6821;&#x9A8C;&#x3002;&#x9ED8;&#x8BA4;&#x662F;yes</li>
</ul>
<h2 id="aof&#x6301;&#x4E45;&#x5316;"><a name="aof&#x6301;&#x4E45;&#x5316;" class="anchor-navigation-ex-anchor" href="#aof&#x6301;&#x4E45;&#x5316;"><i class="fa fa-link" aria-hidden="true"></i></a>AOF&#x6301;&#x4E45;&#x5316;</h2>
<ul>
<li>AOF&#x5168;&#x79F0;&#x4E3A;Append Only File</li>
<li>AOF&#x662F;&#x91C7;&#x7528;&#x65E5;&#x5FD7;&#x7684;&#x5F62;&#x5F0F;&#x5C06;&#x5199;&#x64CD;&#x4F5C;&#x8FFD;&#x52A0;&#x5230;&#x6587;&#x4EF6;&#x4E2D;&#x53BB;&#x5230;</li>
<li>&#x6267;&#x884C;&#x66F4;&#x6539;&#x6570;&#x636E;&#x547D;&#x4EE4;&#x65F6;&#xFF0C;&#x547D;&#x4EE4;&#x4F1A;&#x88AB;&#x8FFD;&#x52A0;&#x5230;AOF&#x6587;&#x4EF6;&#x4E2D;&#x53BB;</li>
<li>Redis&#x91CD;&#x542F;&#x65F6;&#x4F1A;&#x6839;&#x636E;&#x65E5;&#x5FD7;&#x5185;&#x5BB9;&#x4F9D;&#x6B21;&#x6267;&#x884C;AOF&#x5230;&#x547D;&#x4EE4;&#x6765;&#x6062;&#x590D;&#x6570;&#x636E;</li>
<li>&#x540C;&#x65F6;&#x5F00;&#x542F;AOF&#x548C;RDB&#x65F6;&#xFF0C;redis&#x4F18;&#x5148;&#x4F1A;&#x4F7F;&#x7528;AOF</li>
<li>AOF&#x8BB0;&#x5F55;&#x7684;&#x662F;&#x547D;&#x4EE4;&#xFF0C;RDB&#x8BB0;&#x5F55;&#x7684;&#x662F;&#x6570;&#x636E;</li>
</ul>
<p>&#x5F00;&#x542F;AOF&#xFF0C;&#x9700;&#x8981;&#x4FEE;&#x6539;&#x914D;&#x7F6E;&#x6587;&#x4EF6;</p>
<pre class="language-"><code class="lang-bash">appendonly no  <span class="token comment">#&#x662F;&#x5426;&#x5F00;&#x542F;AOF&#x673A;&#x5236;&#xFF0C;&#x9ED8;&#x8BA4;&#x662F;no&#x8868;&#x793A;&#x5173;&#x95ED;&#xFF0C;&#x4FEE;&#x6539;&#x4E3A;yes&#x5219;&#x8868;&#x793A;&#x5F00;&#x542F;</span>
appendfilename <span class="token string">&quot;appendonly.aof&quot;</span>  <span class="token comment">#AOF&#x6587;&#x4EF6;&#x540D;</span>
</code></pre>
<p>AOF&#x662F;&#x5426;&#x5B9E;&#x65F6;&#x5199;&#x5165;&#x78C1;&#x76D8;&#x901A;&#x8FC7;appendfsync&#x914D;&#x7F6E;</p>
<table>
<thead>
<tr>
<th>appendfsync</th>
<th>&#x63CF;&#x8FF0;</th>
<th>&#x5907;&#x6CE8;</th>
</tr>
</thead>
<tbody>
<tr>
<td>always</td>
<td>&#x5199;&#x5165;&#x7F13;&#x5B58;&#x7684;&#x540C;&#x65F6;&#x901A;&#x77E5;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5237;&#x65B0;&#xFF08;fsync&#xFF09;&#x5230;&#x78C1;&#x76D8;&#xFF08;&#x4F46;&#x662F;&#x4E5F;&#x53EF;&#x80FD;&#x4F1A;&#x6709;&#x90E8;&#x5206;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x53EA;&#x662F;&#x5C3D;&#x5FEB;&#x5237;&#x76D8;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x5B9E;&#x65F6;&#x5237;&#x76D8;&#xFF09;</td>
<td>Slow, Safest</td>
</tr>
<tr>
<td>everysec</td>
<td>&#x5148;&#x5199;&#x5165;&#x7F13;&#x5B58;&#xFF0C;&#x7136;&#x540E;&#x6BCF;&#x79D2;&#x4E2D;&#x5237;&#x4E00;&#x6B21;&#x76D8;&#xFF08;&#x9ED8;&#x8BA4;&#x503C;&#xFF09;&#xFF0C;&#x8FD9;&#x79CD;&#x6A21;&#x5F0F;&#x6781;&#x7AEF;&#x60C5;&#x51B5;&#x53EF;&#x80FD;&#x4F1A;&#x4E22;&#x5931;1s&#x7684;&#x6570;&#x636E;</td>
<td>Compromise</td>
</tr>
<tr>
<td>no</td>
<td>&#x53EA;&#x5199;&#x5165;&#x7F13;&#x5B58;&#xFF0C;&#x4EC0;&#x4E48;&#x65F6;&#x5019;&#x5237;&#x76D8;&#x7531;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x81EA;&#x5DF1;&#x51B3;&#x5B9A;</td>
<td>Faster</td>
</tr>
</tbody>
</table>
<p>AOF&#x6587;&#x4EF6;&#x91CD;&#x5199;</p>
<p>&#x5BF9;&#x4E8E;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x4E86;&#x591A;&#x6B21;&#x91CD;&#x590D;&#x4FEE;&#x6539;&#xFF0C;&#x8BB0;&#x5F55;&#x591A;&#x6B21;&#x6570;&#x636E;&#x4F1A;&#x6CA1;&#x610F;&#x4E49;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x901A;&#x8FC7;AOF&#x6587;&#x4EF6;&#x91CD;&#x5199;&#x5B9E;&#x73B0;</p>
<ol>
<li>&#x91CD;&#x5199;&#x539F;&#x7406;&#xFF1A;redis&#x4F1A;&#x91CD;&#x65B0;&#x53BB;&#x8BFB;&#x53D6;&#x73B0;&#x6709;&#x7684;&#x952E;&#x503C;&#x5BF9;&#xFF0C;&#x7136;&#x540E;&#x7528;&#x4E00;&#x6761;&#x547D;&#x4EE4;&#x8BB0;&#x5F55;&#x952E;&#x503C;&#x5BF9;&#x7684;&#x503C;&#xFF0C;&#x4F46;&#x5F53;&#x5143;&#x7D20;&#x8D85;&#x8FC7;64&#x4E2A;&#xFF0C;&#x5C31;&#x4F1A;&#x7528;&#x591A;&#x6761;&#x547D;&#x4EE4;&#x6765;&#x8BB0;&#x5F55;</li>
<li>&#x91CD;&#x5199;&#x64CD;&#x4F5C;&#xFF1A;&#x5F15;&#x5165;&#x4E00;&#x4E2A;&#x91CD;&#x5199;&#x7F13;&#x51B2;&#x533A;&#xFF0C;&#x89E3;&#x51B3;&#x6570;&#x636E;&#x4E0D;&#x4E00;&#x81F4;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x5F53;&#x5F00;&#x59CB;&#x6267;&#x884C;AOF&#x6587;&#x4EF6;&#x91CD;&#x5199;&#x4E4B;&#x540E;&#x53C8;&#x63A5;&#x6536;&#x5230;&#x5BA2;&#x6237;&#x7AEF;&#x5F53;&#x8BF7;&#x6C42;&#x547D;&#x4EE4;&#xFF0C;&#x4E0D;&#x4F46;&#x8981;&#x5C06;&#x547D;&#x4EE4;&#x5199;&#x5165;&#x539F;&#x672C;&#x7684;AOF&#x7F13;&#x51B2;&#x533A;&#xFF0C;&#x8FD8;&#x8981;&#x540C;&#x65F6;&#x5199;&#x5165;AOF&#x91CD;&#x5199;&#x7F13;&#x51B2;&#x533A;&#x3002;</li>
</ol>
<p>&#x4E00;&#x65E6;&#x5B50;&#x8FDB;&#x7A0B;&#x5B8C;&#x6210;&#x6765;AOF&#x6587;&#x4EF6;&#x7684;&#x91CD;&#x5199;&#xFF0C;&#x6B64;&#x65F6;&#x4F1A;&#x5411;&#x7236;&#x8FDB;&#x7A0B;&#x53D1;&#x51FA;&#x4FE1;&#x53F7;&#xFF0C;&#x7236;&#x8FDB;&#x7A0B;&#x6536;&#x5230;&#x4FE1;&#x53F7;&#x4E4B;&#x540E;&#x4F1A;&#x8FDB;&#x884C;&#x963B;&#x585E;&#xFF0C;&#x5E76;&#x8FDB;&#x884C;</p>
<ul>
<li>&#x5C06;AOF&#x91CD;&#x5199;&#x7F13;&#x51B2;&#x533A;&#x7684;&#x6587;&#x4EF6;&#x5237;&#x65B0;&#x5230;&#x65B0;&#x7684;AOF&#x6587;&#x4EF6;&#x5185;</li>
<li>&#x5C06;&#x65B0;AOF&#x6587;&#x4EF6;&#x8FDB;&#x884C;&#x6539;&#x540D;&#x5E76;&#x539F;&#x5B50;&#x7684;&#x66FF;&#x6362;&#x6389;&#x65E7;&#x7684;AOF&#x6587;&#x4EF6;</li>
</ul>
<p>&#x89E6;&#x53D1;&#x6761;&#x4EF6;&#xFF1A;</p>
<p>&#x81EA;&#x52A8;&#x89E6;&#x53D1;&#xFF1A;&#x81EA;&#x52A8;&#x89E6;&#x53D1;&#x901A;&#x8FC7;&#x4EE5;&#x4E0B;&#x53C2;&#x6570;&#x8BBE;&#x7F6E;</p>
<pre class="language-"><code class="lang-bash">auto-aof-rewrite-percentag <span class="token comment">#&#x6587;&#x4EF6;&#x5927;&#x5C0F;&#x8D85;&#x8FC7;&#x4E0A;&#x6B21;AOF&#x91CD;&#x5199;&#x4E4B;&#x540E;&#x7684;&#x6587;&#x4EF6;&#x7684;&#x767E;&#x5206;&#x6BD4;&#x3002;&#x9ED8;&#x8BA4;100&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x9ED8;&#x8BA4;&#x8FBE;&#x5230;&#x4E0A;&#x4E00;&#x6B21;AOF&#x91CD;&#x5199;&#x6587;&#x4EF6;&#x7684;2&#x500D;&#x4E4B;&#x540E;&#x4F1A;&#x518D;&#x6B21;&#x89E6;&#x53D1;AOF&#x91CD;&#x5199;</span>
auto-aof-rewrite-min-size <span class="token comment">#&#x8BBE;&#x7F6E;&#x5141;&#x8BB8;&#x91CD;&#x5199;&#x7684;&#x6700;&#x5C0F;AOF&#x6587;&#x4EF6;&#x5927;&#x5C0F;,&#x9ED8;&#x8BA4;&#x662F;64M&#x3002;&#x4E3B;&#x8981;&#x662F;&#x907F;&#x514D;&#x6EE1;&#x8DB3;&#x4E86;&#x4E0A;&#x9762;&#x7684;&#x767E;&#x5206;&#x6BD4;&#xFF0C;&#x4F46;&#x662F;&#x6587;&#x4EF6;&#x8FD8;&#x662F;&#x5F88;&#x5C0F;&#x7684;&#x60C5;&#x51B5;&#x3002;</span>
</code></pre>
<p>&#x624B;&#x52A8;&#x89E6;&#x53D1;&#xFF1A;&#x6267;&#x884C;bgrewriteaof&#x547D;&#x4EE4;&#x3002;</p>
<p>bgrewriteaof &#x547D;&#x4EE4;&#x4E5F;&#x4E0D;&#x80FD;&#x548C;&#x4E0A;&#x9762; RDB &#x6301;&#x4E45;&#x5316;&#x547D;&#x4EE4; bgsave &#x540C;&#x65F6;&#x6267;&#x884C;&#xFF0C;&#x8FD9;&#x4E48;&#x505A;&#x662F;&#x4E3A;&#x4E86;&#x907F;&#x514D;&#x540C;&#x65F6;&#x521B;&#x5EFA;&#x4E24;&#x4E2A;&#x5B50;&#x8FDB;&#x7A0B;&#x6765;&#x540C;&#x65F6;&#x6267;&#x884C;&#x5927;&#x91CF;&#x5199;&#x78C1;&#x76D8;&#x64CD;&#x4F5C;&#xFF0C;&#x5F71;&#x54CD;&#x5230; Redis &#x7684;&#x6027;&#x80FD;&#x3002;</p>
<p>AOF&#x673A;&#x5236;&#x4F18;&#x70B9;&#xFF1A;</p>
<ul>
<li>&#x4F7F;&#x7528;AOF&#x673A;&#x5236;&#xFF0C;&#x53EF;&#x4EE5;&#x81EA;&#x7531;&#x9009;&#x62E9;&#x4E0D;&#x540C;fsync&#xFF08;&#x5237;&#x76D8;&#xFF09;&#x7B56;&#x7565;&#xFF0C;&#x800C;&#x4E14;&#x5728;&#x9ED8;&#x8BA4;&#x7B56;&#x7565;&#x4E0B;&#x6700;&#x591A;&#x4E5F;&#x4EC5;&#x4EC5;&#x662F;&#x635F;&#x5931;1s&#x7684;&#x6570;&#x636E;&#x3002;</li>
<li>AOF&#x65E5;&#x5FD7;&#x662F;&#x4E00;&#x4E2A;&#x4EC5;&#x8FFD;&#x52A0;&#x7684;&#x65E5;&#x5FD7;&#xFF0C;&#x56E0;&#x6B64;&#x5982;&#x679C;&#x51FA;&#x73B0;&#x65AD;&#x7535;&#xFF0C;&#x4E5F;&#x4E0D;&#x5B58;&#x5728;&#x67E5;&#x627E;&#x6216;&#x635F;&#x574F;&#x95EE;&#x9898;&#x3002;&#x5373;&#x4F7F;&#x7531;&#x4E8E;&#x67D0;&#x4E9B;&#x539F;&#x56E0;&#xFF08;&#x78C1;&#x76D8;&#x5DF2;&#x6EE1;&#x6216;&#x5176;&#x5B83;&#x539F;&#x56E0;&#xFF09;&#xFF0C;&#x65E5;&#x5FD7;&#x5DF2;&#x7ECF;&#x5199;&#x4E86;&#x4E00;&#x534A;&#x7684;&#x547D;&#x4EE4;&#x7ED3;&#x675F;&#xFF0C;redis-check-aof&#x5DE5;&#x5177;&#x4E5F;&#x80FD;&#x591F;&#x8F7B;&#x677E;&#x5730;&#x4FEE;&#x590D;&#x5B83;&#x3002;</li>
<li>&#x5F53;AOF&#x6587;&#x4EF6;&#x53D8;&#x5F97;&#x592A;&#x5927;&#x65F6;&#xFF0C;Redis&#x80FD;&#x591F;&#x5728;&#x540E;&#x53F0;&#x81EA;&#x52A8;&#x91CD;&#x5199;&#x3002;</li>
<li>&#x4E0D;&#x540C;&#x4E8E;RDB&#x7684;&#x6587;&#x4EF6;&#x683C;&#x5F0F;&#xFF0C;AOF&#x662F;&#x4E00;&#x79CD;&#x6613;&#x4E8E;&#x7406;&#x89E3;&#x548C;&#x89E3;&#x6790;&#x7684;&#x683C;&#x5F0F;&#xFF0C;&#x4F9D;&#x6B21;&#x5305;&#x542B;&#x6240;&#x6709;&#x64CD;&#x4F5C;&#x7684;&#x65E5;&#x5FD7;&#x3002;</li>
</ul>
<p>AOF&#x673A;&#x5236;&#x7F3A;&#x70B9;&#xFF1A;</p>
<ul>
<li>&#x5BF9;&#x4E8E;&#x76F8;&#x540C;&#x7684;&#x6570;&#x636E;&#x96C6;&#xFF0C;AOF&#x6587;&#x4EF6;&#x901A;&#x5E38;&#x6BD4;&#x7B49;&#x6548;&#x7684;RDB&#x6587;&#x4EF6;&#x5927;&#x3002;</li>
<li>&#x6839;&#x636E;fsync&#x7684;&#x5177;&#x4F53;&#x7B56;&#x7565;&#xFF0C;AOF&#x673A;&#x5236;&#x53EF;&#x80FD;&#x6BD4;RDB&#x673A;&#x5236;&#x6162;&#x3002;&#x4F46;&#x662F;&#x4E00;&#x822C;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;fsync&#x8BBE;&#x7F6E;&#x4E3A;&#x6BCF;&#x79D2;&#x7684;&#x6027;&#x80FD;&#x4ECD;&#x7136;&#x5F88;&#x9AD8;&#xFF0C;&#x7981;&#x7528;fsync&#x540E;&#xFF0C;&#x5373;&#x4F7F;&#x5728;&#x9AD8;&#x8D1F;&#x8F7D;&#x4E0B;&#xFF0C;&#x5B83;&#x7684;&#x901F;&#x5EA6;&#x4E5F;&#x80FD;&#x548C;RDB&#x4E00;&#x6837;&#x5FEB;&#x3002;</li>
<li>&#x56E0;&#x4E3A;AOF&#x6587;&#x4EF6;&#x662F;&#x8FFD;&#x52A0;&#x5F62;&#x5F0F;&#xFF0C;&#x53EF;&#x80FD;&#x4F1A;&#x9047;&#x5230;BRPOP&#x3001;LPUSH&#x7B49;&#x963B;&#x585E;&#x547D;&#x4EE4;&#x7684;&#x9519;&#x8BEF;&#xFF0C;&#x4ECE;&#x800C;&#x5BFC;&#x81F4;&#x751F;&#x6210;&#x7684;AOF &#x5728;&#x91CD;&#x65B0;&#x52A0;&#x8F7D;&#x65F6;&#x4E0D;&#x80FD;&#x590D;&#x5236;&#x5B8C;&#x5168;&#x76F8;&#x540C;&#x7684;&#x6570;&#x636E;&#x96C6;&#xFF0C;&#x800C;RDB&#x6587;&#x4EF6;&#x6BCF;&#x6B21;&#x90FD;&#x662F;&#x91CD;&#x65B0;&#x4ECE;&#x5934;&#x521B;&#x5EFA;&#x5FEB;&#x7167;&#xFF0C;&#x8FD9;&#x5728;&#x4E00;&#x5B9A;&#x7A0B;&#x5EA6;&#x4E0A;&#x6765;&#x8BF4;RDB&#x6587;&#x4EF6;&#x66F4;&#x52A0;&#x5065;&#x58EE;&#x3002;</li>
</ul>
<h1 id="&#x5185;&#x5B58;&#x7BA1;&#x7406;"><a name="&#x5185;&#x5B58;&#x7BA1;&#x7406;" class="anchor-navigation-ex-anchor" href="#&#x5185;&#x5B58;&#x7BA1;&#x7406;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5185;&#x5B58;&#x7BA1;&#x7406;</h1>
<h2 id="&#x5185;&#x5B58;&#x56DE;&#x6536;"><a name="&#x5185;&#x5B58;&#x56DE;&#x6536;" class="anchor-navigation-ex-anchor" href="#&#x5185;&#x5B58;&#x56DE;&#x6536;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5185;&#x5B58;&#x56DE;&#x6536;</h2>
<p>&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x6570;&#x636E;&#x6709;&#x6548;&#x65F6;&#x95F4;&#x6765;&#x4F7F;&#x5185;&#x5B58;&#x91CA;&#x653E;</p>
<ul>
<li><code>EXPIRE key seconds</code> - &#x8BBE;&#x7F6E; key &#x8FC7;&#x671F;&#x65F6;&#x95F4;&#xFF0C;&#x5355;&#x4F4D;&#x4E3A;&#x79D2;</li>
<li><code>EXPIREAT key timestamp</code> - &#x8BBE;&#x7F6E;&#x4EE5;&#x79D2;&#x4E3A;&#x5355;&#x4F4D;&#x7684; key &#x8FC7;&#x671F;&#x65F6;&#x95F4;&#x7684;&#x65F6;&#x95F4;&#x6233;&#xFF0C;&#x65F6;&#x95F4;&#x6233;&#x957F;&#x5EA6;&#x4E3A;10</li>
<li><code>PEXPIRE key milliseconds</code> - &#x8BBE;&#x7F6E; key &#x8FC7;&#x671F;&#x65F6;&#x95F4;&#xFF0C;&#x5355;&#x4F4D;&#x4E3A;&#x6BEB;&#x79D2;</li>
<li><code>PEXPIREAT key milliseconds-timestamp</code> - &#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x4EE5;&#x6BEB;&#x79D2;&#x4E3A;&#x5355;&#x4F4D;&#x7684; key &#x8FC7;&#x671F;&#x65F6;&#x95F4;&#x7684;&#x65F6;&#x95F4;&#x6233;&#xFF0C;&#x65F6;&#x95F4;&#x6233;&#x957F;&#x5EA6;&#x4E3A;13</li>
<li><code>SETEX key seconds value</code> - &#x8BBE;&#x7F6E; key &#x5BF9;&#x5E94;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5E76;&#x8BBE;&#x7F6E;&#x8BE5; key &#x7684;&#x8FC7;&#x671F;&#x65F6;&#x95F4;&#xFF0C;&#x7B49;&#x4EF7;&#x4E8E;&#x6267;&#x884C;&#x4E00;&#x4E0B;&#x4E24;&#x6761;&#x547D;&#x4EE4;<ul>
<li><code>SET key value</code></li>
<li><code>EXPIRE key seconds</code></li>
</ul>
</li>
<li><code>PSETEX key milliseconds value</code> - &#x529F;&#x80FD;&#x540C; <code>SETEX</code> &#xFF0C;&#x8BBE;&#x7F6E; key &#x5BF9;&#x4E8E;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5E76;&#x8BBE;&#x7F6E;&#x8BE5; key &#x7684;&#x8FC7;&#x671F;&#x65F6;&#x95F4;&#xFF0C;&#x65F6;&#x95F4;&#x5355;&#x4F4D;&#x4E3A;&#x6BEB;&#x79D2;</li>
</ul>
<p>&#x6240;&#x6709;&#x8BBE;&#x7F6E;&#x8FC7;&#x671F;&#x65B9;&#x6CD5;&#x5E95;&#x5C42;&#x90FD;&#x662F;&#x901A;&#x8FC7;pexpireat&#x6765;&#x5B9E;&#x73B0;&#x7684;</p>
<h2 id="&#x8FC7;&#x671F;&#x7B56;&#x7565;"><a name="&#x8FC7;&#x671F;&#x7B56;&#x7565;" class="anchor-navigation-ex-anchor" href="#&#x8FC7;&#x671F;&#x7B56;&#x7565;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x8FC7;&#x671F;&#x7B56;&#x7565;</h2>
<p>redis&#x4E2D;&#x7684;&#x8FC7;&#x671F;&#x7B56;&#x7565;&#xFF1A;</p>
<ul>
<li>&#x60F0;&#x6027;&#x5220;&#x9664;<ul>
<li>&#x4F7F;&#x7528; <code>expireIfNeeded()</code> &#x51FD;&#x6570;&#x5BF9; key &#x8FDB;&#x884C;&#x68C0;&#x67E5;&#xFF0C;&#x5982;&#x679C;&#x8FC7;&#x671F;&#x4E86;&#x5C31;&#x4F1A;&#x5C06; key &#x5220;&#x9664;&#x6389;&#xFF0C;&#x5982;&#x679C;&#x672A;&#x8FC7;&#x671F;&#x5219;&#x4E0D;&#x505A;&#x64CD;&#x4F5C;</li>
</ul>
</li>
<li>&#x5B9A;&#x671F;&#x5220;&#x9664;<ul>
<li>Redis &#x542F;&#x52A8;&#x670D;&#x52A1;&#x65F6;&#xFF0C;&#x8BFB;&#x53D6;&#x914D;&#x7F6E;&#x4E2D;&#x7684; <code>server.hz</code> &#x7684;&#x503C;&#xFF0C;&#x9ED8;&#x8BA4;&#x4E3A;10</li>
<li>&#x6BCF;&#x79D2;&#x6267;&#x884C; <code>server.hz</code> &#x6B21; <code>serverCron()</code> &#x51FD;&#x6570;&#xFF0C; <code>serverCron()</code> &#x4F1A;&#x8C03;&#x7528; <code>databasesCron</code> &#xFF0C; <code>databasesCron()</code> &#x4F1A;&#x8C03;&#x7528; <code>activeExpireCycle()</code></li>
<li><code>activeExpireCycle()</code> &#x5BF9;&#x6BCF;&#x4E2A; <code>expires[*]</code> &#x9010;&#x4E00;&#x8FDB;&#x884C;&#x68C0;&#x6D4B;&#xFF0C;&#x6BCF;&#x6B21;&#x6267;&#x884C; <code>250ms/server.hz</code> &#x6BEB;&#x79D2;</li>
<li>&#x5BF9;&#x6BCF;&#x4E2A; <code>expires[*]</code> &#x68C0;&#x6D4B;&#x65F6;&#xFF0C;&#x968F;&#x673A;&#x6311;&#x9009;W&#x4E2A;key&#x68C0;&#x6D4B;<ul>
<li>&#x5982;&#x679C;key&#x8D85;&#x65F6;&#xFF0C;&#x5219;&#x5220;&#x9664; key</li>
<li>&#x5982;&#x679C;&#x4E00;&#x8F6E;&#x4E2D;&#x6EE1;&#x8DB3; <code>&#x5220;&#x9664;&#x7684; key &#x6570;&#x91CF; &gt; W * 25%</code> , &#x5219;&#x5FAA;&#x73AF;&#x8BE5;&#x8FC7;&#x7A0B;</li>
<li>&#x5982;&#x679C;&#x4E00;&#x8F6E;&#x4E2D;&#x6EE1;&#x8DB3; <code>&#x5220;&#x9664;&#x7684; key &#x6570;&#x91CF; &lt;= W * 25%</code> , &#x5219;&#x68C0;&#x67E5;&#x4E0B;&#x4E2A; db &#x7684;expires</li>
<li>W &#x53D6;&#x503C;&#x4E3A; <code>ACTIVE_EXPIRE_CYCLE_LOOKUP_PER_LOOP</code> &#x5C5E;&#x6027;&#x7684;&#x503C;</li>
</ul>
</li>
<li>&#x53C2;&#x6570; <code>current_db</code> &#x8BB0;&#x5F55; <code>activeExpireCycle()</code> &#x6267;&#x884C;&#x5230;&#x54EA;&#x4E2A; db</li>
<li>&#x5982;&#x679C;&#x6267;&#x884C; <code>activeExpireCycle()</code> &#x65F6;&#x95F4;&#x5230;&#x671F;&#xFF0C;&#x4E0B;&#x6B21;&#x7EE7;&#x7EED;&#x4ECE; <code>current_db</code> &#x8FDB;&#x884C;&#x6267;&#x884C;</li>
</ul>
</li>
</ul>
<p>redis&#x4E2D;&#x5B9A;&#x671F;&#x626B;&#x63CF;&#x53EA;&#x626B;&#x63CF;&#x6709;&#x8FC7;&#x671F;&#x65F6;&#x95F4;&#x7684;&#x952E;&#xFF0C;&#x4E0D;&#x4F1A;&#x626B;&#x63CF;&#x6240;&#x6709;&#x7684;&#x952E;&#xFF0C;&#x6709;&#x8FC7;&#x671F;&#x65F6;&#x95F4;&#x7684;&#x952E;&#x662F;&#x5355;&#x72EC;&#x5B58;&#x50A8;&#x7684;&#x3002;</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">redisDb</span> <span class="token punctuation">{</span>
    dict <span class="token operator">*</span>dict<span class="token punctuation">;</span> <span class="token comment">//&#x6240;&#x6709;&#x7684;&#x952E;&#x503C;&#x5BF9;</span>
    dict <span class="token operator">*</span>expires<span class="token punctuation">;</span> <span class="token comment">//&#x8BBE;&#x7F6E;&#x4E86;&#x8FC7;&#x671F;&#x65F6;&#x95F4;&#x7684;&#x952E;&#x503C;&#x5BF9;</span>
    dict <span class="token operator">*</span>blocking_keys<span class="token punctuation">;</span> <span class="token comment">//&#x88AB;&#x963B;&#x585E;&#x7684;key,&#x5982;&#x5BA2;&#x6237;&#x7AEF;&#x6267;&#x884C;BLPOP&#x7B49;&#x963B;&#x585E;&#x6307;&#x4EE4;&#x65F6;</span>
    dict <span class="token operator">*</span>watched_keys<span class="token punctuation">;</span> <span class="token comment">//WATCHED keys</span>
    <span class="token keyword">int</span> id<span class="token punctuation">;</span> <span class="token comment">//Database ID</span>
    <span class="token comment">//... &#x7701;&#x7565;&#x4E86;&#x5176;&#x4ED6;&#x5C5E;&#x6027;</span>
<span class="token punctuation">}</span> redisDb<span class="token punctuation">;</span>
</code></pre>
<h2 id="&#x6DD8;&#x6C70;&#x7B56;&#x7565;"><a name="&#x6DD8;&#x6C70;&#x7B56;&#x7565;" class="anchor-navigation-ex-anchor" href="#&#x6DD8;&#x6C70;&#x7B56;&#x7565;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x6DD8;&#x6C70;&#x7B56;&#x7565;</h2>
<p>&#x6570;&#x636E;&#x6DD8;&#x6C70;&#x76F8;&#x5173;&#x7684;&#x914D;&#x7F6E;&#xFF1A;</p>
<ul>
<li><code>maxmemory ?mb</code> - &#x6700;&#x5927;&#x53EF;&#x7528;&#x5185;&#x5B58;&#xFF0C;64&#x4F4D;&#x7CFB;&#x7EDF;&#x9ED8;&#x8BA4;&#x503C;&#x4E3A;0&#xFF0C;&#x8868;&#x793A;&#x4E0D;&#x9650;&#x5236;&#xFF0C;32&#x4F4D;&#x7CFB;&#x7EDF;&#x9ED8;&#x8BA4;&#x9690;&#x5F0F;&#x9650;&#x5236;&#x4E3A;3GB</li>
<li><code>maxmemory-samples count</code> - &#x6BCF;&#x6B21;&#x9009;&#x53D6;&#x5220;&#x9664;&#x6570;&#x636E;&#x7684;&#x4E2A;&#x6570;&#xFF0C;&#x91C7;&#x7528;&#x968F;&#x673A;&#x83B7;&#x53D6;&#x6570;&#x636E;&#x7684;&#x65B9;&#x5F0F;&#x4E3A;&#x5F85;&#x68C0;&#x6D4B;&#x5220;&#x9664;&#x6570;&#x636E;</li>
<li><code>maxmemory-policy policy</code> - &#x5220;&#x9664;&#x6570;&#x636E;&#x6240;&#x4F7F;&#x7528;&#x7684;&#x7B56;&#x7565;&#xFF0C;&#x4E3B;&#x8981;&#x5B58;&#x5728;&#x4EE5;&#x4E0B;8&#x79CD;</li>
</ul>
<p>maxmemory-policy&#x53EF;&#x4EE5;&#x914D;&#x7F6E;&#x4E3A;&#x4EE5;&#x4E0B;&#x503C;</p>
<table>
<thead>
<tr>
<th>&#x6DD8;&#x6C70;&#x7B56;&#x7565;</th>
<th>&#x8BF4;&#x660E;</th>
</tr>
</thead>
<tbody>
<tr>
<td>volatile-lru</td>
<td>&#x6839;&#x636E; LRU &#x7B97;&#x6CD5;&#x5220;&#x9664;&#x8BBE;&#x7F6E;&#x4E86;&#x8FC7;&#x671F;&#x65F6;&#x95F4;&#x7684;&#x952E;&#xFF0C;&#x76F4;&#x5230;&#x817E;&#x51FA;&#x53EF;&#x7528;&#x7A7A;&#x95F4;&#x3002;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x53EF;&#x5220;&#x9664;&#x7684;&#x952E;&#x5BF9;&#x8C61;&#xFF0C;&#x4E14;&#x5185;&#x5B58;&#x8FD8;&#x662F;&#x4E0D;&#x591F;&#x7528;&#x65F6;&#xFF0C;&#x5219;&#x62A5;&#x9519;</td>
</tr>
<tr>
<td>allkeys-lru</td>
<td>&#x6839;&#x636E; LRU &#x7B97;&#x6CD5;&#x5220;&#x9664;&#x6240;&#x6709;&#x7684;&#x952E;&#xFF0C;&#x76F4;&#x5230;&#x817E;&#x51FA;&#x53EF;&#x7528;&#x7A7A;&#x95F4;&#x3002;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x53EF;&#x5220;&#x9664;&#x7684;&#x952E;&#x5BF9;&#x8C61;&#xFF0C;&#x4E14;&#x5185;&#x5B58;&#x8FD8;&#x662F;&#x4E0D;&#x591F;&#x7528;&#x65F6;&#xFF0C;&#x5219;&#x62A5;&#x9519;</td>
</tr>
<tr>
<td>volatile-lfu</td>
<td>&#x6839;&#x636E; LFU &#x7B97;&#x6CD5;&#x5220;&#x9664;&#x8BBE;&#x7F6E;&#x4E86;&#x8FC7;&#x671F;&#x65F6;&#x95F4;&#x7684;&#x952E;&#xFF0C;&#x76F4;&#x5230;&#x817E;&#x51FA;&#x53EF;&#x7528;&#x7A7A;&#x95F4;&#x3002;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x53EF;&#x5220;&#x9664;&#x7684;&#x952E;&#x5BF9;&#x8C61;&#xFF0C;&#x4E14;&#x5185;&#x5B58;&#x8FD8;&#x662F;&#x4E0D;&#x591F;&#x7528;&#x65F6;&#xFF0C;&#x5219;&#x62A5;&#x9519;</td>
</tr>
<tr>
<td>volatile-ttl</td>
<td>&#x6839;&#x636E;&#x952E;&#x503C;&#x5BF9;&#x8C61;&#x7684; ttl &#x5C5E;&#x6027;&#xFF0C; &#x5220;&#x9664;&#x6700;&#x8FD1;&#x5C06;&#x8981;&#x8FC7;&#x671F;&#x6570;&#x636E;&#x3002; &#x5982;&#x679C;&#x6CA1;&#x6709;&#xFF0C;&#x5219;&#x76F4;&#x63A5;&#x62A5;&#x9519;</td>
</tr>
<tr>
<td>allkeys-lfu</td>
<td>&#x6839;&#x636E; LFU &#x7B97;&#x6CD5;&#x5220;&#x9664;&#x6240;&#x6709;&#x7684;&#x952E;&#xFF0C;&#x76F4;&#x5230;&#x817E;&#x51FA;&#x53EF;&#x7528;&#x7A7A;&#x95F4;&#x3002;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x53EF;&#x5220;&#x9664;&#x7684;&#x952E;&#x5BF9;&#x8C61;&#xFF0C;&#x4E14;&#x5185;&#x5B58;&#x8FD8;&#x662F;&#x4E0D;&#x591F;&#x7528;&#x65F6;&#xFF0C;&#x5219;&#x62A5;&#x9519;</td>
</tr>
<tr>
<td>volatile-random</td>
<td>&#x968F;&#x673A;&#x5220;&#x9664;&#x8BBE;&#x7F6E;&#x4E86;&#x8FC7;&#x671F;&#x65F6;&#x95F4;&#x7684;&#x952E;&#xFF0C;&#x76F4;&#x5230;&#x817E;&#x51FA;&#x53EF;&#x7528;&#x7A7A;&#x95F4;&#x3002;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x53EF;&#x5220;&#x9664;&#x7684;&#x952E;&#x5BF9;&#x8C61;&#xFF0C;&#x4E14;&#x5185;&#x5B58;&#x8FD8;&#x662F;&#x4E0D;&#x591F;&#x7528;&#x65F6;&#xFF0C;&#x5219;&#x62A5;&#x9519;</td>
</tr>
<tr>
<td>allkeys-random</td>
<td>&#x968F;&#x673A;&#x5220;&#x9664;&#x6240;&#x6709;&#x952E;&#xFF0C;&#x76F4;&#x5230;&#x817E;&#x51FA;&#x53EF;&#x7528;&#x7A7A;&#x95F4;&#x3002;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x53EF;&#x5220;&#x9664;&#x7684;&#x952E;&#x5BF9;&#x8C61;&#xFF0C;&#x4E14;&#x5185;&#x5B58;&#x8FD8;&#x662F;&#x4E0D;&#x591F;&#x7528;&#x65F6;&#xFF0C;&#x5219;&#x62A5;&#x9519;</td>
</tr>
<tr>
<td>noeviction</td>
<td>&#x9ED8;&#x8BA4;&#x7B56;&#x7565;&#xFF0C;&#x4E0D;&#x4F5C;&#x4EFB;&#x4F55;&#x5904;&#x7406;&#xFF0C;&#x76F4;&#x63A5;&#x62A5;&#x9519;</td>
</tr>
</tbody>
</table>
<p>&#x62A5;&#x9519;&#x4E3A; <code>(error)OOM command not allowed when used memory&gt;&apos;maxmemory&apos;</code></p>
<h2 id="lru-&#x7B97;&#x6CD5;"><a name="lru-&#x7B97;&#x6CD5;" class="anchor-navigation-ex-anchor" href="#lru-&#x7B97;&#x6CD5;"><i class="fa fa-link" aria-hidden="true"></i></a>LRU &#x7B97;&#x6CD5;</h2>
<p>LRU&#x5168;&#x79F0;&#x4E3A;least recently used&#xFF0C;&#x6700;&#x8FD1;&#x6700;&#x957F;&#x65F6;&#x95F4;&#x672A;&#x4F7F;&#x7528;</p>
<p>&#x7F3A;&#x70B9;&#xFF1A;</p>
<ul>
<li>&#x9700;&#x8981;&#x989D;&#x5916;&#x7684;&#x7A7A;&#x95F4;&#x8FDB;&#x884C;&#x5B58;&#x50A8;</li>
<li>&#x53EF;&#x80FD;&#x5B58;&#x5728;&#x67D0;&#x4E9B;key&#x4F7F;&#x7528;&#x5F88;&#x9891;&#x7E41;&#xFF0C;&#x4F46;&#x6700;&#x8FD1;&#x6CA1;&#x4F7F;&#x7528;&#xFF0C;&#x88AB;LRU&#x7B97;&#x6CD5;&#x5220;&#x9664;</li>
</ul>
<p>redis&#x6539;&#x8FDB;&#x4E86;LRU&#x7B97;&#x6CD5;&#xFF0C;&#x901A;&#x8FC7;&#x62BD;&#x6837;&#x7684;&#x65B9;&#x5F0F;&#x8FDB;&#x884C;&#x5220;&#x9664;</p>
<p>&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x6709;&#x4E2A;maxmemory_samples&#xFF0C;&#x9ED8;&#x8BA4;&#x4E3A;5&#xFF0C;&#x8868;&#x793A;&#x968F;&#x673A;&#x62BD;&#x53D6;5&#x4E2A;key&#xFF0C;&#x5BF9;&#x8FD9;5&#x4E2A;key&#x503C;&#x6309;&#x7167;LRU&#x7B97;&#x6CD5;&#x5220;&#x9664;</p>
<p>redisObject&#x5BF9;&#x8C61;&#x4E2D;&#x6709;&#x4E00;&#x4E2A;lru&#x5C5E;&#x6027;&#xFF1A;</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">redisObject</span> <span class="token punctuation">{</span>
    <span class="token keyword">unsigned</span> type<span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">;</span><span class="token comment">//&#x5BF9;&#x8C61;&#x7C7B;&#x578B;&#xFF08;4&#x4F4D;=0.5&#x5B57;&#x8282;&#xFF09;</span>
    <span class="token keyword">unsigned</span> encoding<span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">;</span><span class="token comment">//&#x7F16;&#x7801;&#xFF08;4&#x4F4D;=0.5&#x5B57;&#x8282;&#xFF09;</span>
    <span class="token keyword">unsigned</span> lru<span class="token operator">:</span>LRU_BITS<span class="token punctuation">;</span><span class="token comment">//&#x8BB0;&#x5F55;&#x5BF9;&#x8C61;&#x6700;&#x540E;&#x4E00;&#x6B21;&#x88AB;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x8BBF;&#x95EE;&#x7684;&#x65F6;&#x95F4;&#xFF08;24&#x4F4D;=3&#x5B57;&#x8282;&#xFF09;</span>
    <span class="token keyword">int</span> refcount<span class="token punctuation">;</span><span class="token comment">//&#x5F15;&#x7528;&#x8BA1;&#x6570;&#x3002;&#x7B49;&#x4E8E;0&#x65F6;&#x8868;&#x793A;&#x53EF;&#x4EE5;&#x88AB;&#x5783;&#x573E;&#x56DE;&#x6536;&#xFF08;32&#x4F4D;=4&#x5B57;&#x8282;&#xFF09;</span>
    <span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">;</span><span class="token comment">//&#x6307;&#x5411;&#x5E95;&#x5C42;&#x5B9E;&#x9645;&#x7684;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x7ED3;&#x6784;&#xFF0C;&#x5982;&#xFF1A;SDS&#x7B49;(8&#x5B57;&#x8282;)</span>
<span class="token punctuation">}</span> robj<span class="token punctuation">;</span>
</code></pre>
<p>lru&#x5C5E;&#x6027;&#x5C31;&#x662F;&#x8BB0;&#x5F55;&#x4E86;&#x8FD9;&#x4E2A;&#x952E;&#x6700;&#x540E;&#x88AB;&#x8BBF;&#x95EE;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x7136;&#x540E;redis&#x7EF4;&#x62A4;&#x4E86;&#x4E00;&#x4E2A;&#x5168;&#x5C40;&#x7684;lru_clock&#xFF0C;&#x8FD9;&#x4E2A;&#x5168;&#x5C40;&#x5C5E;&#x6027;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;&#x5168;&#x5C40;&#x51FD;&#x6570;serverCron&#x6BCF;&#x9694;100&#x6BEB;&#x79D2;&#x6267;&#x884C;&#x4E00;&#x6B21;&#x6765;&#x66F4;&#x65B0;&#xFF0C;&#x8BB0;&#x5F55;&#x5F53;&#x524D;unix&#x65F6;&#x95F4;&#x6233;&#x3002;&#x4F7F;&#x7528;lru_clock&#x53EF;&#x4EE5;&#x907F;&#x514D;&#x6BCF;&#x6B21;&#x8BFB;&#x53D6;&#x7CFB;&#x7EDF;&#x65F6;&#x95F4;&#xFF0C;&#x5BF9;&#x6027;&#x80FD;&#x7684;&#x6781;&#x81F4;&#x4F18;&#x5316;</p>
<p>&#x6CE8;&#x610F;&#xFF1A;redisObject&#x7684;lru&#x4E3A;24&#x4F4D;&#xFF0C;&#x53EA;&#x80FD;&#x5B58;&#x50A8;194&#x5929;&#x7684;&#x65F6;&#x95F4;&#x6233;&#xFF0C;&#x8D85;&#x8FC7;194&#x5929;&#x53C8;&#x4F1A;&#x4ECE;0&#x5F00;&#x59CB;&#x8BA1;&#x6570;&#xFF0C;&#x6240;&#x4EE5;&#x6B64;&#x5904;&#x6709;&#x4E24;&#x79CD;&#x60C5;&#x51B5;</p>
<ul>
<li>&#x5F53;lru_clock &gt; lru&#x65F6;&#xFF0C;&#x7A7A;&#x95F2;&#x65F6;&#x95F4;&#x4E3A;lruclock - lru</li>
<li>&#x5F53;lru_clock &lt; lru&#x65F6;&#xFF0C;&#x7A7A;&#x95F2;&#x65F6;&#x95F4;&#x4E3A;lruclock_max(194&#x5929;) - lru + lruclock</li>
</ul>
<h2 id="lfu&#x7B97;&#x6CD5;"><a name="lfu&#x7B97;&#x6CD5;" class="anchor-navigation-ex-anchor" href="#lfu&#x7B97;&#x6CD5;"><i class="fa fa-link" aria-hidden="true"></i></a>LFU&#x7B97;&#x6CD5;</h2>
<p>LFU&#x5168;&#x79F0;&#x4E3A;Least Frequently Used&#xFF0C;&#x5373;&#x6700;&#x8FD1;&#x6700;&#x5C11;&#x9891;&#x7387;&#x4F7F;&#x7528;</p>
<p>&#x5F53;&#x91C7;&#x7528;LFU&#x56DE;&#x6536;&#x7B56;&#x7565;&#x65F6;&#xFF0C;lru&#x5C5E;&#x6027;&#x9AD8;16&#x4F4D;&#x7528;&#x6765;&#x8BB0;&#x5F55;&#x8BBF;&#x95EE;&#x65F6;&#x95F4;&#xFF0C;&#x4F4E;8&#x4E3A;&#x8BB0;&#x5F55;&#x8BBF;&#x95EE;&#x9891;&#x7387;&#xFF08;counter&#xFF09;</p>
<p>&#x589E;&#x52A0;&#xFF1A;&#x53D6;0&#x5230;1&#x7684;&#x968F;&#x673A;&#x6570;&#xFF0C;&#x8BA1;&#x7B97;counter-&#x521D;&#x59CB;&#x503C;&#xFF08;&#x9ED8;&#x8BA4;&#x4E3A;5&#xFF09;&#x4E3A;&#x57FA;&#x7840;&#x503C;&#xFF0C;&#x8BA1;&#x7B97;1/&#xFF08;&#x57FA;&#x7840;&#x503C;*lfu_log_factor+1&#xFF09;&#xFF0C;&#x5982;&#x679C;&#x503C;&#x5927;&#x4E8E;&#x968F;&#x673A;&#x6570;&#xFF0C;counter&#x5219;&#x52A0;1</p>
<p>&#x51CF;&#x5C0F;&#xFF1A;&#x53BB;&#x9664;&#x5F53;&#x524D;&#x7684;&#x65F6;&#x95F4;&#x6233;&#x548C;&#x5BF9;&#x8C61;&#x4E2D;&#x7684;lru&#x5C5E;&#x6027;&#x8FDB;&#x884C;&#x5BF9;&#x6BD4;&#xFF0C;&#x8BA1;&#x7B97;&#x51FA;&#x591A;&#x4E45;&#x6CA1;&#x6709;&#x88AB;&#x8BBF;&#x95EE;&#xFF0C;&#x518D;&#x9664;&#x4EE5;&#x914D;&#x7F6E;&#x7684;lfu_decay_time&#xFF08;&#x9ED8;&#x8BA4;&#x4E3A;10&#xFF09;&#xFF0C;&#x7528;counter&#x51CF;&#x53BB;&#x5F97;&#x5230;&#x7684;&#x503C;&#x3002;</p>
<h1 id="redis&#x4E8B;&#x52A1;"><a name="redis&#x4E8B;&#x52A1;" class="anchor-navigation-ex-anchor" href="#redis&#x4E8B;&#x52A1;"><i class="fa fa-link" aria-hidden="true"></i></a>redis&#x4E8B;&#x52A1;</h1>
<h2 id="&#x4E8B;&#x52A1;&#x4F7F;&#x7528;"><a name="&#x4E8B;&#x52A1;&#x4F7F;&#x7528;" class="anchor-navigation-ex-anchor" href="#&#x4E8B;&#x52A1;&#x4F7F;&#x7528;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x4E8B;&#x52A1;&#x4F7F;&#x7528;</h2>
<ul>
<li><code>multi</code> - &#x5F00;&#x542F;&#x4E8B;&#x52A1;</li>
<li><code>exec</code> - &#x6267;&#x884C;&#x4E8B;&#x52A1;&#xFF08;&#x63D0;&#x4EA4;&#xFF09;</li>
<li><code>discard</code> - &#x53D6;&#x6D88;&#x4E8B;&#x52A1;</li>
<li><code>watch</code> - &#x76D1;&#x89C6;</li>
</ul>
<p>&#x4E8B;&#x52A1;&#x6267;&#x884C;&#x6B65;&#x9AA4;&#xFF1A;</p>
<ol>
<li>multi&#x5F00;&#x542F;&#x4E00;&#x4E2A;&#x4E8B;&#x52A1;</li>
<li>&#x5F00;&#x59CB;&#x4E8B;&#x52A1;&#x540E;&#x6267;&#x884C;&#x7684;&#x547D;&#x4EE4;&#x4F1A;&#x653E;&#x5165;&#x4E00;&#x4E2A;&#x961F;&#x5217;&#xFF0C;</li>
<li>&#x6267;&#x884C;exec&#x63D0;&#x4EA4;&#x4E8B;&#x52A1;&#xFF0C;redis&#x4F1A;&#x4F9D;&#x6B21;&#x6267;&#x884C;&#x961F;&#x5217;&#x4E2D;&#x7684;&#x547D;&#x4EE4;&#xFF0C;&#x5E76;&#x8FD4;&#x56DE;&#x7ED3;&#x679C;&#xFF0C;&#x5982;&#x679C;&#x60F3;&#x8981;&#x653E;&#x5F03;&#xFF0C;&#x53EF;&#x4EE5;&#x6267;&#x884C;discard</li>
</ol>
<p>&#x793A;&#x4F8B;&#xFF1A;</p>
<pre class="language-"><code class="lang-bash">multi //&#x5F00;&#x542F;&#x4E8B;&#x52A1;
<span class="token builtin class-name">set</span> name lonely_wolf //&#x8BBE;&#x7F6E; name&#xFF0C;&#x6B64;&#x65F6; Redis &#x4F1A;&#x5C06;&#x547D;&#x4EE4;&#x653E;&#x5165;&#x961F;&#x5217;
<span class="token builtin class-name">set</span> age <span class="token number">18</span>  //&#x8BBE;&#x503C; age&#xFF0C;&#x6B64;&#x65F6; Redis &#x4F1A;&#x5C06;&#x547D;&#x4EE4;&#x653E;&#x5165;&#x961F;&#x5217;
get name  //&#x83B7;&#x53D6; name&#xFF0C;&#x6B64;&#x65F6; Redis &#x4F1A;&#x5C06;&#x547D;&#x4EE4;&#x653E;&#x5165;&#x961F;&#x5217;
<span class="token builtin class-name">exec</span> //&#x63D0;&#x4EA4;&#x4E8B;&#x52A1;&#xFF0C;&#x6B64;&#x65F6;&#x4F1A;&#x4F9D;&#x6B21;&#x6267;&#x884C;&#x961F;&#x5217;&#x91CC;&#x7684;&#x547D;&#x4EE4;&#xFF0C;&#x5E76;&#x4F9D;&#x6B21;&#x8FD4;&#x56DE;&#x7ED3;&#x679C;
</code></pre>
<h2 id="&#x4E8B;&#x52A1;&#x5B9E;&#x73B0;&#x539F;&#x7406;"><a name="&#x4E8B;&#x52A1;&#x5B9E;&#x73B0;&#x539F;&#x7406;" class="anchor-navigation-ex-anchor" href="#&#x4E8B;&#x52A1;&#x5B9E;&#x73B0;&#x539F;&#x7406;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x4E8B;&#x52A1;&#x5B9E;&#x73B0;&#x539F;&#x7406;</h2>
<p>redis&#x4E8B;&#x52A1;&#x7684;&#x7ED3;&#x6784;&#x7B80;&#x56FE;</p>
<p><img src="redisImg/redis&#x4E8B;&#x52A1;.jpg" alt="redis&#x4E8B;&#x52A1;"></p>
<p>redis&#x6BCF;&#x4E2A;&#x5BA2;&#x6237;&#x7AEF;&#x90FD;&#x6709;&#x8BB0;&#x5F55;&#x5F53;&#x524D;&#x4E8B;&#x52A1;&#x72B6;&#x6001;&#x7684;multState</p>
<p>&#x4E00;&#x4E2A;&#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x5B9A;&#x4E49;&#xFF1A;</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">client</span> <span class="token punctuation">{</span>
    <span class="token class-name">uint64_t</span> id<span class="token punctuation">;</span><span class="token comment">//&#x5BA2;&#x6237;&#x7AEF;&#x552F;&#x4E00; id</span>
    multiState mstate<span class="token punctuation">;</span> <span class="token comment">//MULTI &#x548C; EXEC &#x72B6;&#x6001;(&#x5373;&#x4E8B;&#x52A1;&#x72B6;&#x6001;)</span>
    <span class="token comment">//...&#x7701;&#x7565;&#x5176;&#x4ED6;&#x5C5E;&#x6027;</span>
<span class="token punctuation">}</span> client<span class="token punctuation">;</span>
</code></pre>
<p>multiState&#x5B9A;&#x4E49;&#xFF1A;</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">multiState</span> <span class="token punctuation">{</span>
    multiCmd <span class="token operator">*</span>commands<span class="token punctuation">;</span><span class="token comment">//&#x5B58;&#x50A8;&#x547D;&#x4EE4;&#x7684; FIFO &#x961F;&#x5217;</span>
    <span class="token keyword">int</span> count<span class="token punctuation">;</span><span class="token comment">//&#x547D;&#x4EE4;&#x603B;&#x6570;</span>
    <span class="token comment">//...&#x7701;&#x7565;&#x4E86;&#x5176;&#x4ED6;&#x5C5E;&#x6027;</span>
<span class="token punctuation">}</span> multiState<span class="token punctuation">;</span>
</code></pre>
<p>commands&#x662F;&#x4E00;&#x4E2A;&#x961F;&#x5217;&#xFF0C;&#x961F;&#x5217;&#x5143;&#x7D20;&#x90FD;&#x662F;multiCmd&#x5BF9;&#x8C61;&#xFF0C;</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">multiCmd</span> <span class="token punctuation">{</span>
    robj <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">;</span><span class="token comment">//&#x7528;&#x6765;&#x5B58;&#x50A8;&#x53C2;&#x6570;&#x7684;&#x6570;&#x7EC4;</span>
    <span class="token keyword">int</span> argc<span class="token punctuation">;</span><span class="token comment">//&#x53C2;&#x6570;&#x7684;&#x6570;&#x91CF;</span>
    <span class="token keyword">struct</span> <span class="token class-name">redisCommand</span> <span class="token operator">*</span>cmd<span class="token punctuation">;</span><span class="token comment">//&#x547D;&#x4EE4;&#x6307;&#x9488;</span>
<span class="token punctuation">}</span> multiCmd<span class="token punctuation">;</span>
</code></pre>
<h2 id="&#x4E8B;&#x52A1;&#x7684;acid&#x7279;&#x6027;"><a name="&#x4E8B;&#x52A1;&#x7684;acid&#x7279;&#x6027;" class="anchor-navigation-ex-anchor" href="#&#x4E8B;&#x52A1;&#x7684;acid&#x7279;&#x6027;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x4E8B;&#x52A1;&#x7684;acid&#x7279;&#x6027;</h2>
<p>&#x539F;&#x5B50;&#x6027;&#xFF1A;redis&#x4E2D;&#x6267;&#x884C;&#x4E8B;&#x52A1;&#x7684;&#x65F6;&#x5019;&#x67D0;&#x4E00;&#x4E2A;&#x547D;&#x4EE4;&#x5931;&#x8D25;&#x4E86;&#xFF0C;&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;&#x5176;&#x4ED6;&#x7684;&#x547D;&#x4EE4;&#xFF0C;&#x5373;redis&#x4E8B;&#x52A1;&#x4E0D;&#x4F1A;&#x56DE;&#x6EDA;</p>
<p>&#x4E00;&#x81F4;&#x6027;&#xFF1A;&#x4E00;&#x81F4;&#x6027;&#x6307;&#x7684;&#x662F;&#x4E8B;&#x52A1;&#x6267;&#x884C;&#x524D;&#x540E;&#x6570;&#x636E;&#x7B26;&#x5408;&#x6570;&#x636E;&#x5E93;&#x7684;&#x5B9A;&#x4E49;&#x548C;&#x8981;&#x6C42;&#xFF0C;Redis&#x6EE1;&#x8DB3;&#xFF0C;&#x8BED;&#x6CD5;&#x9519;&#x8BEF;&#x548C;&#x8FD0;&#x884C;&#x9519;&#x8BEF;&#x65F6;&#xFF0C;&#x547D;&#x4EE4;&#x5747;&#x4E0D;&#x4F1A;&#x88AB;&#x6267;&#x884C;</p>
<ul>
<li><p>&#x9694;&#x79BB;&#x6027;&#xFF1A;redis&#x5728;&#x6267;&#x884C;&#x4E8B;&#x52A1;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x8BF7;&#x6C42;&#x65E0;&#x6CD5;&#x88AB;&#x6267;&#x884C;&#xFF0C;&#x6EE1;&#x8DB3;&#x4E86;&#x9694;&#x79BB;&#x6027;&#x7684;&#x8981;&#x6C42;</p>
</li>
<li><p>&#x6301;&#x4E45;&#x6027;&#xFF1A;&#x5F53;redis&#x5F00;&#x542F;&#x4E86;&#x6301;&#x4E45;&#x5316;&#x540E;&#xFF0C;&#x6EE1;&#x8DB3;&#x6301;&#x4E45;&#x6027;</p>
</li>
</ul>
<h2 id="watch"><a name="watch" class="anchor-navigation-ex-anchor" href="#watch"><i class="fa fa-link" aria-hidden="true"></i></a>watch</h2>
<p>&#x5F53;&#x4E00;&#x4E2A;&#x4E8B;&#x52A1;&#x5F00;&#x542F;&#x4F46;&#x672A;&#x6267;&#x884C;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x5BA2;&#x6237;&#x7AEF;&#x53D1;&#x51FA;&#x4E86;&#x4FEE;&#x6539;&#x503C;&#x7684;&#x547D;&#x4EE4;&#xFF0C;&#x4F1A;&#x9020;&#x6210;&#x6570;&#x636E;&#x975E;&#x9884;&#x671F;&#x6216;&#x8986;&#x76D6;&#x6709;&#x6548;&#x503C;&#x7684;&#x95EE;&#x9898;
watch&#x547D;&#x4EE4;&#x53EF;&#x4EE5;&#x4E3A;Redis&#x4E8B;&#x52A1;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x4E50;&#x89C2;&#x9501;&#x7684;&#x884C;&#x4E3A;&#xFF0C;&#x5728;exec&#x547D;&#x4EE4;&#x6267;&#x884C;&#x524D;&#x76D1;&#x89C6;key&#x7684;&#x53D8;&#x5316;&#xFF0C;&#x5F53;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x66F4;&#x65B0;&#x540C;&#x4E00;&#x4E2A;key&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F1A;&#x8DDF;&#x539F;&#x503C;&#x505A;&#x6BD4;&#x8F83;&#xFF0C;&#x4E00;&#x65E6;&#x53D1;&#x73B0;&#x4FEE;&#x6539;&#x8FC7;&#xFF0C;&#x5219;&#x62D2;&#x7EDD;&#x6267;&#x884C;&#x547D;&#x4EE4;&#xFF0C;&#x5E76;&#x4F1A;&#x8FD4;&#x56DE;nil</p>
<p>&#x793A;&#x4F8B;&#xFF1A;</p>
<p>&#x5F00;&#x542F;&#x4E00;&#x4E2A;&#x5BA2;&#x6237;&#x7AEF;&#x6267;&#x884C;</p>
<pre class="language-"><code class="lang-bash">flushall  //&#x6E05;&#x7A7A;&#x6570;&#x636E;&#x5E93;
<span class="token function">watch</span> name //&#x76D1;&#x89C6; name
multi     //&#x5F00;&#x542F;&#x4E8B;&#x52A1;
<span class="token builtin class-name">set</span> name lonely_wolf //&#x8BBE;&#x7F6E; name
<span class="token builtin class-name">set</span> age <span class="token number">18</span> // &#x8BBE;&#x7F6E; age
get name   //&#x83B7;&#x53D6; name
get age    //&#x83B7;&#x53D6; age
</code></pre>
<p>&#x5F00;&#x542F;&#x7B2C;&#x4E8C;&#x4E2A;&#x5BA2;&#x6237;&#x7AEF;&#x6267;&#x884C;</p>
<pre class="language-"><code class="lang-bash"><span class="token builtin class-name">set</span> name zhangsan
</code></pre>
<p>&#x5728;&#x7B2C;&#x4E00;&#x4E2A;&#x5BA2;&#x6237;&#x7AEF;&#x6267;&#x884C;exec&#xFF0C;&#x4F1A;&#x8FD4;&#x56DE;nil&#xFF0C;&#x6574;&#x4E2A;&#x4E8B;&#x52A1;&#x90FD;&#x4E0D;&#x4F1A;&#x88AB;&#x6267;&#x884C;</p>
<p>&#x539F;&#x7406;&#xFF1A;redisDB&#x4E2D;&#x6709;&#x4E00;&#x4E2A;watched_keys&#xFF0C;&#x7C7B;&#x578B;&#x4E3A;dict&#xFF0C;&#x5B57;&#x5178;&#x7684;&#x952E;&#x4E3A;&#x88AB;&#x4E0A;&#x9501;&#x7684;key&#xFF0C;&#x5B57;&#x5178;&#x7684;&#x503C;&#x4E3A;&#x5BA2;&#x6237;&#x7AEF;&#x7684;id&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x4E2D;&#x8FD8;&#x6709;&#x4E2A;CLIENT_DIRTY_CAS&#x5C5E;&#x6027;&#xFF0C;&#x5F53;&#x952E;&#x6267;&#x884C;&#x4E86;set&#xFF0C;sadd&#x7B49;&#x80FD;&#x4FEE;&#x6539;key&#x503C;&#x5BF9;&#x5E94;&#x7684;value&#x65F6;&#xFF0C;&#x904D;&#x5386;watched_keys&#xFF0C;&#x5C06;&#x952E;&#x4E0A;&#x9501;&#x7684;&#x5BA2;&#x6237;&#x7AEF;&#x4E2D;&#x7684;CLIENT_DIRTY_CAS&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#xFF0C;&#x63D0;&#x4EA4;&#x4E8B;&#x52A1;&#x7684;&#x65F6;&#x5019;&#x53D1;&#x73B0;CLIENT_DIRTY_CAS&#x88AB;&#x4FEE;&#x6539;&#x8FC7;&#x5219;&#x4F1A;&#x62D2;&#x7EDD;&#x6267;&#x884C;&#x4E8B;&#x52A1;&#x3002;</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">redisDb</span> <span class="token punctuation">{</span>
    dict <span class="token operator">*</span>watched_keys<span class="token punctuation">;</span>  <span class="token comment">//&#x88AB; watch &#x547D;&#x4EE4;&#x76D1;&#x89C6;&#x7684; key</span>
    <span class="token keyword">int</span> id<span class="token punctuation">;</span>           <span class="token comment">//Database ID</span>
    <span class="token comment">//...&#x7701;&#x7565;&#x4E86;&#x5176;&#x4ED6;&#x5C5E;&#x6027;</span>
<span class="token punctuation">}</span> redisDb<span class="token punctuation">;</span>
</code></pre>
<h1 id="redis&#x96C6;&#x7FA4;"><a name="redis&#x96C6;&#x7FA4;" class="anchor-navigation-ex-anchor" href="#redis&#x96C6;&#x7FA4;"><i class="fa fa-link" aria-hidden="true"></i></a>redis&#x96C6;&#x7FA4;</h1>
<h2 id="&#x96C6;&#x7FA4;&#x7B80;&#x4ECB;"><a name="&#x96C6;&#x7FA4;&#x7B80;&#x4ECB;" class="anchor-navigation-ex-anchor" href="#&#x96C6;&#x7FA4;&#x7B80;&#x4ECB;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x96C6;&#x7FA4;&#x7B80;&#x4ECB;</h2>
<p>redis&#x652F;&#x6301;&#x7684;&#x96C6;&#x7FA4;&#x65B9;&#x6848;&#xFF1A;</p>
<ul>
<li>&#x4E3B;&#x4ECE;&#x590D;&#x5236;&#x96C6;&#x7FA4;&#xFF08;master-slave&#xFF09;</li>
<li>&#x57FA;&#x4E8E;&#x54E8;&#x5175;&#x673A;&#x5236;&#x5B9E;&#x73B0;&#x9AD8;&#x53EF;&#x7528;&#x96C6;&#x7FA4;</li>
<li>Redis Cluster&#x5206;&#x5E03;&#x5F0F;&#x96C6;&#x7FA4;</li>
</ul>
<h2 id="&#x4E3B;&#x4ECE;&#x590D;&#x5236;"><a name="&#x4E3B;&#x4ECE;&#x590D;&#x5236;" class="anchor-navigation-ex-anchor" href="#&#x4E3B;&#x4ECE;&#x590D;&#x5236;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x4E3B;&#x4ECE;&#x590D;&#x5236;</h2>
<p>&#x4E3B;&#x5E93;&#x7528;&#x6765;&#x8BFB;&#x5199;&#xFF0C;&#x4ECE;&#x5E93;&#x7528;&#x6765;&#x8BFB;&#xFF0C;&#x4E3B;&#x4ECE;&#x5E93;&#x4E4B;&#x524D;&#x6570;&#x636E;&#x4FDD;&#x6301;&#x540C;&#x6B65;</p>
<h3 id="&#x914D;&#x7F6E;&#x4E3B;&#x4ECE;&#x590D;&#x5236;"><a name="&#x914D;&#x7F6E;&#x4E3B;&#x4ECE;&#x590D;&#x5236;" class="anchor-navigation-ex-anchor" href="#&#x914D;&#x7F6E;&#x4E3B;&#x4ECE;&#x590D;&#x5236;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x914D;&#x7F6E;&#x4E3B;&#x4ECE;&#x590D;&#x5236;</h3>
<p>&#x914D;&#x7F6E;&#x4E00;&#x4E3B;&#x4E24;&#x4ECE;master-slave&#x96C6;&#x7FA4;</p>
<p>&#x5728;&#x4E3B;&#x673A;redis-cli&#x547D;&#x4EE4;&#x884C;&#x4E2D;&#x6267;&#x884C;<code>replicaof no one</code>&#xFF0C;&#x6210;&#x4E3A;&#x4E00;&#x4E2A;&#x4E3B;&#x8282;&#x70B9;</p>
<p>&#x5728;&#x4ECE;&#x673A;&#x7684;redis-cli&#x547D;&#x4EE4;&#x884C;&#x4E2D;&#x6267;&#x884C;<code>replicaof &#x4E3B;&#x673A;ip &#x4E3B;&#x673A;&#x7AEF;&#x53E3;</code>&#xFF0C;&#x6210;&#x4E3A;&#x4E00;&#x4E2A;&#x4ECE;&#x8282;&#x70B9;</p>
<p><code>info replication</code> - &#x67E5;&#x770B;&#x4E3B;&#x4ECE;&#x673A;&#x7684;&#x72B6;&#x6001;</p>
<p>&#x5728;&#x542F;&#x52A8;redis-server&#x7684;&#x65F6;&#x5019;&#x4E5F;&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x4E3B;&#x4ECE;&#x673A; <code>redis-server --replicaof ip port</code></p>
<p>&#x9ED8;&#x8BA4;&#x4ECE;&#x673A;&#x4E3A;&#x53EA;&#x8BFB;&#xFF0C;&#x4FEE;&#x6539;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#x7684;<code>replica-read-only</code>&#x6765;&#x51B3;&#x5B9A;&#x4ECE;&#x673A;&#x662F;&#x5426;&#x53EA;&#x8BFB;</p>
<p>&#x6CE8;&#x610F;&#xFF1A;replicaof&#x548C;slaveof&#x4E3A;&#x540C;&#x4E00;&#x542B;&#x4E49;&#xFF0C;slaveof&#x5728;&#x5916;&#x56FD;&#x6709;&#x5974;&#x96B6;&#x7684;&#x610F;&#x601D;&#xFF0C;&#x6700;&#x540E;&#x8FDB;&#x884C;&#x4E86;&#x6539;&#x540D;&#x3002;</p>
<h3 id="&#x4E3B;&#x4ECE;&#x590D;&#x5236;&#x539F;&#x7406;"><a name="&#x4E3B;&#x4ECE;&#x590D;&#x5236;&#x539F;&#x7406;" class="anchor-navigation-ex-anchor" href="#&#x4E3B;&#x4ECE;&#x590D;&#x5236;&#x539F;&#x7406;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x4E3B;&#x4ECE;&#x590D;&#x5236;&#x539F;&#x7406;</h3>
<p>&#x5EFA;&#x7ACB;&#x8FDE;&#x63A5;&#xFF1A;</p>
<ol>
<li>&#x6267;&#x884C;replicaof&#x547D;&#x4EE4;&#x65F6;&#xFF0C;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x4F1A;&#x5C06;&#x672C;&#x5730;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#x7684;&#x4E00;&#x4E9B;&#x4FE1;&#x606F;&#xFF08;ip&#x548C;&#x7AEF;&#x53E3;&#x7B49;&#xFF09;&#x4FDD;&#x6301;&#x5728;redisServer&#x4E2D;</li>
<li>&#x521B;&#x5EFA;&#x548C;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#x7684;&#x8FDE;&#x63A5;&#xFF0C;&#x521B;&#x5EFA;&#x8FDE;&#x63A5;&#x540E;&#xFF0C;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x76F8;&#x5F53;&#x4E8E;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#x7684;&#x4E00;&#x4E2A;&#x5BA2;&#x6237;&#x7AEF;</li>
<li>&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x5411;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#x53D1;&#x9001;ping&#x547D;&#x4EE4;&#xFF0C;&#x786E;&#x8BA4;&#x8FDE;&#x63A5;&#x662F;&#x5426;&#x53EF;&#x7528;&#xFF0C;&#x5982;&#x679C;&#x9700;&#x8981;&#x6388;&#x6743;&#xFF0C;&#x6B64;&#x5904;&#x9700;&#x8981;&#x6388;&#x6743;&#x8BA4;&#x8BC1;</li>
<li>&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x6536;&#x5230;pong&#x540E;&#xFF0C;&#x8868;&#x793A;&#x8FDE;&#x63A5;&#x53EF;&#x7528;&#xFF0C;&#x6B64;&#x65F6;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x4F1A;&#x5C06;&#x81EA;&#x5DF1;&#x7684;&#x7AEF;&#x53E3;&#x53F7;&#x53D1;&#x9001;&#x7ED9;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#x6536;&#x5230;&#x540E;&#x8BB0;&#x5F55;&#x5728;redisClient&#x4E2D;</li>
<li>&#x6CA1;&#x6709;&#x6536;&#x5230;pong&#x56DE;&#x590D;&#xFF0C;&#x5219;&#x5C1D;&#x8BD5;&#x91CD;&#x65B0;&#x8FDE;&#x63A5;</li>
</ol>
<p>&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x4E0E;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#x5EFA;&#x7ACB;&#x8FDE;&#x63A5;&#x540E;&#xFF0C;&#x9996;&#x6B21;&#x9700;&#x8981;&#x5168;&#x91CF;&#x540C;&#x6B65;</p>
<p>&#x5168;&#x91CF;&#x540C;&#x6B65;&#xFF1A;</p>
<ol>
<li>&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x5411;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#x53D1;&#x9001;&#x540C;&#x6B65;&#x6570;&#x636E;&#x7684;&#x547D;&#x4EE4;</li>
<li>&#x4E3B;&#x670D;&#x52A1;&#x5668;&#x6536;&#x5230;&#x547D;&#x4EE4;&#x540E;&#xFF0C;&#x6267;&#x884C;bgsave&#x547D;&#x4EE4;&#xFF0C;&#x751F;&#x6210;&#x4E00;&#x4E2A;RDB&#x6587;&#x4EF6;&#x3002;&#x5E76;&#x53D1;&#x9001;&#x7ED9;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x3002;&#x6B64;&#x65F6;&#x6709;&#x65B0;&#x7684;&#x547D;&#x4EE4;&#x8FDB;&#x6765;&#x4F1A;&#x8BB0;&#x5F55;&#x5728;&#x7F13;&#x51B2;&#x533A;&#x5185;</li>
<li>&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x6536;&#x6587;&#x4EF6;&#x540E;&#xFF0C;&#x5148;&#x6E05;&#x9664;&#x81EA;&#x5DF1;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x7136;&#x540E;&#x8F7D;&#x5165;RDB&#x6587;&#x4EF6;&#x6570;&#x636E;</li>
<li>&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x6267;&#x884C;&#x5B8C;RDB&#x6587;&#x4EF6;&#x540E;&#xFF0C;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#x4F1A;&#x5C06;&#x7F13;&#x51B2;&#x533A;&#x7684;&#x547D;&#x4EE4;&#x53D1;&#x9001;&#x7ED9;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x518D;&#x4F9D;&#x6B21;&#x6267;&#x884C;</li>
</ol>
<p>&#x9996;&#x6B21;&#x5168;&#x91CF;&#x540C;&#x6B65;&#x5B8C;&#x6210;&#x540E;&#xFF0C;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#x4F1A;&#x5C06;&#x81EA;&#x5DF1;&#x6536;&#x5230;&#x7684;&#x4FEE;&#x6539;&#x6570;&#x636E;&#x7684;&#x547D;&#x4EE4;&#x53D1;&#x9001;&#x7ED9;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x3002;&#x8FD9;&#x4E2A;&#x8FC7;&#x7A0B;&#x6709;&#x5EF6;&#x8FDF;&#xFF0C;&#x914D;&#x7F6E;&#x4E2D; <code>repl-disable-tcp-nodelay</code> &#x9ED8;&#x8BA4;&#x4E3A;no&#xFF0C;&#x8868;&#x793A;&#x6BCF;&#x6267;&#x884C;&#x4E00;&#x6761;&#x547D;&#x4EE4;&#x90FD;&#x7ACB;&#x523B;&#x540C;&#x6B65;&#x7ED9;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x3002;&#x5F53;&#x6539;&#x4E3A;yes&#x65F6;&#xFF0C;&#x4F1A;&#x5408;&#x5E76;&#x6570;&#x636E;&#x5305;&#x53D1;&#x9001;&#xFF0C;&#x964D;&#x4F4E;&#x53D1;&#x9001;&#x9891;&#x7387;</p>
<p>&#x670D;&#x52A1;&#x5668;&#x91CD;&#x542F;&#x540E;&#x901A;&#x5E38;&#x4F1A;&#x4F7F;&#x7528;&#x90E8;&#x5206;&#x91CD;&#x540C;&#x6B65;&#xFF1A;</p>
<ul>
<li>&#x4E3B;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x5404;&#x81EA;&#x4F1A;&#x7EF4;&#x62A4;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x590D;&#x5236;&#x7684;&#x504F;&#x79FB;&#x91CF;&#xFF0C;&#x8FD9;&#x4E2A;&#x504F;&#x79FB;&#x91CF;&#x8868;&#x793A;&#x7684;&#x53D1;&#x9001;&#x547D;&#x4EE4;&#x7684;&#x5B57;&#x8282;&#x6570;&#xFF0C;</li>
<li>&#x5F53;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x6062;&#x590D;&#x548C;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#x7684;&#x8FDE;&#x63A5;&#x65F6;&#xFF0C;&#x4F1A;&#x53D1;&#x9001;&#x540C;&#x6B65;&#x547D;&#x4EE4;&#xFF0C;&#x5E76;&#x5E26;&#x4E0A;&#x504F;&#x79FB;&#x91CF;&#xFF0C;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#x6839;&#x636E;&#x504F;&#x79FB;&#x91CF;&#x8FDB;&#x884C;&#x90E8;&#x5206;&#x540C;&#x6B65;</li>
<li>&#x4F7F;&#x7528;&#x90E8;&#x5206;&#x91CD;&#x540C;&#x6B65;&#xFF0C;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#x9700;&#x8981;&#x4FDD;&#x6301;&#x5386;&#x53F2;&#x547D;&#x4EE4;&#x3002;master&#x7EF4;&#x62A4;&#x4E86;&#x4E00;&#x4E2A;&#x56FA;&#x5B9A;&#x957F;&#x5EA6;&#x7684;FIFO&#x961F;&#x5217;&#xFF0C;&#x6210;&#x4E3A;&#x590D;&#x5236;&#x79EF;&#x538B;&#x7F13;&#x51B2;&#x533A;&#x3002;&#x9ED8;&#x8BA4;&#x5927;&#x5C0F;&#x4E3A;1MB</li>
<li>&#x5F53;&#x590D;&#x5236;&#x504F;&#x79FB;&#x91CF;+1&#xFF08;&#x56E0;&#x4E3A;&#x4F20;&#x7ED9;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#x4E3A;100&#xFF0C;&#x8FD4;&#x56DE;&#x6570;&#x636E;&#x5E94;&#x8BE5;&#x4ECE;101&#x5F00;&#x59CB;&#xFF09;&#x4E0D;&#x518D;&#x590D;&#x5236;&#x79EF;&#x538B;&#x7F13;&#x51B2;&#x533A;&#x65F6;&#xFF0C;&#x5C31;&#x6267;&#x884C;&#x5168;&#x91CF;&#x540C;&#x6B65;</li>
</ul>
<h3 id="&#x4E3B;&#x4ECE;&#x670D;&#x52A1;&#x7684;&#x95EE;&#x9898;"><a name="&#x4E3B;&#x4ECE;&#x670D;&#x52A1;&#x7684;&#x95EE;&#x9898;" class="anchor-navigation-ex-anchor" href="#&#x4E3B;&#x4ECE;&#x670D;&#x52A1;&#x7684;&#x95EE;&#x9898;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x4E3B;&#x4ECE;&#x670D;&#x52A1;&#x7684;&#x95EE;&#x9898;</h3>
<ul>
<li>&#x9996;&#x6B21;&#x540C;&#x6B65;&#x5982;&#x679C;&#x6570;&#x636E;&#x91CF;&#x5F88;&#x5927;&#xFF0C;&#x4F1A;&#x975E;&#x5E38;&#x8017;&#x65F6;</li>
<li>&#x5982;&#x679C;master&#x5B95;&#x673A;&#x4E86;&#xFF0C;&#x9700;&#x8981;&#x8BA4;&#x4E3A;&#x5207;&#x6362;master&#x670D;&#x52A1;&#x5668;</li>
</ul>
<h2 id="sentinel-&#x54E8;&#x5175;&#x673A;&#x5236;"><a name="sentinel-&#x54E8;&#x5175;&#x673A;&#x5236;" class="anchor-navigation-ex-anchor" href="#sentinel-&#x54E8;&#x5175;&#x673A;&#x5236;"><i class="fa fa-link" aria-hidden="true"></i></a>Sentinel &#x54E8;&#x5175;&#x673A;&#x5236;</h2>
<ul>
<li>Sentinel&#x670D;&#x52A1;&#x672C;&#x8EAB;&#x662F;&#x4E00;&#x4E2A;&#x7279;&#x6B8A;&#x7684;redis&#x670D;&#x52A1;&#xFF0C;&#x901A;&#x8FC7;sentinel.conf&#x6587;&#x4EF6;&#x914D;&#x7F6E;</li>
<li>Sentinel&#x673A;&#x5236;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x4E3B;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x7684;&#x81EA;&#x52A8;&#x5207;&#x6362;</li>
<li>Sentinel&#x7528;&#x6765;&#x76D1;&#x63A7;redis&#x96C6;&#x7FA4;&#x7684;&#x6240;&#x6709;&#x8282;&#x70B9;&#xFF0C;&#x5F53;master&#x4E0D;&#x53EF;&#x7528;&#x65F6;&#xFF0C;&#x4F1A;&#x4ECE;&#x6240;&#x6709;&#x7684;slave&#x4E2D;&#x9009;&#x51FA;&#x4E00;&#x4E2A;&#x8282;&#x70B9;&#x5347;&#x7EA7;&#x4E3A;master&#xFF0C;&#x5373;&#x81EA;&#x52A8;&#x5207;&#x6362;</li>
<li>Sentinel&#x672C;&#x8EAB;&#x4E5F;&#x662F;&#x4E00;&#x4E2A;&#x96C6;&#x7FA4;&#xFF0C;&#x4F46;sentinel&#x96C6;&#x7FA4;&#x6CA1;&#x6709;&#x4E3B;&#x4ECE;&#x5173;&#x7CFB;&#xFF0C;&#x8282;&#x70B9;&#x4E4B;&#x95F4;&#x4E92;&#x76F8;&#x76D1;&#x63A7;&#xFF0C;master&#x5B95;&#x673A;&#x540E;&#x4F1A;&#x901A;&#x8FC7;sentinel&#x96C6;&#x7FA4;&#x9009;&#x4E3E;&#x4EA7;&#x751F;&#x65B0;&#x7684;master</li>
</ul>
<h3 id="&#x8FD0;&#x884C;&#x6D41;&#x7A0B;"><a name="&#x8FD0;&#x884C;&#x6D41;&#x7A0B;" class="anchor-navigation-ex-anchor" href="#&#x8FD0;&#x884C;&#x6D41;&#x7A0B;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x8FD0;&#x884C;&#x6D41;&#x7A0B;</h3>
<ul>
<li>Sentinel&#x6BCF;&#x9694;1s&#x4F1A;&#x5411;redis&#x670D;&#x52A1;&#x5668;&#x8282;&#x70B9;&#x53D1;&#x9001;ping&#x547D;&#x4EE4;&#xFF0C;&#x5982;&#x679C;&#x5728;&#x6307;&#x5B9A;&#x65F6;&#x95F4;&#x5185;(down-after-milliseconds,&#x9ED8;&#x8BA4;30s)&#x6CA1;&#x6709;&#x6536;&#x5230;&#x6709;&#x6548;&#x56DE;&#x590D;&#xFF0C;&#x5219;Sentinel&#x4F1A;&#x628A;&#x8BE5;&#x670D;&#x52A1;&#x5668;&#x6807;&#x8BB0;&#x4E3A;&#x4E0B;&#x7EBF;&#xFF0C;&#x79F0;&#x4E3A;&#x4E3B;&#x89C2;&#x4E0B;&#x7EBF;&#x3002;</li>
<li>Sentinel&#x628A;master&#x6807;&#x8BB0;&#x4E3A;&#x4E3B;&#x89C2;&#x4E0B;&#x7EBF;&#x540E;&#xFF0C;&#x4F1A;&#x8BE2;&#x95EE;&#x5176;&#x4ED6;Sentinel&#xFF0C;&#x5F53;&#x8FBE;&#x5230;&#x4E00;&#x5B9A;&#x6570;&#x91CF;&#xFF08;<code>sentinel monitor <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>master-name</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ip</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>redis-port</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>quorum</span><span class="token punctuation">&gt;</span></span></code>, quorum&#x5C31;&#x662F;&#x5224;&#x65AD;&#x5BA2;&#x89C2;&#x4E0B;&#x7EBF;&#x7684;&#x6570;&#x91CF;&#xFF09;&#x7684;Sentinel&#x8BA4;&#x4E3A;&#x8BE5;master&#x4E0B;&#x7EBF;&#x540E;&#xFF0C;&#x9996;&#x5148;&#x53D1;&#x73B0;&#x8282;&#x70B9;&#x4E0B;&#x7EBF;&#x5F53;Sentinel&#x4F1A;&#x628A;master&#x6807;&#x8BB0;&#x4E3A;&#x5BA2;&#x89C2;&#x4E0B;&#x7EBF;&#xFF0C;&#x5E76;&#x53D1;&#x8D77;Leader&#x9009;&#x4E3E;&#xFF0C;&#x6700;&#x540E;&#x7531;Leader&#x6267;&#x884C;&#x6545;&#x969C;&#x8F6C;&#x79FB;&#x64CD;&#x4F5C;</li>
<li>&#x4E0D;&#x540C;&#x7684;Sentinel&#x914D;&#x7F6E;&#x7684;&#x4E0B;&#x7EBF;&#x6761;&#x4EF6;&#x53EF;&#x80FD;&#x4E0D;&#x4E00;&#x6837;&#x3002;&#x4F46;&#x53EA;&#x8981;&#x6709;&#x4E00;&#x4E2A;Sentinel&#x8BA4;&#x4E3A;master&#x5BA2;&#x89C2;&#x4E0B;&#x7EBF;&#xFF0C;&#x5C31;&#x4F1A;&#x51C6;&#x5907;&#x6267;&#x884C;&#x6545;&#x969C;&#x8F6C;&#x79FB;&#xFF0C;&#x6545;&#x969C;&#x8F6C;&#x79FB;&#x524D;&#x4E00;&#x5B9A;&#x4F1A;&#x8FDB;&#x884C;Leader&#x9009;&#x4E3E;</li>
<li>Leader&#x9009;&#x4E3E;&#x7B97;&#x6CD5;&#xFF1A;&#x57FA;&#x4E8E;Raft&#x7B97;&#x6CD5;&#x7684;&#x4FEE;&#x6539;&#xFF0C;Raft&#x7684;&#x539F;&#x59CB;&#x7B97;&#x6CD5;&#x89C1;&#x4E0B;&#x6587;&#xFF0C;&#x5177;&#x4F53;&#x4FEE;&#x6539;&#x9879;&#x4E3A;&#xFF1A;<ul>
<li>&#x89E6;&#x53D1;&#x9009;&#x4E3E;&#x662F;&#x7531;&#x8C01;&#x5148;&#x53D1;&#x73B0;master&#x4E0B;&#x7EBF;&#x6765;&#x51B3;&#x5B9A;&#x7684;</li>
<li>Sentinel&#x8282;&#x70B9;&#x6CA1;&#x6709;&#x7EF4;&#x62A4;election timeout&#xFF0C;&#x800C;&#x662F;&#x7EF4;&#x62A4;&#x6765;&#x4E00;&#x4E2A;&#x914D;&#x7F6E;&#x7EAA;&#x5143;&#x5C5E;&#x6027;configuration epoch&#xFF0C;&#x914D;&#x7F6E;&#x7EAA;&#x5143;&#x662F;&#x4E00;&#x4E2A;&#x8BA1;&#x6570;&#x5668;&#xFF08;&#x9ED8;&#x8BA4;&#x4E3A;0&#xFF09;&#xFF0C;&#x6BCF;&#x4E2A;&#x8282;&#x70B9;&#x540C;&#x4E00;&#x7EAA;&#x5143;&#x53EA;&#x80FD;&#x6295;&#x4E00;&#x6B21;&#x7968;&#xFF0C;&#x6BCF;&#x6B21;&#x6295;&#x7968;&#x524D;&#x914D;&#x7F6E;&#x7EAA;&#x5143;&#x4F1A;&#x81EA;&#x589E;1</li>
<li>&#x9009;&#x4E3E;&#x51FA;Leader&#x540E;&#xFF0C;&#x4E0D;&#x4F1A;&#x901A;&#x77E5;&#x5176;&#x4ED6;Follow&#x81EA;&#x5DF1;&#x6210;&#x4E3A;&#x6765;Leader&#xFF1B;&#x5F53;Leader&#x8282;&#x70B9;&#x9009;&#x51FA;&#x65B0;&#x7684;master&#xFF0C;&#x5176;&#x4ED6;Sentinel&#x670D;&#x52A1;&#x68C0;&#x6D4B;&#x5230;&#x65B0;&#x7684;master&#x4E0A;&#x7EBF;&#x4E4B;&#x540E;&#x5C31;&#x4F1A;&#x5220;&#x9664;&#x81EA;&#x5DF1;&#x7684;&#x4E3B;&#x89C2;&#x4E0B;&#x7EBF;&#x6807;&#x8BB0;&#x3002;</li>
</ul>
</li>
<li>Leader&#x9009;&#x51FA;&#x65B0;&#x7684;master<ul>
<li>&#x65AD;&#x5F00;&#x8FDE;&#x63A5;&#x65F6;&#x957F;&#xFF1A;&#x9996;&#x5148;&#x5C06;&#x6240;&#x6709;&#x4E8E;&#x5DF2;&#x4E0B;&#x7EBF;master&#x8282;&#x70B9;&#x65AD;&#x5F00;&#x8FDE;&#x63A5;&#x65F6;&#x95F4;&#x8D85;&#x8FC7;down-after-milliseconds*10&#x7684;slave&#x8282;&#x70B9;&#x5220;&#x9664;&#x6389;&#xFF0C;&#x786E;&#x4FDD;slave&#x8282;&#x70B9;&#x7684;&#x6570;&#x636E;&#x90FD;&#x662F;&#x6BD4;&#x8F83;&#x65B0;&#x7684;&#x3002;</li>
<li>slave &#x8282;&#x70B9;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x6392;&#x5E8F;&#xFF1A;&#x5C06;&#x6240;&#x6709;&#x7684; slave &#x8282;&#x70B9;&#x6309;&#x7167;&#x4F18;&#x5148;&#x7EA7;&#x8FDB;&#x884C;&#x6392;&#x5E8F;&#xFF0C;&#x9009;&#x51FA;&#x4F18;&#x5148;&#x7EA7;&#x6700;&#x9AD8;&#x7684; slave &#x8282;&#x70B9;&#x4F5C;&#x4E3A;&#x65B0;&#x7684; master &#x8282;&#x70B9;&#xFF08;&#x4F18;&#x5148;&#x7EA7;&#x7531;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x53C2;&#x6570; replica-priority &#x51B3;&#x5B9A;&#xFF0C;&#x9ED8;&#x8BA4; 100&#xFF09;&#x3002;</li>
<li>&#x590D;&#x5236;&#x504F;&#x79FB;&#x91CF;&#xFF1A;&#x5982;&#x679C;&#x6709;&#x591A;&#x4E2A;&#x4F18;&#x5148;&#x7EA7;&#x76F8;&#x540C;&#x7684; slave &#x8282;&#x70B9;&#xFF0C;&#x5219;&#x9009;&#x51FA;&#x590D;&#x5236;&#x504F;&#x79FB;&#x91CF;&#x6700;&#x5927;&#x7684; slave &#x8282;&#x70B9;&#x3002;</li>
<li>&#x8FDB;&#x7A0B; id&#xFF1A;&#x5982;&#x679C;&#x8FD8;&#x662F;&#x6CA1;&#x9009;&#x51FA;&#x65B0;&#x7684; master &#x8282;&#x70B9;&#xFF0C;&#x90A3;&#x4E48;&#x4F1A;&#x518D;&#x6B21;&#x9009;&#x62E9;&#x8FDB;&#x7A0B; id &#x6700;&#x5C0F;&#x7684; slave &#x8282;&#x70B9;&#x4F5C;&#x4E3A;&#x65B0;&#x7684; master&#x8282;&#x70B9;&#x3002;</li>
</ul>
</li>
<li>Leader&#x6267;&#x884C;&#x6545;&#x969C;&#x8F6C;&#x79FB;<ul>
<li>&#x5728;slave&#x670D;&#x52A1;&#x5668;&#x5217;&#x8868;&#x4E2D;&#x627E;&#x4E00;&#x4E2A;&#x5408;&#x683C;&#x7684;slave&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x5411;&#x5176;&#x53D1;&#x9001; <code>replicaof no one</code> &#x7684;&#x547D;&#x4EE4;&#xFF0C;&#x4F7F;&#x5176;&#x53D8;&#x4E3A;master</li>
<li>&#x5411;&#x5176;&#x5B83;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x53D1;&#x9001; <code>replicaof ip port</code> &#x547D;&#x4EE4;&#xFF08;ip&#x548C;port&#x4E3A;&#x65B0;master&#x5730;&#x5740;&#xFF09;&#xFF0C;&#x4F7F;&#x5176;&#x6210;&#x4E3A;&#x65B0;master&#x670D;&#x52A1;&#x7684;slave&#x8282;&#x70B9;&#x3002;</li>
<li>&#x5C06;&#x5DF2;&#x4E0B;&#x7EBF;&#x7684;master&#x670D;&#x52A1;&#x4E5F;&#x8BBE;&#x7F6E;&#x4E3A;&#x65B0;&#x7684;master&#x670D;&#x52A1;&#x7684;slave&#x8282;&#x70B9;&#xFF0C;&#x8FD9;&#x6837;&#x5F53;&#x65E7;master&#x6062;&#x590D;&#x4E4B;&#x540E;&#x80FD;&#x4EE5;slave&#x7684;&#x89D2;&#x8272;&#x7EE7;&#x7EED;&#x8FD0;&#x884C;&#x3002;</li>
</ul>
</li>
</ul>
<p>Raft&#x7B97;&#x6CD5;&#xFF1A;&#xFF08;&#x5C11;&#x6570;&#x670D;&#x4ECE;&#x591A;&#x6570;&#xFF0C;&#x5148;&#x5230;&#x5148;&#x5F97;&#xFF09;&#xFF0C;&#x6BCF;&#x4E2A;Sentinel&#x670D;&#x52A1;&#x90FD;&#x7EF4;&#x62A4;&#x4E86;&#x4E00;&#x4E2A;&#x968F;&#x673A;&#x65F6;&#x95F4;&#x5C5E;&#x6027;election timeout&#xFF0C;&#x8303;&#x56F4;&#x5728;150&#xFF5E;300ms&#x4E4B;&#x95F4;&#xFF0C;&#x54EA;&#x4E2A;&#x8282;&#x70B9;&#x5148;&#x5230;&#x8FD9;&#x4E2A;&#x65F6;&#x95F4;&#x5C31;&#x53EF;&#x4EE5;&#x53D1;&#x8D77;&#x9009;&#x4E3E;</p>
<ul>
<li>&#x53D1;&#x8D77;&#x9009;&#x4E3E;&#x7684;&#x670D;&#x52A1;&#x7ED9;&#x81EA;&#x5DF1;&#x6295;&#x4E00;&#x7968;</li>
<li>&#x53D1;&#x8D77;&#x9009;&#x4E3E;&#x7684;&#x8282;&#x70B9;&#x5411;&#x5176;&#x4ED6;&#x8282;&#x70B9;&#x53D1;&#x9001;&#x6295;&#x7968;&#x8BF7;&#x6C42;&#xFF0C;&#x5176;&#x4ED6;&#x8282;&#x70B9;&#x6536;&#x5230;&#x8BF7;&#x6C42;&#x540E;&#x5728;&#x540C;&#x4E00;&#x4E2A;election timeout&#x5185;&#x6CA1;&#x6709;&#x6295;&#x8FC7;&#x7968;&#xFF0C;&#x5C31;&#x4F1A;&#x4E2A;&#x53D1;&#x8D77;&#x9009;&#x4E3E;&#x7684;&#x8282;&#x70B9;&#x6295;&#x7968;&#xFF0C;&#x7136;&#x540E;&#x91CD;&#x7F6E;election timeout&#x3002;&#xFF08;&#x4E00;&#x4E2A;election timeout&#x533A;&#x95F4;&#x53EA;&#x80FD;&#x6295;&#x4E00;&#x6B21;&#x7968;&#xFF09;</li>
<li>&#x5982;&#x679C;&#x53D1;&#x8D77;&#x9009;&#x4E3E;&#x7684;&#x8282;&#x70B9;&#x83B7;&#x5F97;&#x7684;&#x7968;&#x6570;&#x8D85;&#x8FC7;&#x4E00;&#x534A;&#xFF0C;&#x90A3;&#x4E48;&#x5F53;&#x524D;&#x670D;&#x52A1;&#x5C31;&#x4F1A;&#x6210;&#x4E3A;Leader&#x8282;&#x70B9;&#xFF0C;&#x6210;&#x4E3A;Leader&#x8282;&#x70B9;&#x4E4B;&#x540E;&#x5C31;&#x4F1A;&#x7EF4;&#x62A4;&#x4E00;&#x4E2A;heartbeat timeout&#x65F6;&#x95F4;&#x5C5E;&#x6027;&#xFF08;&#x5373;&#xFF1A;&#x5FC3;&#x8DF3;&#x95F4;&#x9694;&#x65F6;&#x95F4;&#xFF09;&#xFF0C;&#x5728;&#x6BCF;&#x4E00;&#x6B21;&#x5230;&#x8FBE;heartbeat timeout&#x65F6;&#x95F4;&#x65F6;&#xFF0C;Leader&#x8282;&#x70B9;&#x5C31;&#x4F1A;&#x5411;&#x5176;&#x5B83;Follow&#x8282;&#x70B9;&#x53D1;&#x8D77;&#x4E00;&#x4E2A;&#x5FC3;&#x8DF3;&#x68C0;&#x6D4B;&#x3002;</li>
<li>Follow&#x8282;&#x70B9;&#x6536;&#x5230;Leader&#x8282;&#x70B9;&#x7684;&#x5FC3;&#x8DF3;&#x5305;&#x4E4B;&#x540E;&#x5C31;&#x4F1A;&#x5C06;election timeout&#x6E05;&#x7A7A;&#xFF0C;&#x8FD9;&#x6837;&#x53EF;&#x4EE5;&#x9632;&#x6B62;Follow&#x8282;&#x70B9;&#x56E0;&#x4E3A;&#x5230;&#x8FBE;election timeout&#x800C;&#x53D1;&#x8D77;&#x9009;&#x4E3E;&#x3002;</li>
<li>&#x5047;&#x5982;Leader&#x8282;&#x70B9;&#x6302;&#x4E86;&#xFF0C;&#x90A3;&#x4E48;Follow&#x8282;&#x70B9;&#x7684;election timeout&#x5C06;&#x4E0D;&#x4F1A;&#x88AB;&#x6E05;&#x7A7A;&#xFF0C;&#x8C01;&#x5148;&#x5230;&#x8FBE;&#xFF0C;&#x8C01;&#x5C31;&#x4F1A;&#x518D;&#x6B21;&#x53D1;&#x8D77;&#x9009;&#x4E3E;&#x3002;</li>
</ul>
<h3 id="&#x914D;&#x7F6E;&#x65B9;&#x6CD5;"><a name="&#x914D;&#x7F6E;&#x65B9;&#x6CD5;" class="anchor-navigation-ex-anchor" href="#&#x914D;&#x7F6E;&#x65B9;&#x6CD5;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x914D;&#x7F6E;&#x65B9;&#x6CD5;</h3>
<p>&#x4FEE;&#x6539;redis&#x76EE;&#x5F55;&#x4E0B;&#x7684;sentinel&#x914D;&#x7F6E;&#x6587;&#x4EF6;</p>
<pre class="language-"><code class="lang-bash">protected-mode no //&#x8868;&#x793A;&#x4E0D;&#x5F00;&#x542F;&#x5916;&#x7F51;&#x8BBF;&#x95EE;
daemonize <span class="token function">yes</span> //&#x8868;&#x793A;&#x540E;&#x53F0;&#x8FD0;&#x884C;
sentinel monitor mymaster <span class="token number">127.0</span>.0.1 <span class="token number">6379</span> <span class="token number">2</span>  //&#x76D1;&#x63A7;&#x7684;master&#x7684;&#x670D;&#x52A1;&#x540D;&#x79F0;&#xFF0C;mymaster &#x53EF;&#x4EE5;&#x4EFB;&#x610F;&#x8D77;&#x540D;&#xFF0C;&#x540E;&#x9762;&#x5C31;&#x662F;&#x4E3B;&#x8282;&#x70B9;&#x7684; <span class="token function">ip</span> &#x548C;&#x7AEF;&#x53E3;&#xFF0C;&#x6700;&#x540E;&#x7684; <span class="token number">2</span> &#x8868;&#x793A;&#x5F53;&#x524D;&#x6709; <span class="token number">2</span> &#x4E2A; sentinel &#x8BA4;&#x4E3A; master &#x4E3B;&#x89C2;&#x4E0B;&#x7EBF;&#xFF0C;&#x5219;&#x53EF;&#x4EE5;&#x4FEE;&#x6539;&#x4E3A;&#x5BA2;&#x89C2;&#x4E0B;&#x7EBF;
sentinel down-after-milliseconds mymaster <span class="token number">30000</span>  //master&#x4E0B;&#x7EBF;&#x591A;&#x5C11;&#x65F6;&#x95F4;&#x5224;&#x5B9A;&#x4E3A;&#x4E3B;&#x89C2;&#x4E0B;&#x7EBF;
sentinel parallel-syncs mymaster <span class="token number">1</span>  //&#x5207;&#x6362;&#x65B0;&#x7684; master-slave &#x65F6;&#xFF0C;slave &#x9700;&#x8981;&#x4ECE;&#x65B0;&#x7684; master &#x540C;&#x6B65;&#x6570;&#x636E;&#xFF0C;&#x8FD9;&#x4E2A;&#x6570;&#x5B57;&#x8868;&#x793A;&#x5141;&#x8BB8;&#x591A;&#x5C11;&#x4E2A; slave &#x540C;&#x65F6;&#x590D;&#x5236;&#x6570;&#x636E;
sentinel failover-timeout mymaster <span class="token number">180000</span>  //&#x6545;&#x969C;&#x8F6C;&#x79FB;&#x8D85;&#x65F6;&#x65F6;&#x95F4;
port <span class="token number">26379</span>  //sentinel&#x8FD0;&#x884C;&#x7684;&#x7AEF;&#x53E3;
pidfile /var/run/redis-sentinel-26379.pid  //pid&#x6587;&#x4EF6;&#x7684;&#x4FDD;&#x5B58;&#x76EE;&#x5F55;
logfile <span class="token string">&quot;/home/project/redis-5.0.5/sentinel.log&quot;</span> //logfile&#x65E5;&#x5FD7;&#x6587;&#x4EF6;&#x7684;&#x4FDD;&#x5B58;&#x76EE;&#x5F55;
<span class="token function">dir</span> <span class="token string">&quot;/home/project/redis-5.0.5&quot;</span> //sentinel&#x5DE5;&#x4F5C;&#x4E3B;&#x76EE;&#x5F55;
</code></pre>
<p>sentinel failover-timeout&#x8D85;&#x65F6;&#x65F6;&#x95F4;&#x6709;&#x8F83;&#x591A;&#x7528;&#x5904;</p>
<ul>
<li>&#x540C;&#x4E00;&#x4E2A;sentinel&#x5BF9;&#x540C;&#x4E00;&#x4E2A;master&#x4E24;&#x6B21;failover&#x4E4B;&#x95F4;&#x7684;&#x95F4;&#x9694;&#x65F6;&#x95F4;&#x3002;</li>
<li>&#x4ECE;&#x68C0;&#x6D4B;&#x5230;master&#x670D;&#x52A1;&#x5668;&#x6545;&#x969C;&#x5F00;&#x59CB;&#xFF0C;&#x5230;&#x88AB;&#x5F3A;&#x5236;&#x5207;&#x6362;&#x5230;&#x65B0;&#x7684;master&#x670D;&#x52A1;&#x5668;&#x5E76;&#x5F00;&#x59CB;&#x590D;&#x5236;&#x6570;&#x636E;&#x4E3A;&#x6B62;&#x7684;&#x65F6;&#x95F4;&#x3002;</li>
<li>&#x53D6;&#x6D88;&#x5DF2;&#x7ECF;&#x5728;&#x8FDB;&#x884C;&#x6545;&#x969C;&#x8F6C;&#x79FB;&#xFF08;&#x6CA1;&#x6709;&#x4EA7;&#x751F;&#x4EFB;&#x4F55;&#x914D;&#x7F6E;&#x66F4;&#x6539;&#x7684;&#x6545;&#x969C;&#x8F6C;&#x79FB;&#xFF09;&#x6240;&#x9700;&#x7684;&#x65F6;&#x95F4;&#x3002;</li>
<li>&#x5C06;&#x6240;&#x6709;slave&#x914D;&#x7F6E;&#x65B0;&#x7684;master&#x8282;&#x70B9;&#x6240;&#x9700;&#x8981;&#x7684;&#x65F6;&#x95F4;&#x3002;&#x8D85;&#x8FC7;&#x8FD9;&#x4E2A;&#x65F6;&#x95F4;&#x5982;&#x679C;&#x4ECD;&#x7136;&#x6CA1;&#x6709;&#x5B8C;&#x6210;&#x8FD8;&#x662F;&#x4F1A;&#x7EE7;&#x7EED;&#x8FDB;&#x884C;&#xFF0C;&#x4F46;&#x662F;&#x4E0D;&#x4E00;&#x5B9A;&#x4F1A;&#x6309;&#x7167;&#x914D;&#x7F6E;parallel-syncs&#x6240;&#x6307;&#x5B9A;&#x7684;&#x5E76;&#x884C;&#x6570;&#x6765;&#x8FDB;&#x884C;&#x3002;</li>
</ul>
<p>&#x542F;&#x52A8;Sentinel&#x670D;&#x52A1;&#xFF1A;</p>
<p><code>redis_work_dir/sentinel.conf --sentinel</code></p>
<h3 id="sentinel&#x54E8;&#x5175;&#x673A;&#x5236;&#x95EE;&#x9898;"><a name="sentinel&#x54E8;&#x5175;&#x673A;&#x5236;&#x95EE;&#x9898;" class="anchor-navigation-ex-anchor" href="#sentinel&#x54E8;&#x5175;&#x673A;&#x5236;&#x95EE;&#x9898;"><i class="fa fa-link" aria-hidden="true"></i></a>Sentinel&#x54E8;&#x5175;&#x673A;&#x5236;&#x95EE;&#x9898;</h3>
<ul>
<li>&#x4E3B;&#x4ECE;&#x5207;&#x6362;&#x5207;&#x6362;&#x8FC7;&#x7A0B;&#x6709;&#x7B49;&#x5F85;&#x671F;&#xFF0C;&#x5207;&#x6362;&#x8FC7;&#x7A0B;&#x670D;&#x52A1;&#x4E0D;&#x53EF;&#x7528;</li>
<li>&#x672C;&#x8D28;&#x8FD8;&#x662F;master-slave&#x96C6;&#x7FA4;&#xFF0C;&#x6CA1;&#x6709;&#x5B9E;&#x73B0;&#x6C34;&#x5E73;&#x6269;&#x5C55;</li>
</ul>
<h2 id="redis-cluster&#x5206;&#x5E03;&#x5F0F;&#x96C6;&#x7FA4;"><a name="redis-cluster&#x5206;&#x5E03;&#x5F0F;&#x96C6;&#x7FA4;" class="anchor-navigation-ex-anchor" href="#redis-cluster&#x5206;&#x5E03;&#x5F0F;&#x96C6;&#x7FA4;"><i class="fa fa-link" aria-hidden="true"></i></a>Redis Cluster&#x5206;&#x5E03;&#x5F0F;&#x96C6;&#x7FA4;</h2>
<h3 id="&#x5206;&#x5E03;&#x5F0F;&#x96C6;&#x7FA4;&#x7B80;&#x4ECB;"><a name="&#x5206;&#x5E03;&#x5F0F;&#x96C6;&#x7FA4;&#x7B80;&#x4ECB;" class="anchor-navigation-ex-anchor" href="#&#x5206;&#x5E03;&#x5F0F;&#x96C6;&#x7FA4;&#x7B80;&#x4ECB;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5206;&#x5E03;&#x5F0F;&#x96C6;&#x7FA4;&#x7B80;&#x4ECB;</h3>
<p>&#x5B9E;&#x73B0;&#x6C34;&#x5E73;&#x6269;&#x5C55;&#xFF0C;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x5206;&#x7247;&#x6765;&#x8FDB;&#x884C;&#x6570;&#x636E;&#x5171;&#x4EAB;&#xFF0C;&#x901A;&#x5E38;&#x6709;&#x4E09;&#x79CD;&#x601D;&#x8DEF;</p>
<ul>
<li>&#x5BA2;&#x6237;&#x7AEF;&#x5B9E;&#x73B0;&#x5206;&#x7247;&#x903B;&#x8F91;&#xFF0C;&#x51B3;&#x5B9A;&#x8DEF;&#x7531;&#x5230;&#x54EA;&#x53F0;&#x670D;&#x52A1;&#x5668;<ul>
<li>&#x9700;&#x8981;&#x5BA2;&#x6237;&#x7AEF;&#x652F;&#x6301;&#x5206;&#x7247;</li>
<li>&#x4E0D;&#x80FD;&#x5F88;&#x597D;&#x5B9E;&#x73B0;&#x670D;&#x52A1;&#x5668;&#x52A8;&#x6001;&#x589E;&#x51CF;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x9700;&#x8981;&#x83B7;&#x53D6;&#x6240;&#x6709;&#x670D;&#x52A1;&#x5668;&#x624D;&#x80FD;&#x5E73;&#x5747;&#x5206;&#x914D;</li>
</ul>
</li>
<li>&#x6DFB;&#x52A0;&#x4E00;&#x4E2A;&#x4E2D;&#x95F4;&#x670D;&#x52A1;&#x6765;&#x5904;&#x7406;&#x5206;&#x7247;&#x903B;&#x8F91;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x8FDE;&#x63A5;&#x4E2D;&#x95F4;&#x670D;&#x52A1;&#xFF0C;&#x518D;&#x8FDB;&#x884C;&#x8DEF;&#x7531;&#x5206;&#x53D1;<ul>
<li>&#x53C8;&#x6DFB;&#x52A0;&#x6765;&#x4E00;&#x4E2A;&#x4E2D;&#x95F4;&#x670D;&#x52A1;&#xFF0C;&#x4E3A;&#x4FDD;&#x8BC1;&#x4E2D;&#x95F4;&#x670D;&#x52A1;&#x7684;&#x9AD8;&#x53EF;&#x7528;&#x4E5F;&#x9700;&#x8981;&#x914D;&#x7F6E;&#x96C6;&#x7FA4;&#x3002;</li>
</ul>
</li>
<li>&#x57FA;&#x4E8E;&#x670D;&#x52A1;&#x7AEF;&#x5B9E;&#x73B0;</li>
</ul>
<p>Redis Cluster&#x662F;redis3.0&#x540E;&#x63A8;&#x51FA;&#x7684;&#xFF0C;&#x5B9E;&#x73B0;&#x4E86;&#x9AD8;&#x53EF;&#x7528;&#x7684;&#x5206;&#x5E03;&#x5F0F;&#x96C6;&#x7FA4;&#x90E8;&#x7F72;&#x3002;&#x901A;&#x8FC7;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#x7684;<code>cluster-enabled</code>&#x6765;&#x63A7;&#x5236;&#x662F;&#x5426;&#x5F00;&#x542F;&#x96C6;&#x7FA4;&#x6A21;&#x5F0F;</p>
<h3 id="&#x539F;&#x7406;"><a name="&#x539F;&#x7406;" class="anchor-navigation-ex-anchor" href="#&#x539F;&#x7406;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x539F;&#x7406;</h3>
<p>&#x6C34;&#x5E73;&#x6269;&#x5C55;&#x6709;&#x4E2A;&#x91CD;&#x8981;&#x7684;&#x95EE;&#x9898;&#x5C31;&#x662F;&#x6570;&#x636E;&#x5982;&#x4F55;&#x5206;&#x914D;&#xFF1A;&#x4E3B;&#x6D41;&#x6709;&#x54C8;&#x5E0C;&#x540E;&#x53D6;&#x6A21;&#x548C;&#x4E00;&#x81F4;&#x6027;&#x54C8;&#x5E0C;</p>
<ul>
<li>&#x54C8;&#x5E0C;&#x540E;&#x53D6;&#x6A21;&#xFF1A;&#x5C06;key&#x503C;&#x6C42;&#x54C8;&#x5E0C;&#x540E;&#x518D;&#x9664;&#x4EE5;&#x8282;&#x70B9;&#x6570;&#xFF0C;&#x6839;&#x636E;&#x4F59;&#x6570;&#x6765;&#x51B3;&#x5B9A;&#x843D;&#x5230;&#x54EA;&#x4E2A;&#x8282;&#x70B9;&#x4E0A;&#xFF0C;&#x8282;&#x70B9;&#x6570;&#x53D1;&#x751F;&#x53D8;&#x5316;&#xFF0C;&#x6240;&#x6709;&#x6570;&#x636E;&#x8981;&#x91CD;&#x65B0;&#x5206;&#x914D;</li>
<li>&#x4E00;&#x81F4;&#x6027;&#x54C8;&#x5E0C;&#xFF1A;&#x628A;&#x6240;&#x6709;&#x7684;&#x54C8;&#x5E0C;&#x503C;&#x7EC4;&#x6210;&#x4E00;&#x4E2A;&#x865A;&#x62DF;&#x7684;&#x54C8;&#x5E0C;&#x5706;&#x73AF;&#xFF0C;&#x8D77;&#x70B9;0&#x548C;&#x7EC8;&#x70B9;2^32-1&#x4F4D;&#x7F6E;&#x91CD;&#x53E0;&#xFF0C;&#x6BCF;&#x4E2A;&#x8282;&#x70B9;&#x8D1F;&#x8D23;&#x4E00;&#x4E2A;&#x533A;&#x95F4;&#x7684;&#x54C8;&#x5E0C;&#x503C;&#xFF0C;&#x8FD9;&#x6837;&#x6DFB;&#x52A0;&#x8282;&#x70B9;&#x53EA;&#x4F1A;&#x5F71;&#x54CD;&#x76F8;&#x90BB;&#x7684;&#x4E24;&#x4E2A;&#x8282;&#x70B9;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x4E2A;&#x65B9;&#x5F0F;&#x4F1A;&#x51FA;&#x73B0;&#x6570;&#x636E;&#x5206;&#x5E03;&#x4E0D;&#x5747;&#x5300;</li>
</ul>
<p>redis&#x5B9E;&#x73B0;&#x6570;&#x636E;&#x5206;&#x5E03;&#x4F7F;&#x7528;&#x4E86;&#x69FD;&#x7684;&#x6982;&#x5FF5;</p>
<ul>
<li>redis&#x5C06;&#x6574;&#x4E2A;&#x6570;&#x636E;&#x5E93;&#x5206;&#x4E3A;16384&#x4E2A;&#x69FD;&#xFF08;slot&#xFF09;</li>
<li>&#x6839;&#x636E;&#x8282;&#x70B9;&#x6570;&#x6765;&#x5212;&#x5206;&#x8282;&#x70B9;&#x8D1F;&#x8D23;&#x7684;&#x69FD;</li>
<li>&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x843D;&#x5728;&#x54EA;&#x4E2A;&#x69FD;&#x662F;&#x901A;&#x8FC7;CRC16&#x7B97;&#x6CD5;&#x5F97;&#x5230;&#x7684;&#xFF0C;&#x843D;&#x5230;&#x54EA;&#x4E2A;&#x69FD;&#x662F;&#x56FA;&#x5B9A;&#x7684;</li>
<li>&#x8282;&#x70B9;&#x8D1F;&#x8D23;&#x7684;&#x69FD;&#x53EF;&#x80FD;&#x4F1A;&#x53D1;&#x751F;&#x6539;&#x53D8;</li>
<li>&#x4E3A;&#x4E86;&#x8BA9;&#x540C;&#x4E00;&#x4E2A;&#x4E1A;&#x52A1;&#x7684;&#x6570;&#x636E;&#x843D;&#x5230;&#x540C;&#x4E00;&#x4E2A;&#x69FD;&#x4E2D;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;key&#x91CC;&#x9762;&#x5E26;&#x6709;{}&#xFF0C;redis&#x53EA;&#x4F1A;&#x8BA1;&#x7B97;{}&#x91CC;&#x9762;&#x7684;&#x5B57;&#x7B26;&#x8FDB;&#x884C;&#x54C8;&#x5E0C;&#xFF0C;&#x8FD9;&#x6837;&#x540C;&#x4E00;&#x4E2A;&#x4E1A;&#x52A1;&#x7684;&#x6570;&#x636E;&#x90FD;&#x5728;{}&#x4E2D;&#x653E;&#x5165;&#x76F8;&#x540C;&#x7684;&#x5B57;&#x7B26;&#x5C31;&#x4F1A;&#x843D;&#x5230;&#x540C;&#x4E00;&#x4E2A;&#x69FD;</li>
<li>&#x5BF9;&#x5BA2;&#x6237;&#x7AEF;&#x8BF7;&#x6C42;&#x91CD;&#x5B9A;&#x5411;&#xFF0C;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x4E0D;&#x518D;&#x81EA;&#x5DF1;&#x7684;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#xFF0C;&#x5C31;&#x4F1A;&#x8BA1;&#x7B97;&#x51FA;&#x5728;&#x54EA;&#x4E2A;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#xFF0C;&#x7136;&#x540E;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;MOVED&#x6307;&#x4EE4;&#xFF0C;&#x5E26;&#x4E0A;&#x670D;&#x52A1;&#x5668;&#x7684;ip&#x548C;&#x7AEF;&#x53E3;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x6536;&#x5230;MOVED&#x6307;&#x4EE4;&#x91CD;&#x5B9A;&#x5411;&#x5C31;&#x80FD;&#x83B7;&#x53D6;&#x5230;&#x6B63;&#x786E;&#x7684;&#x503C;&#x3002;</li>
<li>&#x91CD;&#x65B0;&#x5206;&#x7247;&#xFF1A;&#x53EF;&#x4EE5;&#x5C06;&#x5DF2;&#x7ECF;&#x6307;&#x6D3E;&#x7ED9;&#x67D0;&#x8282;&#x70B9;&#x7684;&#x4EFB;&#x610F;&#x6570;&#x91CF;&#x7684;&#x69FD;&#x91CD;&#x65B0;&#x6307;&#x6D3E;&#x7ED9;&#x53E6;&#x4E00;&#x4E2A;&#x8282;&#x70B9;&#xFF0C;&#x4E14;&#x91CD;&#x65B0;&#x6307;&#x6D3E;&#x7684;&#x69FD;&#x6240;&#x5C5E;&#x7684;&#x952E;&#x503C;&#x5BF9;&#x4E5F;&#x4F1A;&#x88AB;&#x79FB;&#x52A8;&#x5230;&#x65B0;&#x7684;&#x76EE;&#x6807;&#x8282;&#x70B9;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x65B0;&#x589E;&#x6216;&#x5220;&#x9664;&#x8282;&#x70B9;</li>
</ul>
<p>ASK&#x6307;&#x4EE4;&#x548C;MOVED&#x6307;&#x4EE4;&#xFF1A;</p>
<ul>
<li>ASK &#x6307;&#x4EE4;&#x53EF;&#x4EE5;&#x8BA4;&#x4E3A;&#x662F;&#x4E00;&#x79CD;&#x8FC7;&#x6E21;&#x65F6;&#x671F;&#x7684;&#x7279;&#x6B8A;&#x6307;&#x4EE4;&#xFF0C;&#x53EA;&#x6709;&#x5728;&#x53D1;&#x751F;&#x69FD;&#x8FC1;&#x79FB;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x53D1;&#x73B0;&#x539F;&#x672C;&#x5C5E;&#x4E8E; node1 &#x7BA1;&#x7406;&#x7684;&#x69FD;&#x88AB;&#x6307;&#x6D3E;&#x7ED9;&#x4E86; node2&#xFF0C;&#x800C;&#x6570;&#x636E;&#x53C8;&#x8FD8;&#x6CA1;&#x6709;&#x8FC1;&#x79FB;&#x5B8C;&#x6210;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x3002;&#x56E0;&#x4E3A;&#x8FD9;&#x662F;&#x4E00;&#x79CD;&#x7279;&#x6B8A;&#x573A;&#x666F;&#xFF0C;&#x6240;&#x4EE5;&#x5BA2;&#x6237;&#x7AEF;&#x6536;&#x5230; ASK &#x6307;&#x4EE4;&#x4E4B;&#x540E;&#x4E0D;&#x80FD;&#x76F4;&#x63A5;&#x8FDE;&#x5230;&#x76EE;&#x6807;&#x8282;&#x70B9;&#x6267;&#x884C;&#x547D;&#x4EE4;&#xFF08;&#x8FD9;&#x65F6;&#x5019;&#x76F4;&#x63A5;&#x8FDE;&#x8FC7;&#x53BB;&#x76EE;&#x6807;&#x8282;&#x70B9;&#x4F1A;&#x8FD4;&#x56DE; MOVED &#x547D;&#x4EE4;&#x6307;&#x5411; node1&#xFF09;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x6536;&#x5230; ASK &#x6307;&#x4EE4;&#x4E4B;&#x540E;&#x9700;&#x8981;&#x5148;&#x5411; node2 &#x8282;&#x70B9;&#x53D1;&#x9001;&#x4E00;&#x4E2A; ASKING &#x547D;&#x4EE4;&#x7ED9;&#x81EA;&#x5DF1;&#x6253;&#x4E0A;&#x6807;&#x8BB0;&#x624D;&#x80FD;&#x771F;&#x6B63;&#x53D1;&#x9001;&#x5BA2;&#x6237;&#x7AEF;&#x60F3;&#x8981;&#x6267;&#x884C;&#x7684;&#x547D;&#x4EE4;&#x3002;</li>
<li>&#x76EE;&#x6807;&#x8282;&#x70B9;&#x5728;&#x63A5;&#x6536;&#x5176;&#x5B83;&#x8282;&#x70B9;&#x6307;&#x6D3E;&#x8FC7;&#x6765;&#x7684;&#x69FD;&#x6240;&#x5BF9;&#x5E94;&#x952E;&#x503C;&#x5BF9;&#x65F6;&#xFF0C;&#x4F1A;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;&#x4E34;&#x65F6;&#x6570;&#x7EC4;&#x5C5E;&#x6027; importing_slots_from[16384] &#x6765;&#x5B58;&#x50A8;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x5728;&#x63A5;&#x6536;&#x5230;&#x8FD4;&#x56DE;&#x7684; ASK &#x9519;&#x8BEF;&#x4E4B;&#x540E;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x4F1A;&#x5148;&#x5411;&#x76EE;&#x6807;&#x8282;&#x70B9;&#x53D1;&#x9001;&#x4E00;&#x4E2A; ASKING &#x547D;&#x4EE4;&#xFF0C;&#x4E4B;&#x540E;&#x518D;&#x53D1;&#x9001;&#x539F;&#x672C;&#x60F3;&#x8981;&#x6267;&#x884C;&#x7684;&#x547D;&#x4EE4;&#xFF0C;&#x8FD9;&#x6837;&#x76EE;&#x6807;&#x8282;&#x70B9;&#x5C31;&#x77E5;&#x9053;&#x5F53;&#x524D;&#x5BA2;&#x6237;&#x7AEF;&#x8BBF;&#x95EE;&#x7684; key &#x662F;&#x6B63;&#x5728;&#x8FC1;&#x79FB;&#x8FC7;&#x6765;&#x7684;&#xFF0C;&#x77E5;&#x9053;&#x53BB;&#x54EA;&#x91CC;&#x53D6;&#x8FD9;&#x4E2A;&#x6570;&#x636E;&#x3002;</li>
<li>MOVED &#x6307;&#x4EE4;&#x662F;&#x5728;&#x6B63;&#x5E38;&#x60C5;&#x51B5;&#x6216;&#x8005;&#x8BF4;&#x69FD;&#x5DF2;&#x7ECF;&#x5B8C;&#x6210;&#x91CD;&#x65B0;&#x5206;&#x7247;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x8FD4;&#x56DE;&#x7684;&#x9519;&#x8BEF;&#xFF0C;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x670D;&#x52A1;&#x5668;&#x53D1;&#x73B0;&#x5F53;&#x524D; key &#x6240;&#x5728;&#x69FD;&#x4E0D;&#x5F52;&#x81EA;&#x5DF1;&#x7BA1;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4F1A;&#x76F4;&#x63A5;&#x8FD4;&#x56DE; MOVED &#x6307;&#x4EE4;&#x5E76;&#x540C;&#x65F6;&#x8FD4;&#x56DE;&#x8D1F;&#x8D23;&#x7BA1;&#x7406;&#x8BE5;&#x69FD;&#x7684;&#x670D;&#x52A1;&#x5668;&#x4FE1;&#x606F;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x6536;&#x5230; MOVED &#x6307;&#x4EE4;&#x53CA;&#x5176;&#x643A;&#x5E26;&#x7684;&#x76EE;&#x6807;&#x670D;&#x52A1;&#x5668;&#x5730;&#x5740;&#x4E4B;&#x540E;&#x5C31;&#x4F1A;&#x518D;&#x6B21;&#x8FDE;&#x63A5;&#x76EE;&#x6807;&#x8282;&#x70B9;&#x6267;&#x884C;&#x547D;&#x4EE4;</li>
</ul>
<p>Redis Group</p>
<ul>
<li>Redis &#x96C6;&#x7FA4;&#x4E2D;&#x7684;&#x8282;&#x70B9;&#x662F;&#x4E00;&#x4E2A;&#x7531; master-slave &#x7EC4;&#x6210;&#x7684;&#x96C6;&#x7FA4;&#xFF0C;&#x79F0;&#x4E4B;&#x4E3A; Redis Group</li>
<li>Redis Group&#x7684;&#x4E3B;&#x4ECE;&#x590D;&#x5236;&#x5C31;&#x662F;master-slave&#x7684;&#x540C;&#x6B65;&#x65B9;&#x5F0F;</li>
<li>&#x6545;&#x969C;&#x68C0;&#x6D4B;<ul>
<li>&#x96C6;&#x7FA4;&#x4E2D;&#x7684;&#x8282;&#x70B9;&#x5B9A;&#x671F;&#x4F1A;&#x5411;&#x5176;&#x4ED6;&#x8282;&#x70B9;&#x53D1;&#x9001;ping&#x547D;&#x4EE4;&#xFF0C;&#x89C4;&#x5B9A;&#x65F6;&#x95F4;&#x5185;&#x6CA1;&#x8FD4;&#x56DE;pong&#xFF0C;&#x53D1;&#x9001;ping&#x7684;&#x8282;&#x70B9;&#x5C31;&#x4F1A;&#x628A;&#x8BE5;&#x8282;&#x70B9;&#x6807;&#x8BB0;&#x4E3A;&#x7591;&#x4F3C;&#x4E0B;&#x7EBF;</li>
<li>&#x8282;&#x70B9;&#x4E4B;&#x95F4;&#x4E92;&#x53D1;&#x6D88;&#x606F;&#x4EA4;&#x6362;&#x96C6;&#x7FA4;&#x4E2D;&#x5404;&#x4E2A;&#x8282;&#x70B9;&#x7684;&#x72B6;&#x6001;&#x4FE1;&#x606F;&#xFF0C;&#x5F53;&#x4E00;&#x4E2A;&#x4E3B;&#x8282;&#x70B9;&#x53D1;&#x73B0;&#x534A;&#x6570;&#x7684;&#x8282;&#x70B9;&#x90FD;&#x5C06;&#x53E6;&#x4E00;&#x4E2A;&#x4E3B;&#x8282;&#x70B9;&#x88AB;&#x6807;&#x8BB0;&#x4E3A;&#x7591;&#x4F3C;&#x4E0B;&#x7EBF;&#xFF0C;&#x5C31;&#x4F1A;&#x5C06;&#x8BE5;&#x8282;&#x70B9;&#x6807;&#x8BB0;&#x4E3A;&#x4E0B;&#x7EBF;&#xFF0C;&#x5E76;&#x5E7F;&#x64AD;&#x7ED9;&#x6240;&#x6709;&#x8282;&#x70B9;&#xFF0C;&#x6240;&#x6709;&#x6536;&#x5230;&#x5E7F;&#x64AD;&#x7684;&#x8282;&#x70B9;&#x90FD;&#x4F1A;&#x5C06;&#x8BE5;&#x8282;&#x70B9;&#x6807;&#x8BB0;&#x4E3A;&#x5DF2;&#x4E0B;&#x7EBF;</li>
</ul>
</li>
<li>&#x6545;&#x969C;&#x8F6C;&#x79FB;<ul>
<li>&#x88AB;&#x9009;&#x4E2D;&#x7684;&#x4ECE;&#x8282;&#x70B9;&#x4F1A;&#x6267;&#x884C; replicaof no one &#x547D;&#x4EE4;&#xFF0C;&#x4F7F;&#x5F97;&#x81EA;&#x5DF1;&#x6210;&#x4E3A;&#x65B0;&#x7684;&#x4E3B;&#x8282;&#x70B9;&#x3002;</li>
<li>&#x65B0;&#x7684;&#x4E3B;&#x8282;&#x70B9;&#x4F1A;&#x5C06;&#x5DF2;&#x4E0B;&#x7EBF;&#x7684;&#x4E3B;&#x8282;&#x70B9;&#x8D1F;&#x8D23;&#x7684;&#x69FD;&#x5168;&#x90E8;&#x6307;&#x6D3E;&#x7ED9;&#x81EA;&#x5DF1;&#x3002;</li>
<li>&#x65B0;&#x7684;&#x4E3B;&#x8282;&#x70B9;&#x4F1A;&#x5411;&#x96C6;&#x7FA4;&#x53D1;&#x4E00;&#x6761; PONG &#x6D88;&#x606F;&#x7684;&#x5E7F;&#x64AD;&#xFF0C;&#x6536;&#x5230;&#x8FD9;&#x6761;&#x6D88;&#x606F;&#x7684;&#x5176;&#x5B83;&#x8282;&#x70B9;&#x5C31;&#x4F1A;&#x77E5;&#x9053;&#x8FD9;&#x4E2A;&#x8282;&#x70B9;&#x5DF2;&#x7ECF;&#x6210;&#x4E3A;&#x4E86;&#x65B0;&#x7684; master &#x8282;&#x70B9;&#xFF0C;&#x5E76;&#x4E14;&#x63A5;&#x7BA1;&#x4E86;&#x65E7; master &#x8282;&#x70B9;&#x7684;&#x69FD;&#x3002;</li>
</ul>
</li>
<li>&#x9009;&#x4E3E;&#x65B0;&#x7684;master<ul>
<li>&#x8BE5;&#x4ECE;&#x8282;&#x70B9;&#x4F1A;&#x5C06;&#x96C6;&#x7FA4;&#x7684;&#x914D;&#x7F6E;&#x7EAA;&#x5143;&#x81EA;&#x589E; 1&#xFF08;&#x548C; Sentinel &#x673A;&#x5236;&#x4E00;&#x6837;&#xFF0C;&#x914D;&#x7F6E;&#x7EAA;&#x5143;&#x9ED8;&#x8BA4;&#x503C;&#x4E5F;&#x662F; 0&#xFF09;&#x3002;</li>
<li>&#x8BE5;&#x4ECE;&#x8282;&#x70B9;&#x4F1A;&#x5411;&#x96C6;&#x7FA4;&#x53D1;&#x4E00;&#x6761; CLUSTERMSG_TYPE_FAILOVER_AUTH_REQUEST &#x7684;&#x6D88;&#x606F;&#x5E7F;&#x64AD;&#x3002;</li>
<li>&#x5176;&#x5B83;&#x8282;&#x70B9;&#x6536;&#x5230;&#x5E7F;&#x64AD;&#x540E;&#xFF0C;master &#x8282;&#x70B9;&#x4F1A;&#x5224;&#x65AD;&#x5408;&#x6CD5;&#x6027;&#xFF0C;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x4E3B;&#x8282;&#x70B9;&#x5177;&#x6709;&#x6295;&#x7968;&#x6743;&#xFF08;&#x6B63;&#x5728;&#x8D1F;&#x8D23;&#x5904;&#x7406;&#x69FD;&#xFF09;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4F1A;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A; CLUSTERMSG_TYPE_FAILOVER_AUTH_ACK &#x6D88;&#x606F;&#x7ED9;&#x5B83;&#x6295; 1 &#x7968;&#xFF08;&#x4E00;&#x4E2A;&#x914D;&#x7F6E;&#x7EAA;&#x5143;&#x5185;&#xFF0C;&#x4E00;&#x4E2A; master &#x8282;&#x70B9;&#x6700;&#x591A;&#x53EA;&#x80FD;&#x6295;&#x7968; 1 &#x6B21;&#xFF09;&#x3002;</li>
<li>&#x5982;&#x679C;&#x540C;&#x65F6;&#x6709;&#x591A;&#x4E2A;&#x4ECE;&#x8282;&#x70B9;&#x53D1;&#x8D77;&#x6295;&#x7968;&#xFF0C;&#x90A3;&#x4E48;&#x6BCF;&#x4E2A;&#x4ECE;&#x8282;&#x70B9;&#x90FD;&#x4F1A;&#x7EDF;&#x8BA1;&#x81EA;&#x5DF1;&#x6240;&#x5F97;&#x7968;&#x6570;&#xFF0C;&#x7136;&#x540E;&#x8FDB;&#x884C;&#x7EDF;&#x8BA1;&#xFF0C;&#x53EA;&#x8981;&#x5F97;&#x5230;&#x4E86;&#x5927;&#x4E8E;&#x53C2;&#x4E0E;&#x6295;&#x7968;&#x7684;&#x4E3B;&#x8282;&#x70B9;&#x6570;&#x7684;&#x4E00;&#x534A;&#x7684;&#x4ECE;&#x8282;&#x70B9;&#xFF0C;&#x5C31;&#x4F1A;&#x6210;&#x4E3A;&#x65B0;&#x7684; master &#x8282;&#x70B9;&#x3002;</li>
<li>&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x914D;&#x7F6E;&#x7EAA;&#x5143;&#x5185;&#x6CA1;&#x6709;&#x4E00;&#x4E2A;&#x4ECE;&#x8282;&#x70B9;&#x8FBE;&#x5230;&#x8981;&#x6C42;&#xFF0C;&#x90A3;&#x4E48;&#x96C6;&#x7FA4;&#x4F1A;&#x628A;&#x914D;&#x7F6E;&#x7EAA;&#x5143;&#x518D;&#x6B21;&#x81EA;&#x589E;&#xFF0C;&#x5E76;&#x518D;&#x6B21;&#x8FDB;&#x884C;&#x9009;&#x4E3E;&#xFF0C;&#x76F4;&#x5230;&#x9009;&#x51FA;&#x65B0;&#x7684; master&#x3002;</li>
</ul>
</li>
</ul>
<p>&#x69FD;&#x4E3A;&#x4EC0;&#x4E48;&#x662F;16384&#x4E2A;&#xFF1A;&#x9700;&#x8981;&#x9891;&#x7E41;&#x53D1;&#x9001;&#x5FC3;&#x8DF3;&#x6D88;&#x606F;&#xFF0C;16384&#x53EA;&#x9700;&#x8981;2k&#x7684;&#x7A7A;&#x95F4;&#xFF0C;&#x800C;&#x4E14;&#x96C6;&#x7FA4;&#x8282;&#x70B9;&#x6570;&#x6700;&#x597D;&#x4E0D;&#x8981;&#x8D85;&#x8FC7;1000&#xFF0C;&#x6781;&#x7AEF;&#x60C5;&#x51B5;&#x4E0B;&#x6BCF;&#x4E2A;&#x8282;&#x70B9;&#x8D1F;&#x8D23;16&#x4E2A;slot&#xFF0C;<a href="https://github.com/redis/redis/issues/2576" target="_blank">&#x5B98;&#x65B9;&#x89E3;&#x91CA;</a></p>
<h3 id="&#x914D;&#x7F6E;"><a name="&#x914D;&#x7F6E;" class="anchor-navigation-ex-anchor" href="#&#x914D;&#x7F6E;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x914D;&#x7F6E;</h3>
<p>Redis Cluster &#x96C6;&#x7FA4;&#x901A;&#x5E38;&#x90FD;&#x81F3;&#x5C11;&#x9700;&#x8981;3&#x4E2A;master&#x8282;&#x70B9;&#xFF0C;&#x6BCF;&#x4E2A;master&#x8282;&#x70B9;&#x53C8;&#x81F3;&#x5C11;&#x9700;&#x8981;&#x4E00;&#x4E2A;slave&#x8282;&#x70B9;</p>
<p>&#x4FEE;&#x6539;redis.conf&#x6587;&#x4EF6;</p>
<pre class="language-"><code class="lang-bash">daemonize <span class="token function">yes</span>  //&#x5F00;&#x542F;&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x540E;&#x53F0;&#x8FD0;&#x884C;
protected-mode no  //&#x7F51;&#x7EDC;&#x662F;&#x5426;&#x5141;&#x8BB8;&#x5BF9;&#x5916;&#x8BBF;&#x95EE; no &#x8868;&#x793A;&#x5141;&#x8BB8;
cluster-enabled <span class="token function">yes</span>  //&#x662F;&#x5426;&#x5F00;&#x542F;&#x96C6;&#x7FA4;&#x6A21;&#x5F0F;&#xFF08;&#x9ED8;&#x8BA4;&#x662F;&#x6CE8;&#x91CA;&#x6389;&#x7684;&#xFF0C;&#x6253;&#x5F00;&#x6CE8;&#x91CA;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#xFF09;
cluster-node-timeout <span class="token number">5000</span> //&#x96C6;&#x7FA4;&#x8D85;&#x65F6;&#x65F6;&#x95F4;
port <span class="token number">6379</span> //&#x7AEF;&#x53E3;&#x53F7;
<span class="token function">dir</span> /home/project/redis-6379/  //redis &#x5DE5;&#x4F5C;&#x4E3B;&#x76EE;&#x5F55;
logfile <span class="token string">&quot;/home/project/redis-6379/redis.log&quot;</span> //&#x81EA;&#x5B9A;&#x4E49;&#x65E5;&#x5FD7;&#x6587;&#x4EF6;&#x76EE;&#x5F55;
cluster-config-file /home/project/redis-6370/nodes-6379.conf //node &#x6587;&#x4EF6;
pidfile /var/run/redis_6379.pid  //pid &#x6587;&#x4EF6;
</code></pre>
<p>&#x914D;&#x7F6E;&#x597D;&#x540E;&#x542F;&#x52A8;redis-server</p>
<p>&#x6B64;&#x65F6;&#x5728;redis-cli&#x4E2D;&#x67E5;&#x770B;redis cluster&#x96C6;&#x7FA4;&#x7684;&#x72B6;&#x6001;&#x662F;fail <code>cluster info</code></p>
<p><code>redis-cli --cluster create ip1:port1 ip2:port2 ip3:port3 [ip4:port4 ...] --cluster-replicas 1</code> - &#x521B;&#x5EFA;&#x96C6;&#x7FA4;&#xFF0C;&#x7CFB;&#x7EDF;&#x4F1A;&#x81EA;&#x52A8;&#x5206;&#x914D;&#x69FD;&#x4ECE;&#x800C;&#x786E;&#x5B9A;&#x4E3B;&#x4ECE;&#x5173;&#x7CFB;&#x3002;&#x671F;&#x95F4;&#x9700;&#x8981;&#x8F93;&#x5165;yes&#x786E;&#x5B9A;&#x914D;&#x7F6E;</p>
<p>&#x6B64;&#x65F6;&#x5728;redis-cli&#x4E2D;&#x67E5;&#x770B;redis cluster&#x96C6;&#x7FA4;&#x7684;&#x72B6;&#x6001;&#x662F;OK&#x4E86; <code>cluster info</code></p>
<p>&#x53EF;&#x80FD;&#x9047;&#x5230;&#x7684;&#x95EE;&#x9898;&#xFF1A;</p>
<ol>
<li><p><code>[ERR] Node 47.107.155.197:6370 is not empty. Either the node already knows other nodes (check with CLUSTER NODES) or contains some key in database 0.</code></p>
<ul>
<li>&#x8FD9;&#x4E2A;&#x9519;&#x8BEF;&#x6709; 2 &#x4E2A;&#x539F;&#x56E0;&#xFF1A;</li>
<li>&#x4E00;&#x4E2A;&#x5C31;&#x662F; Redis &#x5F53;&#x4E2D;&#x6709;&#x6570;&#x636E;&#xFF0C;&#x8FD9;&#x4E2A;&#x6267;&#x884C; flushall &#x547D;&#x4EE4;&#x6216;&#x8005;&#x628A; rdb &#x548C; aof &#x4E24;&#x4E2A;&#x6301;&#x4E45;&#x5316;&#x6587;&#x4EF6;&#x5220;&#x9664;&#x6389;&#xFF08;&#x5982;&#x679C;&#x6709;&#x7684;&#x8BDD;&#xFF09;&#xFF0C;&#x518D;&#x91CD;&#x542F;&#x5373;&#x53EF;&#xFF1B;</li>
<li>&#x53E6;&#x4E00;&#x4E2A;&#x539F;&#x56E0;&#x5C31;&#x662F;&#x53EF;&#x80FD;&#x521D;&#x59CB;&#x5316;&#x96C6;&#x7FA4;&#x5931;&#x8D25;&#x8FC7; 1 &#x6B21;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x65F6;&#x5019;&#x9700;&#x8981;&#x628A;&#x5F53;&#x65F6;&#x914D;&#x7F6E;&#x597D;&#x7684; nodes.conf &#x6587;&#x4EF6;&#x5220;&#x6389;&#xFF0C;&#x5E76;&#x91CD;&#x542F; Redis &#x670D;&#x52A1;&#x5C31;&#x53EF;&#x4EE5;&#x89E3;&#x51B3;&#x3002;</li>
</ul>
</li>
<li><p>&#x521D;&#x59CB;&#x5316;&#x96C6;&#x7FA4;&#x8F93;&#x5165; yes &#x4E4B;&#x540E;&#x63D0;&#x793A; <code>Waiting for the cluster to join</code>&#xFF0C;&#x4F46;&#x662F;&#x5374;&#x8FDF;&#x8FDF;&#x7B49;&#x4E0D;&#x5230;&#x6210;&#x529F;&#x3002;</p>
<ul>
<li>&#x8FD9;&#x4E2A;&#x539F;&#x56E0;&#x53EF;&#x80FD;&#x662F;&#x9632;&#x706B;&#x5899;&#x5F15;&#x8D77;&#x7684;&#xFF0C;&#x9664;&#x4E86;&#x6B63;&#x5E38;&#x7684;&#x6570;&#x636E;&#x8FDE;&#x63A5;&#x7AEF;&#x53E3;&#xFF0C;&#x5982; 6370-6375&#xFF0C;&#x8FD8;&#x6709;&#x53E6;&#x4E00;&#x4E2A;&#x7AEF;&#x53E3;&#x9700;&#x8981;&#x7528;&#x6570;&#x636E;&#x7AEF;&#x53E3;&#x56FA;&#x5B9A;&#x52A0;&#x4E0A; 10000 &#x5F97;&#x5230; 16370-16375&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x9700;&#x8981;&#x786E;&#x4FDD;&#x4EE5;&#x4E0B; 12 &#x4E2A;&#x7AEF;&#x53E3;&#x90FD;&#x662F;&#x901A;&#x7684;&#xFF1A;<code>6370 16370 6371 16371 6372 16372 6373 16373 6374 16374 6375 16375</code></li>
</ul>
</li>
<li><p><code>[ERR] Not all 16384 slots are covered by nodes.</code></p>
<ul>
<li>&#x8FD9;&#x4E2A;&#x539F;&#x56E0;&#x8BF4;&#x660E;&#x5206;&#x914D;&#x69FD;&#x7684;&#x65F6;&#x5019;&#x5931;&#x8D25;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x9700;&#x8981;&#x68C0;&#x67E5;&#x4E0B;&#x914D;&#x7F6E;&#x662F;&#x5426;&#x6B63;&#x786E;&#x3002;&#x5C24;&#x5176;&#x662F; cluster-config-file &#x8FD9;&#x4E2A; node &#x6587;&#x4EF6;&#x7684;&#x914D;&#x7F6E;&#x662F;&#x5426;&#x6B63;&#x786E;&#xFF0C;&#x786E;&#x8BA4;&#x4E4B;&#x540E;&#x4E0D;&#x7BA1;&#x6709;&#x6CA1;&#x6709;&#x914D;&#x7F6E;&#x9519;&#x8BEF;&#xFF0C;&#x90FD;&#x628A;&#x6240;&#x6709;&#x670D;&#x52A1;&#x7684; node &#x6587;&#x4EF6;&#x5220;&#x9664;&#x6389;&#xFF0C;&#x5E76;&#x91CD;&#x542F;&#x6240;&#x6709; Redis &#x670D;&#x52A1;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x6B21;&#x8FDB;&#x884C;&#x96C6;&#x7FA4;&#x642D;&#x5EFA;&#x3002;</li>
</ul>
</li>
</ol>
<h3 id="&#x96C6;&#x7FA4;&#x547D;&#x4EE4;"><a name="&#x96C6;&#x7FA4;&#x547D;&#x4EE4;" class="anchor-navigation-ex-anchor" href="#&#x96C6;&#x7FA4;&#x547D;&#x4EE4;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x96C6;&#x7FA4;&#x547D;&#x4EE4;</h3>
<ul>
<li><code>cluster info</code> - &#x6253;&#x5370;&#x5F53;&#x524D;&#x96C6;&#x7FA4;&#x7684;&#x4FE1;&#x606F;</li>
<li><code>cluster nodes</code> - &#x6253;&#x5370;&#x51FA;&#x96C6;&#x7FA4;&#x4E2D;node&#x53CA;&#x5176;&#x4FE1;&#x606F;</li>
<li><code>cluster meet <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ip</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>port</span><span class="token punctuation">&gt;</span></span></code> - &#x5C06;&#x6307;&#x5B9A;ip&#x548C;port&#x7684;node&#x6DFB;&#x52A0;&#x5230;&#x5F53;&#x524D;&#x6267;&#x884C;&#x547D;&#x4EE4;&#x8282;&#x70B9;&#x6240;&#x5728;&#x7684;&#x96C6;&#x7FA4;&#x4E2D;</li>
<li><code>cluster forget <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>node_id</span><span class="token punctuation">&gt;</span></span></code> - &#x4ECE;&#x96C6;&#x7FA4;&#x4E2D;&#x79FB;&#x9664;&#x67D0;&#x4E00;&#x4E2A;&#x8282;&#x70B9;</li>
<li><code>cluster replicate <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>node_id</span><span class="token punctuation">&gt;</span></span></code> - &#x5C06;&#x5F53;&#x524D;&#x8282;&#x70B9;&#x8BBE;&#x7F6E;&#x4E3A;&#x6307;&#x5B9A;&#x8282;&#x70B9;&#x7684;&#x4ECE;&#x8282;&#x70B9;</li>
<li><code>cluster saveconfig</code> - &#x5C06;&#x5F53;&#x524D;&#x8282;&#x70B9;&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4FDD;&#x5B58;&#x5230;&#x786C;&#x76D8;&#x91CC;&#x9762;</li>
<li><code>cluster keyslot <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>key</span><span class="token punctuation">&gt;</span></span></code> - &#x8BA1;&#x7B97;&#x952E;key&#x5E94;&#x8BE5;&#x88AB;&#x653E;&#x7F6E;&#x5728;&#x54EA;&#x4E2A;&#x69FD;&#x4E0A;</li>
<li><code>cluster countkeysinslot <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span></code> - &#x8FD4;&#x56DE;&#x69FD;&#x76EE;&#x524D;&#x5305;&#x542B;&#x7684;&#x952E;&#x503C;&#x5BF9;&#x6570;&#x91CF;</li>
<li><code>cluster getkeysinslot <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>count</span><span class="token punctuation">&gt;</span></span></code> - &#x8FD4;&#x56DE;count&#x4E2A;slot&#x69FD;&#x4E2D;&#x7684;&#x952E;</li>
<li><code>cluster addslots <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span> [slot...]</code> - &#x5C06;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x69FD;&#xFF08;slot&#xFF09;&#x6307;&#x6D3E;&#x7ED9;&#x5F53;&#x524D;&#x8282;&#x70B9;</li>
<li><code>cluster delslots <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span> [slot...]</code> -  &#x79FB;&#x9664;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x69FD;&#x5BF9;&#x5F53;&#x524D;&#x8282;&#x70B9;&#x7684;&#x6307;&#x6D3E;</li>
<li><code>cluster flushslots</code> -  &#x79FB;&#x9664;&#x5F53;&#x524D;&#x8282;&#x70B9;&#x7684;&#x6240;&#x6709;&#x69FD;</li>
<li><code>cluster setslot <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span> node <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>node_id</span><span class="token punctuation">&gt;</span></span></code> - &#x5C06;&#x69FD; slot &#x6307;&#x6D3E;&#x7ED9;&#x6307;&#x5B9A;&#x7684;&#x8282;&#x70B9;&#xFF0C; &#x5982;&#x679C;&#x69FD; slot &#x5DF2;&#x7ECF;&#x6307;&#x6D3E;&#x7ED9;&#x53E6;&#x4E00;&#x4E2A;&#x8282;&#x70B9;&#xFF0C;&#x5219;&#x4F1A;&#x5148;&#x5220;&#x9664;&#x518D;&#x6307;&#x6D3E;</li>
<li><code>cluster setslot <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span> migrating <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>node_id</span><span class="token punctuation">&gt;</span></span></code> - &#x5C06;&#x672C;&#x8282;&#x70B9;&#x7684;&#x69FD; slot &#x8FC1;&#x79FB;&#x5230;&#x6307;&#x5B9A;&#x7684;&#x8282;&#x70B9;&#x4E2D;</li>
<li><code>cluster setslot <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span> importing <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>node_id</span><span class="token punctuation">&gt;</span></span></code> - &#x4ECE;&#x6307;&#x5B9A;&#x7684;&#x8282;&#x70B9;&#x4E2D;&#x5BFC;&#x5165;&#x69FD; slot &#x5230;&#x5F53;&#x524D;&#x8282;&#x70B9;</li>
<li><code>cluster setslot <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span> stable</code> - &#x53D6;&#x6D88;&#x5BF9;&#x69FD; slot &#x7684;&#x5BFC;&#x5165;&#xFF08;import&#xFF09;&#x6216;&#x8005;&#x8FC1;&#x79FB;&#xFF08;migrate&#xFF09;</li>
</ul>
<h1 id="&#x7F13;&#x5B58;&#x7A7F;&#x900F;&#x548C;&#x7F13;&#x5B58;&#x96EA;&#x5D29;"><a name="&#x7F13;&#x5B58;&#x7A7F;&#x900F;&#x548C;&#x7F13;&#x5B58;&#x96EA;&#x5D29;" class="anchor-navigation-ex-anchor" href="#&#x7F13;&#x5B58;&#x7A7F;&#x900F;&#x548C;&#x7F13;&#x5B58;&#x96EA;&#x5D29;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x7F13;&#x5B58;&#x7A7F;&#x900F;&#x548C;&#x7F13;&#x5B58;&#x96EA;&#x5D29;</h1>
<h2 id="&#x7F13;&#x5B58;&#x96EA;&#x5D29;"><a name="&#x7F13;&#x5B58;&#x96EA;&#x5D29;" class="anchor-navigation-ex-anchor" href="#&#x7F13;&#x5B58;&#x96EA;&#x5D29;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x7F13;&#x5B58;&#x96EA;&#x5D29;</h2>
<p>Redis&#x5F53;&#x4E2D;&#x7684;&#x5927;&#x91CF;&#x7F13;&#x5B58;&#x5728;&#x540C;&#x4E00;&#x65F6;&#x95F4;&#x5168;&#x90E8;&#x5931;&#x6548;&#xFF0C;&#x5728;&#x6B64;&#x65F6;&#x53C8;&#x6709;&#x5927;&#x91CF;&#x8BF7;&#x6C42;&#x88AB;&#x53D1;&#x8D77;&#xFF0C;&#x90A3;&#x4E48;&#x6240;&#x6709;&#x8BF7;&#x6C42;&#x90FD;&#x4F1A;&#x5230;&#x6570;&#x636E;&#x5E93;&#xFF0C;&#x5BFC;&#x81F4;&#x6570;&#x636E;&#x5E93;&#x538B;&#x529B;&#x8FC7;&#x5927;&#x3002;</p>
<p>&#x89E3;&#x51B3;&#x529E;&#x6CD5;&#xFF1A;</p>
<ul>
<li>&#x52A0;&#x9501;&#xFF0C;&#x4FDD;&#x8BC1;&#x5355;&#x7EBF;&#x7A0B;&#x8BBF;&#x95EE;&#x7F13;&#x5B58;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x4E0D;&#x4F1A;&#x5F88;&#x591A;&#x8BF7;&#x6C42;&#x540C;&#x65F6;&#x8BBF;&#x95EE;&#x6570;&#x636E;&#x5E93;</li>
<li>key&#x7684;&#x5931;&#x6548;&#x65F6;&#x95F4;&#x4E0D;&#x8981;&#x8BBE;&#x7F6E;&#x4E3A;&#x4E00;&#x6837;&#xFF0C;&#x5178;&#x578B;&#x7684;&#x5C31;&#x662F;&#x521D;&#x59CB;&#x5316;&#x9884;&#x70ED;&#x6570;&#x636E;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x91C7;&#x7528;&#x968F;&#x673A;&#x65F6;&#x95F4;&#x6765;&#x786E;&#x4FDD;&#x4E0D;&#x4F1A;&#x5728;&#x540C;&#x4E00;&#x65F6;&#x95F4;&#x6709;&#x5927;&#x91CF;&#x7F13;&#x5B58;&#x5931;&#x6548;</li>
<li>&#x5185;&#x5B58;&#x5141;&#x8BB8;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x53EF;&#x4EE5;&#x5C06;&#x7F13;&#x5B58;&#x8BBE;&#x7F6E;&#x4E3A;&#x6C38;&#x4E0D;&#x5931;&#x6548;</li>
</ul>
<h2 id="&#x7F13;&#x5B58;&#x51FB;&#x7A7F;"><a name="&#x7F13;&#x5B58;&#x51FB;&#x7A7F;" class="anchor-navigation-ex-anchor" href="#&#x7F13;&#x5B58;&#x51FB;&#x7A7F;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x7F13;&#x5B58;&#x51FB;&#x7A7F;</h2>
<p>&#x7F13;&#x5B58;&#x51FB;&#x7A7F;&#x4E00;&#x822C;&#x6307;&#x7684;&#x662F;&#x5355;&#x4E2A;&#x7F13;&#x5B58;&#x5931;&#x6548;&#x3002;&#x540C;&#x4E00;&#x65F6;&#x95F4;&#x53C8;&#x6709;&#x5F88;&#x5927;&#x7684;&#x5E76;&#x53D1;&#x8BF7;&#x6C42;&#x9700;&#x8981;&#x8BBF;&#x95EE;&#x8FD9;&#x4E2A;key&#xFF0C;&#x9020;&#x6210;&#x6570;&#x636E;&#x5E93;&#x538B;&#x529B;</p>
<p>&#x89E3;&#x51B3;&#x529E;&#x6CD5;&#xFF1A;</p>
<ul>
<li>&#x52A0;&#x9501;&#xFF0C;&#x4FDD;&#x8BC1;&#x5355;&#x7EBF;&#x7A0B;&#x8BBF;&#x95EE;&#x7F13;&#x5B58;&#x3002;&#x8FD9;&#x6837;&#x7B2C;&#x4E00;&#x4E2A;&#x8BF7;&#x6C42;&#x5230;&#x8FBE;&#x6570;&#x636E;&#x5E93;&#x540E;&#x5C31;&#x4F1A;&#x91CD;&#x65B0;&#x5199;&#x5165;&#x7F13;&#x5B58;&#xFF0C;&#x540E;&#x7EED;&#x7684;&#x8BF7;&#x6C42;&#x5C31;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x8BFB;&#x53D6;&#x7F13;&#x5B58;&#x3002;</li>
<li>&#x5185;&#x5B58;&#x5141;&#x8BB8;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x53EF;&#x4EE5;&#x5C06;&#x7F13;&#x5B58;&#x8BBE;&#x7F6E;&#x4E3A;&#x6C38;&#x4E0D;&#x5931;&#x6548;&#x3002;</li>
</ul>
<h2 id="&#x7F13;&#x5B58;&#x7A7F;&#x900F;"><a name="&#x7F13;&#x5B58;&#x7A7F;&#x900F;" class="anchor-navigation-ex-anchor" href="#&#x7F13;&#x5B58;&#x7A7F;&#x900F;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x7F13;&#x5B58;&#x7A7F;&#x900F;</h2>
<p>&#x5F53;&#x8BBF;&#x95EE;&#x7684;&#x6570;&#x636E;&#x5728;redis&#x548C;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x90FD;&#x4E0D;&#x5B58;&#x5728;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5E76;&#x53D1;&#x91CF;&#x8FC7;&#x5927;&#x4E5F;&#x4F1A;&#x9020;&#x6210;&#x6570;&#x636E;&#x5E93;&#x7684;&#x5F88;&#x5927;&#x538B;&#x529B;</p>
<p>&#x89E3;&#x51B3;&#x529E;&#x6CD5;&#xFF1A;</p>
<ul>
<li>&#x63A5;&#x53E3;&#x5C42;&#x6821;&#x9A8C;&#xFF0C;&#x53D1;&#x73B0;&#x975E;&#x6CD5;&#x7684;key&#x76F4;&#x63A5;&#x8FD4;&#x56DE;</li>
<li>&#x7F13;&#x5B58;&#x4E0D;&#x5B58;&#x5728;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x7F13;&#x5B58;&#x4E00;&#x4E2A;&#x7A7A;value&#xFF0C;&#x9700;&#x8981;&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x77ED;&#x671F;&#x8FC7;&#x671F;&#x65F6;&#x95F4;&#xFF0C;&#x5426;&#x5219;&#x5927;&#x91CF;&#x4E0D;&#x5B58;&#x5728;&#x7684;key&#x88AB;&#x5B58;&#x5728;redis&#x4E2D;&#xFF0C;&#x4E5F;&#x4F1A;&#x5360;&#x7528;&#x5927;&#x91CF;&#x5185;&#x5B58;</li>
</ul>
<h2 id="&#x5E03;&#x9686;&#x8FC7;&#x6EE4;&#x5668;"><a name="&#x5E03;&#x9686;&#x8FC7;&#x6EE4;&#x5668;" class="anchor-navigation-ex-anchor" href="#&#x5E03;&#x9686;&#x8FC7;&#x6EE4;&#x5668;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5E03;&#x9686;&#x8FC7;&#x6EE4;&#x5668;</h2>
<p>&#x5F53;&#x6709;&#x5927;&#x91CF;key&#x503C;&#x4E3A;&#x7A7A;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6B64;&#x65F6;&#x4F1A;&#x53D1;&#x9001;&#x7F13;&#x5B58;&#x7A7F;&#x900F;&#xFF0C;&#x4F46;&#x662F;&#x5982;&#x679C;&#x628A;&#x7A7A;&#x7684;key&#x653E;&#x5728;redis&#x4E2D;&#xFF0C;&#x53C8;&#x4F1A;&#x5360;&#x7528;&#x5927;&#x91CF;&#x7684;&#x7A7A;&#x95F4;&#xFF0C;&#x6240;&#x4EE5;&#x5F15;&#x5165;&#x5E03;&#x9686;&#x8FC7;&#x6EE4;&#x5668;&#xFF08;Bloom Filter&#xFF09;</p>
<p>&#x5E03;&#x9686;&#x8FC7;&#x6EE4;&#x5668;&#x662F;&#x4E00;&#x4E2A;&#x4E8C;&#x8FDB;&#x5236;&#x5411;&#x91CF;&#xFF08;&#x4F4D;&#x56FE;&#xFF09;&#x548C;&#x4E00;&#x7CFB;&#x5217;&#x968F;&#x673A;&#x968F;&#x673A;&#x6620;&#x5C04;&#x51FD;&#x6570;&#xFF08;&#x54C8;&#x5E0C;&#x51FD;&#x6570;&#xFF09;</p>
<p>&#x5B9E;&#x73B0;&#x539F;&#x7406;&#xFF1A;&#x5B58;&#x5728;&#x4E00;&#x4E2A;&#x4E8C;&#x8FDB;&#x5236;&#x5411;&#x91CF;&#xFF0C;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x4F4D;&#x6570;&#x7EC4;&#xFF0C;&#x6BCF;&#x4E2A;&#x5143;&#x7D20;&#x90FD;&#x53EA;&#x6709;0&#x6216;1&#x4E24;&#x4E2A;&#x72B6;&#x6001;&#xFF0C;&#x4E00;&#x4E2A;&#x4F4D;&#x7F6E;&#x53EA;&#x5360;&#x7528;&#x4E00;&#x4E2A;bit&#x4F4D;&#xFF0C;0&#x8868;&#x793A;&#x5143;&#x7D20;&#x4E0D;&#x5B58;&#x5728;&#xFF0C;1&#x8868;&#x793A;&#x5B58;&#x5728;</p>
<p>&#x95EE;&#x9898;&#xFF1A;&#x5982;&#x679C;&#x53D1;&#x751F;&#x4E86;&#x54C8;&#x5E0C;&#x78B0;&#x649E;&#xFF0C;&#x5C31;&#x4F1A;&#x51FA;&#x73B0;&#x591A;&#x4E2A;&#x6570;&#x636E;&#x7531;&#x4E00;&#x4E2A;&#x4F4D;&#x7F6E;&#x8868;&#x793A;&#xFF0C;&#x5F71;&#x54CD;&#x5224;&#x65AD;&#x7684;&#x51C6;&#x786E;&#x6027;&#x3002;&#x89E3;&#x51B3;&#x54C8;&#x5E0C;&#x78B0;&#x649E;&#x65B9;&#x6CD5;&#xFF1A;</p>
<ul>
<li>&#x589E;&#x5927;&#x4F4D;&#x56FE;&#x6570;&#x7EC4;&#x7684;&#x5927;&#x5C0F;&#xFF08;&#x4F1A;&#x5360;&#x7528;&#x8FC7;&#x5927;&#x5185;&#x5B58;&#xFF09;</li>
<li>&#x589E;&#x52A0;&#x54C8;&#x5E0C;&#x6B21;&#x6570;&#xFF08;&#x540C;&#x4E00;&#x4E2A;key&#x591A;&#x6B21;&#x54C8;&#x5E0C;&#xFF0C;&#x7528;&#x591A;&#x4E2A;&#x4F4D;&#x7F6E;&#x6765;&#x8868;&#x793A;&#x8BE5;&#x6570;&#x636E;&#x662F;&#x5426;&#x5B58;&#x5728;&#xFF0C;&#x4F1A;&#x6D88;&#x8017;&#x8FC7;&#x591A;&#x65F6;&#x95F4;&#xFF09;</li>
</ul>
<p>&#x5E03;&#x9686;&#x8FC7;&#x6EE4;&#x5668;&#x7279;&#x70B9;&#xFF1A;</p>
<ul>
<li>&#x5982;&#x679C;&#x5E03;&#x9686;&#x8FC7;&#x6EE4;&#x5668;&#x5224;&#x65AD;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x5B58;&#x5728;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x4E2A;&#x5143;&#x7D20;&#x53EF;&#x80FD;&#x5B58;&#x5728;</li>
<li>&#x5982;&#x679C;&#x5E03;&#x9686;&#x8FC7;&#x6EE4;&#x5668;&#x5224;&#x65AD;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x4E0D;&#x5B58;&#x5728;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x4E2A;&#x5143;&#x7D20;&#x4E00;&#x5B9A;&#x4E0D;&#x5B58;&#x5728;</li>
<li>&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x5B58;&#x5728;&#xFF0C;&#x90A3;&#x4E48;&#x5E03;&#x9686;&#x8FC7;&#x6EE4;&#x5668;&#x4E00;&#x5B9A;&#x5224;&#x65AD;&#x5B58;&#x5728;</li>
<li>&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x4E0D;&#x5B58;&#x5728;&#xFF0C;&#x90A3;&#x4E48;&#x5E03;&#x9686;&#x8FC7;&#x6EE4;&#x5668;&#x53EF;&#x80FD;&#x5224;&#x65AD;&#x5B58;&#x5728;</li>
</ul>
<p>&#x5E03;&#x9686;&#x8FC7;&#x6EE4;&#x5668;&#x5220;&#x9664;&#x5143;&#x7D20;&#x9700;&#x8981;&#x5F15;&#x5165;&#x8BA1;&#x6570;&#x5668;</p>
<footer class="page-footer"><span class="copyright">Copyright &#xA9; book.stolenzc.com 2021-2024 all right reserved&#xFF0C;powered by Gitbook</span><span class="footer-modification">File Modify: 
2024-01-02 01:24:20
</span></footer>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="PythonNote.html" class="navigation navigation-prev " aria-label="Previous page: Python基础">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="SoftManual.html" class="navigation navigation-next " aria-label="Next page: 软件使用">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Redis","level":"1.11","depth":1,"next":{"title":"软件使用","level":"1.12","depth":1,"path":"SoftManual.md","ref":"SoftManual.md","articles":[]},"previous":{"title":"Python基础","level":"1.10","depth":1,"path":"PythonNote.md","ref":"PythonNote.md","articles":[]},"dir":"ltr"},"config":{"plugins":["-lunr","-search","-sharing","search-pro","splitter","code","github","-highlight","prism","anchor-navigation-ex","theme-comscore","intopic-toc","tbfed-pagefooter"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"tbfed-pagefooter":{"copyright":"Copyright &copy book.stolenzc.com 2021-2024"},"prism":{},"github":{"url":"https://github.com/stolenzc"},"intopic-toc":{"isCollapsed":true,"isScrollspyActive":true,"label":"目录","maxDepth":6,"mode":"nested","selector":".markdown-section h1, .markdown-section h2, .markdown-section h3, .markdown-section h4, .markdown-section h5, .markdown-section h6","visible":true},"splitter":{},"search-pro":{},"code":{"copyButtons":true},"fontsettings":{"theme":"white","family":"sans","size":2},"anchor-navigation-ex":{"associatedWithSummary":true,"float":{"floatIcon":"fa fa-navicon","level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"mode":"","multipleH1":false,"pageTop":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"printLog":false,"showGoTop":true,"showLevel":false},"theme-comscore":{},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","author":"STOLENZC","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"NOTEBOOK","language":"zh-hans","links":{"sidebar":{"博客主页":"https://blog.stolenzc.com","快捷工具":"https://tools.stolenzc.com"}},"gitbook":"*"},"file":{"path":"RedisNote.md","mtime":"2024-01-02T01:24:20.777Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2024-01-02T01:25:04.315Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-search-pro/jquery.mark.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search-pro/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-intopic-toc/anchor.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-intopic-toc/gumshoe.polyfills.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-intopic-toc/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-theme-comscore/test.js"></script>
        
    

    </body>
</html>

